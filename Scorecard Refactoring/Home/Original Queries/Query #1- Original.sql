---------------------State----
----------------------Response - NewCo----------------------
(SELECT concat(RISK_ST_ABBR,'Response',BU_ABBR,'NewCo','Total') as Key,
                                sum(case when Datediff(month,TRANS_DT,sysdate())=18 THEN RESP_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 THEN RESP_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 THEN RESP_IND_CNT ELSE 0 END) AS "16",   
                                sum(case when Datediff(month,TRANS_DT,sysdate())=15 THEN RESP_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,TRANS_DT,sysdate())=14 THEN RESP_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,TRANS_DT,sysdate())=13 THEN RESP_IND_CNT ELSE 0 END) AS "13",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=12 THEN RESP_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 THEN RESP_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 THEN RESP_IND_CNT ELSE 0 END) AS "10",   
                                sum(case when Datediff(month,TRANS_DT,sysdate())=9  THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,TRANS_DT,sysdate())=8  THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  THEN RESP_IND_CNT ELSE 0 END) AS "7", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=6  THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  THEN RESP_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,TRANS_DT,sysdate())=4  THEN RESP_IND_CNT ELSE 0 END) AS "4",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------Response - NowCo----------------------
Union all (SELECT concat(RISK_ST_ABBR,'Response',BUS_UNIT_ABBR,'NowCo','Total') as Key,
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 THEN RESP_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 THEN RESP_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 THEN RESP_IND_CNT ELSE 0 END) AS "16",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 THEN RESP_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 THEN RESP_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 THEN RESP_IND_CNT ELSE 0 END) AS "13",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 THEN RESP_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 THEN RESP_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 THEN RESP_IND_CNT ELSE 0 END) AS "10",
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7 THEN RESP_IND_CNT ELSE 0 END) AS "7", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  THEN RESP_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4 THEN RESP_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1 THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0 THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------Phone Response - NewCo----------------------
union all (SELECT concat(RISK_ST_ABBR,'Phone Response',BU_ABBR,'NewCo','Total') as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 THEN RESP_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 THEN RESP_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 THEN RESP_IND_CNT ELSE 0 END) AS "16",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=15 THEN RESP_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,TRANS_DT,sysdate())=14 THEN RESP_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,TRANS_DT,sysdate())=13 THEN RESP_IND_CNT ELSE 0 END) AS "13",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=12 THEN RESP_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 THEN RESP_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 THEN RESP_IND_CNT ELSE 0 END) AS "10",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=9  THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,TRANS_DT,sysdate())=8  THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  THEN RESP_IND_CNT ELSE 0 END) AS "7", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=6  THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  THEN RESP_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,TRANS_DT,sysdate())=4  THEN RESP_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null and ORIG_QTE_CNTCT_METH_CD='P' GROUP BY Key)


---------------------- Phone Response - NowCo----------------------
Union all (SELECT concat(RISK_ST_ABBR,'Phone Response',BUS_UNIT_ABBR,'NowCo','Total') as Key,
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 THEN RESP_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 THEN RESP_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 THEN RESP_IND_CNT ELSE 0 END) AS "16",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 THEN RESP_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 THEN RESP_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 THEN RESP_IND_CNT ELSE 0 END) AS "13",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 THEN RESP_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 THEN RESP_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 THEN RESP_IND_CNT ELSE 0 END) AS "10",
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7 THEN RESP_IND_CNT ELSE 0 END) AS "7", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  THEN RESP_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4 THEN RESP_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1 THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0 THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null and   DERIV_CHNNL_NM='Telephone' GROUP BY Key)


---------------------- Auto Completed Quote - NewCo----------------------
Union all (SELECT concat(RISK_ST_ABBR,'Completed Auto Quotes',BU_ABBR,'NewCo') as Key,
                                 sum(case when Datediff(month,TRANS_DT,sysdate())=18 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "15",  sum(case when Datediff(month,TRANS_DT,sysdate())=14 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "14",  sum(case when Datediff(month,TRANS_DT,sysdate())=13 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "13",
                                sum(case when Datediff(month,TRANS_DT,sysdate())=12 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "10", sum(case when Datediff(month,TRANS_DT,sysdate())=9 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,TRANS_DT,sysdate())=8 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "8",
                                sum(case when Datediff(month,TRANS_DT,sysdate())=7  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,TRANS_DT,sysdate())=4 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "4",
                                 sum(case when Datediff(month,TRANS_DT,sysdate())=3  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW"                                       Where COMPL_QTE_IND = 'Y' and RISK_ST_ABBR <> 'FL' GROUP BY Key)


---------------------- Auto Completed Quote - NowCo----------------------
Union All (SELECT concat(RISK_STATE_ABBR,'Completed Auto Quotes',BUS_UNIT_ABBR,'NowCo') as Key,
                                sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=18 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=17 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=16 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "16",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=15 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "15",  
                                sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=14 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "14",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=13 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "13",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=12 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "12",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=11 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "11",  
                                sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=10 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "10",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=9 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=8 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=7 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=6 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=5 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "5",
                                sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=4 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "4",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=3 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=2 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=1 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=0 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."AUTO_QUOTE_FLOW_SCDI_MODEL_VW" Where BUS_UNIT_ABBR <> 'CDRT'and COMPL_QUOTE_IND = 'Y'and RISK_STATE_ABBR <> 'FL'  GROUP BY Key)


----------------------PBR/CQ - NewCo----------------------
Union all (SELECT concat(RISK_ST_ABBR,'PBR/CQ',BU_ABBR,'NewCo','Total') as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "18",   sum(case when Datediff(month,TRANS_DT,sysdate())=17 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,TRANS_DT,sysdate())=16 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "16",   sum(case when Datediff(month,TRANS_DT,sysdate())=15 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "15",   sum(case when Datediff(month,TRANS_DT,sysdate())=14 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "14",   sum(case when Datediff(month,TRANS_DT,sysdate())=13 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "13",   sum(case when Datediff(month,TRANS_DT,sysdate())=12 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "12",   sum(case when Datediff(month,TRANS_DT,sysdate())=11 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "11", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=10 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "10",   sum(case when Datediff(month,TRANS_DT,sysdate())=9 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,TRANS_DT,sysdate())=8 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "5",
                               sum(case when Datediff(month,TRANS_DT,sysdate())=4 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "4",  sum(case when Datediff(month,TRANS_DT,sysdate())=3 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------PBR/CQ - NowCo----------------------
Union all ( Select concat(RISK_ST_ABBR,'PBR/CQ',BUS_UNIT_ABBR,'NowCo','Total') as Key,
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "15",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "11", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "4",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------Issue Count - NewCo----------------------
Union all (SELECT concat(RISK_ST_ABBR,'IssueCount',BU_ABBR,'NewCo','Total') as Key,
                                sum(case when Datediff(month,TRANS_DT,sysdate())=18 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "15",   sum(case when Datediff(month,TRANS_DT,sysdate())=14 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=13 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,TRANS_DT,sysdate())=12 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "10",   sum(case when Datediff(month,TRANS_DT,sysdate())=9 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "9", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=8  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,TRANS_DT,sysdate())=4 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------Issue Count - NowCo----------------------
Union all (Select concat(RISK_ST_ABBR,'IssueCount',BUS_UNIT_ABBR,'NowCo','Total') as Key,
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "16",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "15",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "12",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "11",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "9",
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7  and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------AIP - NewCo----------------------
Union all (SELECT concat(RISK_ST_ABBR,'AIP',BU_ABBR,'NewCo','Total') as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "15",   sum(case when Datediff(month,TRANS_DT,sysdate())=14 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=13 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "13", sum(case when Datediff(month,TRANS_DT,sysdate())=12 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "10",   sum(case when Datediff(month,TRANS_DT,sysdate())=9 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "9", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=8  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "5", sum(case when Datediff(month,TRANS_DT,sysdate())=4 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------AIP - NowCo----------------------
Union all (Select concat(RISK_ST_ABBR,'AIP',BUS_UNIT_ABBR,'NowCo','Total') as Key,
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=17 and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "17",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "16",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "15",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=12 and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "12",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "11",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "9",
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=7  and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=2  and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF 
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------AQP - NewCo----------------------
Union all (SELECT concat(RISK_ST_ABBR,'AQP',BU_ABBR,'NewCo','Total') as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "15", sum(case when Datediff(month,TRANS_DT,sysdate())=14 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=13 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "13", sum(case when Datediff(month,TRANS_DT,sysdate())=12 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "10", sum(case when Datediff(month,TRANS_DT,sysdate())=9 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "9", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=8  and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "5", sum(case when Datediff(month,TRANS_DT,sysdate())=4 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------AQP - NowCo----------------------
Union all ( Select concat(RISK_ST_ABBR,'AQP',BUS_UNIT_ABBR,'NowCo','Total') as Key,
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=18 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=17 and COMP_QTE_IND_CNT = '1' THEN TERM_WRIT_PREM ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "16", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "15", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=13 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=12 and COMP_QTE_IND_CNT = '1' THEN TERM_WRIT_PREM ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "11", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "9",
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=8  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=7  and COMP_QTE_IND_CNT = '1' THEN TERM_WRIT_PREM ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=3  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=2  and COMP_QTE_IND_CNT = '1' THEN TERM_WRIT_PREM ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------CQ - NewCo----------------------
Union all (SELECT concat(RISK_ST_ABBR,'CQ',BU_ABBR,'NewCo','Total') as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "15",   sum(case when Datediff(month,TRANS_DT,sysdate())=14 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=13 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,TRANS_DT,sysdate())=12 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "10",   sum(case when Datediff(month,TRANS_DT,sysdate())=9 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "9", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=8  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,TRANS_DT,sysdate())=4 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------CQ - NowCo----------------------
Union All (Select concat(RISK_ST_ABBR,'CQ',BUS_UNIT_ABBR,'NowCo','Total') as Key,
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=18 and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=17 and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=16 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=15 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=14 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=13 and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=12 and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=11 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=10 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=9  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "9",
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=8  and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=7  and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=6  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=5  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=4  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=3  and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=2  and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=1  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=0  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


---------------------- Auto Issues - NewCo----------------------
Union All (SELECT concat(RISK_ST_ABBR,'Auto Issues',BU_ABBR,'NewCo') as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 THEN ISSUE_IND_CNT ELSE 0 END) AS "18",  sum(case when Datediff(month,TRANS_DT,sysdate())=17 THEN ISSUE_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,TRANS_DT,sysdate())=16 THEN ISSUE_IND_CNT ELSE 0 END) AS "16",  sum(case when Datediff(month,TRANS_DT,sysdate())=15 THEN ISSUE_IND_CNT ELSE 0 END) AS "15",  sum(case when Datediff(month,TRANS_DT,sysdate())=14 THEN ISSUE_IND_CNT ELSE 0 END) AS "14",
                               sum(case when Datediff(month,TRANS_DT,sysdate())=13 THEN ISSUE_IND_CNT ELSE 0 END) AS "13",  sum(case when Datediff(month,TRANS_DT,sysdate())=12 THEN ISSUE_IND_CNT ELSE 0 END) AS "12",  sum(case when Datediff(month,TRANS_DT,sysdate())=11 THEN ISSUE_IND_CNT ELSE 0 END) AS "11",  sum(case when Datediff(month,TRANS_DT,sysdate())=10 THEN ISSUE_IND_CNT ELSE 0 END) AS "10",  sum(case when Datediff(month,TRANS_DT,sysdate())=9 THEN ISSUE_IND_CNT ELSE 0 END) AS "9",
                               sum(case when Datediff(month,TRANS_DT,sysdate())=8 THEN ISSUE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7 THEN ISSUE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6 THEN ISSUE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5 THEN ISSUE_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,TRANS_DT,sysdate())=4 THEN ISSUE_IND_CNT ELSE 0 END) AS "4",
                               sum(case when Datediff(month,TRANS_DT,sysdate())=3 THEN ISSUE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2 THEN ISSUE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1 THEN ISSUE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 THEN ISSUE_IND_CNT ELSE 0 END) AS "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF   
FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW"                                       Where COMPL_QTE_IND = 'Y' and RISK_ST_ABBR <> 'FL'   GROUP BY Key)


---------------------- Auto Issues  - NowCo----------------------
Union All (SELECT   concat(RISK_STATE_ABBR,'Auto Issues',BUS_UNIT_ABBR,'NowCo') as Key,
                               sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=18 THEN ISSUE_IND_CNT ELSE 0 END) AS "18",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=17 THEN ISSUE_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=16 THEN ISSUE_IND_CNT ELSE 0 END) AS "16",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=15 THEN ISSUE_IND_CNT ELSE 0 END) AS "15",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=14 THEN ISSUE_IND_CNT ELSE 0 END) AS "14",
                               sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=13 THEN ISSUE_IND_CNT ELSE 0 END) AS "13",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=12 THEN ISSUE_IND_CNT ELSE 0 END) AS "12",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=11 THEN ISSUE_IND_CNT ELSE 0 END) AS "11",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=10 THEN ISSUE_IND_CNT ELSE 0 END) AS "10",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=9 THEN ISSUE_IND_CNT ELSE 0 END) AS "9",
                               sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=8 THEN ISSUE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=7 THEN ISSUE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=6 THEN ISSUE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=5 THEN ISSUE_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=4 THEN ISSUE_IND_CNT ELSE 0 END) AS "4",
                               sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=3 THEN ISSUE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=2 THEN ISSUE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=1 THEN ISSUE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=0 THEN ISSUE_IND_CNT ELSE 0 END) as "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."AUTO_QUOTE_FLOW_SCDI_MODEL_VW" Where BUS_UNIT_ABBR <> 'CDRT' and RISK_STATE_ABBR <> 'FL' GROUP BY Key)


----------------------HIGSRP - NewCo----------------------
Union all (SELECT concat(RISK_ST_ABBR,'HIGSRP',BU_ABBR,'NewCo','Total') as Key,
                               nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=18 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "18", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=17 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "17", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=16 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "16", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=15 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "15", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=14 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "14",
                               nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=13 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "13", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=12 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "12", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=11 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "11", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=10 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "10", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=9  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "9",
                               nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=8  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "8", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=7  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "7", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=6  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "6", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=5  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "5", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=4  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "4",
                               nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=3  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "3", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=2  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "2", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=1  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "1", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=0  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null and QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0 and ORIG_QTE_CNTCT_METH_CD = 'P' GROUP BY Key)



----------------------HIGSRP - NowCo----------------------
Union all (Select concat(RISK_ST_ABBR,'HIGSRP',BUS_UNIT_ABBR,'NowCo','Total') as Key,
                               nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "18",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "17",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "16",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "15",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "14",  
                                nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "13",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "12",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "11",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "10",  nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "9",
                               nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "8",  nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "7",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "6",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "5",  nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "4", 
                                nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "3",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "2",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "1",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null and COMP_QTE_IND_CNT = 1 AND PRR_CARR_POL_PREM_AMT >= 300 AND TERM_WRIT_PREM > 0 and DERIV_CHNNL_NM = 'Telephone' and BUS_UNIT_ABBR = 'AARP' GROUP BY Key)

---------CW-----------------------------------------------------------------
----------------------Response - NewCo----------------------
Union all (SELECT concat('CW','Response',BU_ABBR,'NewCo','Total') as Key,
                                sum(case when Datediff(month,TRANS_DT,sysdate())=18 THEN RESP_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 THEN RESP_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 THEN RESP_IND_CNT ELSE 0 END) AS "16",   
                                sum(case when Datediff(month,TRANS_DT,sysdate())=15 THEN RESP_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,TRANS_DT,sysdate())=14 THEN RESP_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,TRANS_DT,sysdate())=13 THEN RESP_IND_CNT ELSE 0 END) AS "13",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=12 THEN RESP_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 THEN RESP_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 THEN RESP_IND_CNT ELSE 0 END) AS "10",   
                                sum(case when Datediff(month,TRANS_DT,sysdate())=9  THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,TRANS_DT,sysdate())=8  THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  THEN RESP_IND_CNT ELSE 0 END) AS "7", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=6  THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  THEN RESP_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,TRANS_DT,sysdate())=4  THEN RESP_IND_CNT ELSE 0 END) AS "4",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------Response - NowCo----------------------
Union all (SELECT concat('CW','Response',BUS_UNIT_ABBR,'NowCo','Total') as Key,
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 THEN RESP_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 THEN RESP_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 THEN RESP_IND_CNT ELSE 0 END) AS "16",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 THEN RESP_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 THEN RESP_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 THEN RESP_IND_CNT ELSE 0 END) AS "13",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 THEN RESP_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 THEN RESP_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 THEN RESP_IND_CNT ELSE 0 END) AS "10",
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7 THEN RESP_IND_CNT ELSE 0 END) AS "7", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  THEN RESP_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4 THEN RESP_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1 THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0 THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------Phone Response - NewCo----------------------
union all (SELECT concat('CW','Phone Response',BU_ABBR,'NewCo','Total') as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 THEN RESP_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 THEN RESP_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 THEN RESP_IND_CNT ELSE 0 END) AS "16",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=15 THEN RESP_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,TRANS_DT,sysdate())=14 THEN RESP_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,TRANS_DT,sysdate())=13 THEN RESP_IND_CNT ELSE 0 END) AS "13",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=12 THEN RESP_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 THEN RESP_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 THEN RESP_IND_CNT ELSE 0 END) AS "10",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=9  THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,TRANS_DT,sysdate())=8  THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  THEN RESP_IND_CNT ELSE 0 END) AS "7", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=6  THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  THEN RESP_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,TRANS_DT,sysdate())=4  THEN RESP_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null and ORIG_QTE_CNTCT_METH_CD='P' GROUP BY Key)


---------------------- Phone Response - NowCo----------------------
Union all (SELECT concat('CW','Phone Response',BUS_UNIT_ABBR,'NowCo','Total') as Key,
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 THEN RESP_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 THEN RESP_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 THEN RESP_IND_CNT ELSE 0 END) AS "16",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 THEN RESP_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 THEN RESP_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 THEN RESP_IND_CNT ELSE 0 END) AS "13",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 THEN RESP_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 THEN RESP_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 THEN RESP_IND_CNT ELSE 0 END) AS "10",
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7 THEN RESP_IND_CNT ELSE 0 END) AS "7", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  THEN RESP_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4 THEN RESP_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1 THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0 THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null and   DERIV_CHNNL_NM='Telephone' GROUP BY Key)


---------------------- Auto Completed Quote - NewCo----------------------
Union all (SELECT concat('CW','Completed Auto Quotes',BU_ABBR,'NewCo') as Key,
                                 sum(case when Datediff(month,TRANS_DT,sysdate())=18 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "15",  sum(case when Datediff(month,TRANS_DT,sysdate())=14 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "14",  sum(case when Datediff(month,TRANS_DT,sysdate())=13 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "13",
                                sum(case when Datediff(month,TRANS_DT,sysdate())=12 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "10", sum(case when Datediff(month,TRANS_DT,sysdate())=9 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,TRANS_DT,sysdate())=8 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "8",
                                sum(case when Datediff(month,TRANS_DT,sysdate())=7  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,TRANS_DT,sysdate())=4 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "4",
                                 sum(case when Datediff(month,TRANS_DT,sysdate())=3  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW"                                       Where COMPL_QTE_IND = 'Y' and 'CW' <> 'FL' GROUP BY Key)


---------------------- Auto Completed Quote - NowCo----------------------
Union All (SELECT concat('CW','Completed Auto Quotes',BUS_UNIT_ABBR,'NowCo') as Key,
                                sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=18 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=17 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=16 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "16",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=15 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "15",  
                                sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=14 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "14",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=13 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "13",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=12 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "12",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=11 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "11",  
                                sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=10 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "10",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=9 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=8 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=7 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=6 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=5 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "5",
                                sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=4 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "4",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=3 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=2 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=1 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=0 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."AUTO_QUOTE_FLOW_SCDI_MODEL_VW" Where BUS_UNIT_ABBR <> 'CDRT'and COMPL_QUOTE_IND = 'Y'and 'CW' <> 'FL'  GROUP BY Key)


----------------------PBR/CQ - NewCo----------------------
Union all (SELECT concat('CW','PBR/CQ',BU_ABBR,'NewCo','Total') as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "18",   sum(case when Datediff(month,TRANS_DT,sysdate())=17 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,TRANS_DT,sysdate())=16 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "16",   sum(case when Datediff(month,TRANS_DT,sysdate())=15 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "15",   sum(case when Datediff(month,TRANS_DT,sysdate())=14 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "14",   sum(case when Datediff(month,TRANS_DT,sysdate())=13 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "13",   sum(case when Datediff(month,TRANS_DT,sysdate())=12 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "12",   sum(case when Datediff(month,TRANS_DT,sysdate())=11 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "11", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=10 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "10",   sum(case when Datediff(month,TRANS_DT,sysdate())=9 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,TRANS_DT,sysdate())=8 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "5",
                               sum(case when Datediff(month,TRANS_DT,sysdate())=4 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "4",  sum(case when Datediff(month,TRANS_DT,sysdate())=3 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------PBR/CQ - NowCo----------------------
Union all ( Select concat('CW','PBR/CQ',BUS_UNIT_ABBR,'NowCo','Total') as Key,
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "15",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "11", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "4",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------Issue Count - NewCo----------------------
Union all (SELECT concat('CW','IssueCount',BU_ABBR,'NewCo','Total') as Key,
                                sum(case when Datediff(month,TRANS_DT,sysdate())=18 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "15",   sum(case when Datediff(month,TRANS_DT,sysdate())=14 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=13 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,TRANS_DT,sysdate())=12 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "10",   sum(case when Datediff(month,TRANS_DT,sysdate())=9 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "9", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=8  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,TRANS_DT,sysdate())=4 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------Issue Count - NowCo----------------------
Union all (Select concat('CW','IssueCount',BUS_UNIT_ABBR,'NowCo','Total') as Key,
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "16",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "15",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "12",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "11",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "9",
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7  and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------AIP - NewCo----------------------
Union all (SELECT concat('CW','AIP',BU_ABBR,'NewCo','Total') as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "15",   sum(case when Datediff(month,TRANS_DT,sysdate())=14 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=13 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "13", sum(case when Datediff(month,TRANS_DT,sysdate())=12 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "10",   sum(case when Datediff(month,TRANS_DT,sysdate())=9 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "9", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=8  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "5", sum(case when Datediff(month,TRANS_DT,sysdate())=4 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------AIP - NowCo----------------------
Union all (Select concat('CW','AIP',BUS_UNIT_ABBR,'NowCo','Total') as Key,
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=17 and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "17",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "16",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "15",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=12 and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "12",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "11",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "9",
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=7  and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=2  and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF 
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------AQP - NewCo----------------------
Union all (SELECT concat('CW','AQP',BU_ABBR,'NewCo','Total') as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "15", sum(case when Datediff(month,TRANS_DT,sysdate())=14 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=13 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "13", sum(case when Datediff(month,TRANS_DT,sysdate())=12 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "10", sum(case when Datediff(month,TRANS_DT,sysdate())=9 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "9", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=8  and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "5", sum(case when Datediff(month,TRANS_DT,sysdate())=4 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------AQP - NowCo----------------------
Union all ( Select concat('CW','AQP',BUS_UNIT_ABBR,'NowCo','Total') as Key,
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=18 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=17 and COMP_QTE_IND_CNT = '1' THEN TERM_WRIT_PREM ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "16", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "15", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=13 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=12 and COMP_QTE_IND_CNT = '1' THEN TERM_WRIT_PREM ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "11", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "9",
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=8  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=7  and COMP_QTE_IND_CNT = '1' THEN TERM_WRIT_PREM ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=3  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=2  and COMP_QTE_IND_CNT = '1' THEN TERM_WRIT_PREM ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------CQ - NewCo----------------------
Union all (SELECT concat('CW','CQ',BU_ABBR,'NewCo','Total') as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "15",   sum(case when Datediff(month,TRANS_DT,sysdate())=14 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=13 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,TRANS_DT,sysdate())=12 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "10",   sum(case when Datediff(month,TRANS_DT,sysdate())=9 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "9", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=8  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,TRANS_DT,sysdate())=4 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------CQ - NowCo----------------------
Union All (Select concat('CW','CQ',BUS_UNIT_ABBR,'NowCo','Total') as Key,
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=18 and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=17 and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=16 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=15 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=14 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=13 and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=12 and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=11 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=10 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=9  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "9",
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=8  and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=7  and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=6  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=5  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=4  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=3  and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=2  and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=1  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=0  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


---------------------- Auto Issues - NewCo----------------------
Union All (SELECT concat('CW','Auto Issues',BU_ABBR,'NewCo') as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 THEN ISSUE_IND_CNT ELSE 0 END) AS "18",  sum(case when Datediff(month,TRANS_DT,sysdate())=17 THEN ISSUE_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,TRANS_DT,sysdate())=16 THEN ISSUE_IND_CNT ELSE 0 END) AS "16",  sum(case when Datediff(month,TRANS_DT,sysdate())=15 THEN ISSUE_IND_CNT ELSE 0 END) AS "15",  sum(case when Datediff(month,TRANS_DT,sysdate())=14 THEN ISSUE_IND_CNT ELSE 0 END) AS "14",
                               sum(case when Datediff(month,TRANS_DT,sysdate())=13 THEN ISSUE_IND_CNT ELSE 0 END) AS "13",  sum(case when Datediff(month,TRANS_DT,sysdate())=12 THEN ISSUE_IND_CNT ELSE 0 END) AS "12",  sum(case when Datediff(month,TRANS_DT,sysdate())=11 THEN ISSUE_IND_CNT ELSE 0 END) AS "11",  sum(case when Datediff(month,TRANS_DT,sysdate())=10 THEN ISSUE_IND_CNT ELSE 0 END) AS "10",  sum(case when Datediff(month,TRANS_DT,sysdate())=9 THEN ISSUE_IND_CNT ELSE 0 END) AS "9",
                               sum(case when Datediff(month,TRANS_DT,sysdate())=8 THEN ISSUE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7 THEN ISSUE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6 THEN ISSUE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5 THEN ISSUE_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,TRANS_DT,sysdate())=4 THEN ISSUE_IND_CNT ELSE 0 END) AS "4",
                               sum(case when Datediff(month,TRANS_DT,sysdate())=3 THEN ISSUE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2 THEN ISSUE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1 THEN ISSUE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 THEN ISSUE_IND_CNT ELSE 0 END) AS "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF   
FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW"                                       Where COMPL_QTE_IND = 'Y' and 'CW' <> 'FL'   GROUP BY Key)


---------------------- Auto Issues  - NowCo----------------------
Union All (SELECT   concat('CW','Auto Issues',BUS_UNIT_ABBR,'NowCo') as Key,
                               sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=18 THEN ISSUE_IND_CNT ELSE 0 END) AS "18",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=17 THEN ISSUE_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=16 THEN ISSUE_IND_CNT ELSE 0 END) AS "16",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=15 THEN ISSUE_IND_CNT ELSE 0 END) AS "15",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=14 THEN ISSUE_IND_CNT ELSE 0 END) AS "14",
                               sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=13 THEN ISSUE_IND_CNT ELSE 0 END) AS "13",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=12 THEN ISSUE_IND_CNT ELSE 0 END) AS "12",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=11 THEN ISSUE_IND_CNT ELSE 0 END) AS "11",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=10 THEN ISSUE_IND_CNT ELSE 0 END) AS "10",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=9 THEN ISSUE_IND_CNT ELSE 0 END) AS "9",
                               sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=8 THEN ISSUE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=7 THEN ISSUE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=6 THEN ISSUE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=5 THEN ISSUE_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=4 THEN ISSUE_IND_CNT ELSE 0 END) AS "4",
                               sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=3 THEN ISSUE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=2 THEN ISSUE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=1 THEN ISSUE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=0 THEN ISSUE_IND_CNT ELSE 0 END) as "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."AUTO_QUOTE_FLOW_SCDI_MODEL_VW" Where BUS_UNIT_ABBR <> 'CDRT' and 'CW' <> 'FL' GROUP BY Key)


----------------------HIGSRP - NewCo----------------------
Union all (SELECT concat('CW','HIGSRP',BU_ABBR,'NewCo','Total') as Key,
                               nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=18 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "18", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=17 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "17", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=16 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "16", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=15 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "15", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=14 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "14",
                               nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=13 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "13", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=12 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "12", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=11 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "11", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=10 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "10", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=9  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "9",
                               nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=8  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "8", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=7  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "7", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=6  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "6", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=5  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "5", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=4  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "4",
                               nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=3  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "3", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=2  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "2", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=1  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "1", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=0  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null and QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0 and ORIG_QTE_CNTCT_METH_CD = 'P' GROUP BY Key)



----------------------HIGSRP - NowCo----------------------
Union all (Select concat('CW','HIGSRP',BUS_UNIT_ABBR,'NowCo','Total') as Key,
                               nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "18",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "17",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "16",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "15",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "14",  
                                nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "13",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "12",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "11",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "10",  nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "9",
                               nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "8",  nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "7",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "6",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "5",  nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "4", 
                                nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "3",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "2",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "1",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null and COMP_QTE_IND_CNT = 1 AND PRR_CARR_POL_PREM_AMT >= 300 AND TERM_WRIT_PREM > 0 and DERIV_CHNNL_NM = 'Telephone' and BUS_UNIT_ABBR = 'AARP' GROUP BY Key)



---------------------Region----
----------------------Response - NewCo----------------------
Union all (SELECT concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'Response',BU_ABBR,'NewCo','Total') as Key,
                                sum(case when Datediff(month,TRANS_DT,sysdate())=18 THEN RESP_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 THEN RESP_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 THEN RESP_IND_CNT ELSE 0 END) AS "16",   
                                sum(case when Datediff(month,TRANS_DT,sysdate())=15 THEN RESP_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,TRANS_DT,sysdate())=14 THEN RESP_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,TRANS_DT,sysdate())=13 THEN RESP_IND_CNT ELSE 0 END) AS "13",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=12 THEN RESP_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 THEN RESP_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 THEN RESP_IND_CNT ELSE 0 END) AS "10",   
                                sum(case when Datediff(month,TRANS_DT,sysdate())=9  THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,TRANS_DT,sysdate())=8  THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  THEN RESP_IND_CNT ELSE 0 END) AS "7", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=6  THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  THEN RESP_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,TRANS_DT,sysdate())=4  THEN RESP_IND_CNT ELSE 0 END) AS "4",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------Response - NowCo----------------------
Union all (SELECT concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'Response',BUS_UNIT_ABBR,'NowCo','Total') as Key,
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 THEN RESP_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 THEN RESP_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 THEN RESP_IND_CNT ELSE 0 END) AS "16",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 THEN RESP_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 THEN RESP_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 THEN RESP_IND_CNT ELSE 0 END) AS "13",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 THEN RESP_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 THEN RESP_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 THEN RESP_IND_CNT ELSE 0 END) AS "10",
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7 THEN RESP_IND_CNT ELSE 0 END) AS "7", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  THEN RESP_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4 THEN RESP_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1 THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0 THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------Phone Response - NewCo----------------------
union all (SELECT concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'Phone Response',BU_ABBR,'NewCo','Total') as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 THEN RESP_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 THEN RESP_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 THEN RESP_IND_CNT ELSE 0 END) AS "16",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=15 THEN RESP_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,TRANS_DT,sysdate())=14 THEN RESP_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,TRANS_DT,sysdate())=13 THEN RESP_IND_CNT ELSE 0 END) AS "13",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=12 THEN RESP_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 THEN RESP_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 THEN RESP_IND_CNT ELSE 0 END) AS "10",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=9  THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,TRANS_DT,sysdate())=8  THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  THEN RESP_IND_CNT ELSE 0 END) AS "7", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=6  THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  THEN RESP_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,TRANS_DT,sysdate())=4  THEN RESP_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null and ORIG_QTE_CNTCT_METH_CD='P' GROUP BY Key)

---------------------- Phone Response - NowCo----------------------
Union all (SELECT concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'Phone Response',BUS_UNIT_ABBR,'NowCo','Total') as Key,
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 THEN RESP_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 THEN RESP_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 THEN RESP_IND_CNT ELSE 0 END) AS "16",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 THEN RESP_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 THEN RESP_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 THEN RESP_IND_CNT ELSE 0 END) AS "13",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 THEN RESP_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 THEN RESP_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 THEN RESP_IND_CNT ELSE 0 END) AS "10",
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7 THEN RESP_IND_CNT ELSE 0 END) AS "7", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  THEN RESP_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4 THEN RESP_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1 THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0 THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null and   DERIV_CHNNL_NM='Telephone' GROUP BY Key)


---------------------- Auto Completed Quote - NewCo----------------------
Union all (SELECT concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'Completed Auto Quotes',BU_ABBR,'NewCo') as Key,
                                 sum(case when Datediff(month,TRANS_DT,sysdate())=18 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "15",  sum(case when Datediff(month,TRANS_DT,sysdate())=14 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "14",  sum(case when Datediff(month,TRANS_DT,sysdate())=13 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "13",
                                sum(case when Datediff(month,TRANS_DT,sysdate())=12 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "10", sum(case when Datediff(month,TRANS_DT,sysdate())=9 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,TRANS_DT,sysdate())=8 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "8",
                                sum(case when Datediff(month,TRANS_DT,sysdate())=7  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,TRANS_DT,sysdate())=4 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "4",
                                 sum(case when Datediff(month,TRANS_DT,sysdate())=3  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW"                                       Where COMPL_QTE_IND = 'Y' and RISK_ST_ABBR <> 'FL' GROUP BY Key)


---------------------- Auto Completed Quote - NowCo----------------------
Union All (SELECT concat((case when RISK_STATE_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_STATE_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_STATE_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_STATE_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'Completed Auto Quotes',BUS_UNIT_ABBR,'NowCo') as Key,
                                sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=18 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=17 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=16 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "16",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=15 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "15",  
                                sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=14 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "14",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=13 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "13",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=12 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "12",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=11 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "11",  
                                sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=10 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "10",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=9 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=8 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=7 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=6 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=5 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "5",
                                sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=4 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "4",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=3 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=2 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=1 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=0 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."AUTO_QUOTE_FLOW_SCDI_MODEL_VW" Where BUS_UNIT_ABBR <> 'CDRT'and COMPL_QUOTE_IND = 'Y'and RISK_STATE_ABBR <> 'FL'  GROUP BY Key)


----------------------PBR/CQ - NewCo----------------------
Union all (SELECT concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'PBR/CQ',BU_ABBR,'NewCo','Total') as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "18",   sum(case when Datediff(month,TRANS_DT,sysdate())=17 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,TRANS_DT,sysdate())=16 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "16",   sum(case when Datediff(month,TRANS_DT,sysdate())=15 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "15",   sum(case when Datediff(month,TRANS_DT,sysdate())=14 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "14",   sum(case when Datediff(month,TRANS_DT,sysdate())=13 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "13",   sum(case when Datediff(month,TRANS_DT,sysdate())=12 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "12",   sum(case when Datediff(month,TRANS_DT,sysdate())=11 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "11", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=10 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "10",   sum(case when Datediff(month,TRANS_DT,sysdate())=9 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,TRANS_DT,sysdate())=8 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "5",
                               sum(case when Datediff(month,TRANS_DT,sysdate())=4 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "4",  sum(case when Datediff(month,TRANS_DT,sysdate())=3 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------PBR/CQ - NowCo----------------------
Union all ( Select concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'PBR/CQ',BUS_UNIT_ABBR,'NowCo','Total') as Key,
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "15",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "11", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "4",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------Issue Count - NewCo----------------------
Union all (SELECT concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'IssueCount',BU_ABBR,'NewCo','Total') as Key,
                                sum(case when Datediff(month,TRANS_DT,sysdate())=18 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "15",   sum(case when Datediff(month,TRANS_DT,sysdate())=14 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=13 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,TRANS_DT,sysdate())=12 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "10",   sum(case when Datediff(month,TRANS_DT,sysdate())=9 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "9", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=8  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,TRANS_DT,sysdate())=4 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------Issue Count - NowCo----------------------
Union all (Select concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'IssueCount',BUS_UNIT_ABBR,'NowCo','Total') as Key,
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "16",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "15",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "12",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "11",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "9",
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7  and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------AIP - NewCo----------------------
Union all (SELECT concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'AIP',BU_ABBR,'NewCo','Total') as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "15",   sum(case when Datediff(month,TRANS_DT,sysdate())=14 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=13 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "13", sum(case when Datediff(month,TRANS_DT,sysdate())=12 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "10",   sum(case when Datediff(month,TRANS_DT,sysdate())=9 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "9", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=8  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "5", sum(case when Datediff(month,TRANS_DT,sysdate())=4 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------AIP - NowCo----------------------
Union all (Select concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'AIP',BUS_UNIT_ABBR,'NowCo','Total') as Key,
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=17 and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "17",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "16",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "15",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=12 and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "12",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "11",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "9",
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=7  and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=2  and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF 
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------AQP - NewCo----------------------
Union all (SELECT concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'AQP',BU_ABBR,'NewCo','Total') as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "15", sum(case when Datediff(month,TRANS_DT,sysdate())=14 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=13 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "13", sum(case when Datediff(month,TRANS_DT,sysdate())=12 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "10", sum(case when Datediff(month,TRANS_DT,sysdate())=9 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "9", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=8  and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "5", sum(case when Datediff(month,TRANS_DT,sysdate())=4 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------AQP - NowCo----------------------
Union all ( Select concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'AQP',BUS_UNIT_ABBR,'NowCo','Total') as Key,
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=18 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=17 and COMP_QTE_IND_CNT = '1' THEN TERM_WRIT_PREM ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "16", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "15", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=13 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=12 and COMP_QTE_IND_CNT = '1' THEN TERM_WRIT_PREM ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "11", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "9",
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=8  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=7  and COMP_QTE_IND_CNT = '1' THEN TERM_WRIT_PREM ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=3  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=2  and COMP_QTE_IND_CNT = '1' THEN TERM_WRIT_PREM ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------CQ - NewCo----------------------
Union all (SELECT concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'CQ',BU_ABBR,'NewCo','Total') as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "15",   sum(case when Datediff(month,TRANS_DT,sysdate())=14 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=13 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,TRANS_DT,sysdate())=12 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "10",   sum(case when Datediff(month,TRANS_DT,sysdate())=9 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "9", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=8  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,TRANS_DT,sysdate())=4 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------CQ - NowCo----------------------
Union All (Select concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'CQ',BUS_UNIT_ABBR,'NowCo','Total') as Key,
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=18 and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=17 and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=16 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=15 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=14 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=13 and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=12 and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=11 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=10 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=9  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "9",
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=8  and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=7  and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=6  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=5  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=4  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=3  and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=2  and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=1  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=0  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


---------------------- Auto Issues - NewCo----------------------
Union All (SELECT concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'Auto Issues',BU_ABBR,'NewCo') as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 THEN ISSUE_IND_CNT ELSE 0 END) AS "18",  sum(case when Datediff(month,TRANS_DT,sysdate())=17 THEN ISSUE_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,TRANS_DT,sysdate())=16 THEN ISSUE_IND_CNT ELSE 0 END) AS "16",  sum(case when Datediff(month,TRANS_DT,sysdate())=15 THEN ISSUE_IND_CNT ELSE 0 END) AS "15",  sum(case when Datediff(month,TRANS_DT,sysdate())=14 THEN ISSUE_IND_CNT ELSE 0 END) AS "14",
                               sum(case when Datediff(month,TRANS_DT,sysdate())=13 THEN ISSUE_IND_CNT ELSE 0 END) AS "13",  sum(case when Datediff(month,TRANS_DT,sysdate())=12 THEN ISSUE_IND_CNT ELSE 0 END) AS "12",  sum(case when Datediff(month,TRANS_DT,sysdate())=11 THEN ISSUE_IND_CNT ELSE 0 END) AS "11",  sum(case when Datediff(month,TRANS_DT,sysdate())=10 THEN ISSUE_IND_CNT ELSE 0 END) AS "10",  sum(case when Datediff(month,TRANS_DT,sysdate())=9 THEN ISSUE_IND_CNT ELSE 0 END) AS "9",
                               sum(case when Datediff(month,TRANS_DT,sysdate())=8 THEN ISSUE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7 THEN ISSUE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6 THEN ISSUE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5 THEN ISSUE_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,TRANS_DT,sysdate())=4 THEN ISSUE_IND_CNT ELSE 0 END) AS "4",
                               sum(case when Datediff(month,TRANS_DT,sysdate())=3 THEN ISSUE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2 THEN ISSUE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1 THEN ISSUE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 THEN ISSUE_IND_CNT ELSE 0 END) AS "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF   
FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW"                                       Where COMPL_QTE_IND = 'Y' and RISK_ST_ABBR <> 'FL'   GROUP BY Key)


---------------------- Auto Issues  - NowCo----------------------
Union All (SELECT  concat((case when RISK_STATE_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_STATE_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_STATE_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_STATE_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'Auto Issues',BUS_UNIT_ABBR,'NowCo') as Key,
                               sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=18 THEN ISSUE_IND_CNT ELSE 0 END) AS "18",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=17 THEN ISSUE_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=16 THEN ISSUE_IND_CNT ELSE 0 END) AS "16",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=15 THEN ISSUE_IND_CNT ELSE 0 END) AS "15",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=14 THEN ISSUE_IND_CNT ELSE 0 END) AS "14",
                               sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=13 THEN ISSUE_IND_CNT ELSE 0 END) AS "13",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=12 THEN ISSUE_IND_CNT ELSE 0 END) AS "12",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=11 THEN ISSUE_IND_CNT ELSE 0 END) AS "11",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=10 THEN ISSUE_IND_CNT ELSE 0 END) AS "10",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=9 THEN ISSUE_IND_CNT ELSE 0 END) AS "9",
                               sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=8 THEN ISSUE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=7 THEN ISSUE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=6 THEN ISSUE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=5 THEN ISSUE_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=4 THEN ISSUE_IND_CNT ELSE 0 END) AS "4",
                               sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=3 THEN ISSUE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=2 THEN ISSUE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=1 THEN ISSUE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=0 THEN ISSUE_IND_CNT ELSE 0 END) as "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."AUTO_QUOTE_FLOW_SCDI_MODEL_VW" Where BUS_UNIT_ABBR <> 'CDRT' and RISK_STATE_ABBR <> 'FL' GROUP BY Key)


----------------------HIGSRP - NewCo----------------------
Union all (SELECT concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'HIGSRP',BU_ABBR,'NewCo','Total') as Key,
                               nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=18 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "18", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=17 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "17", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=16 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "16", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=15 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "15", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=14 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "14",
                               nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=13 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "13", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=12 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "12", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=11 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "11", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=10 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "10", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=9  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "9",
                               nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=8  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "8", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=7  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "7", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=6  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "6", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=5  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "5", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=4  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "4",
                               nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=3  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "3", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=2  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "2", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=1  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "1", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=0  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null and QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0 and ORIG_QTE_CNTCT_METH_CD = 'P' GROUP BY Key)



----------------------HIGSRP - NowCo----------------------
Union all (Select concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'HIGSRP',BUS_UNIT_ABBR,'NowCo','Total') as Key,
                               nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "18",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "17",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "16",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "15",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "14",  
                                nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "13",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "12",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "11",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "10",  nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "9",
                               nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "8",  nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "7",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "6",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "5",  nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "4", 
                                nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "3",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "2",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "1",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null and COMP_QTE_IND_CNT = 1 AND PRR_CARR_POL_PREM_AMT >= 300 AND TERM_WRIT_PREM > 0 and DERIV_CHNNL_NM = 'Telephone' and BUS_UNIT_ABBR = 'AARP' GROUP BY Key)

--------------------------------------------------
--------------------By Form-----------------------
--------------------------------------------------
---------------------State----
----------------------Response - NewCo----------------------
Union all (SELECT concat(RISK_ST_ABBR,'Response',BU_ABBR,'NewCo',

(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                                sum(case when Datediff(month,TRANS_DT,sysdate())=18 THEN RESP_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 THEN RESP_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 THEN RESP_IND_CNT ELSE 0 END) AS "16",   
                                sum(case when Datediff(month,TRANS_DT,sysdate())=15 THEN RESP_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,TRANS_DT,sysdate())=14 THEN RESP_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,TRANS_DT,sysdate())=13 THEN RESP_IND_CNT ELSE 0 END) AS "13",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=12 THEN RESP_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 THEN RESP_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 THEN RESP_IND_CNT ELSE 0 END) AS "10",   
                                sum(case when Datediff(month,TRANS_DT,sysdate())=9  THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,TRANS_DT,sysdate())=8  THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  THEN RESP_IND_CNT ELSE 0 END) AS "7", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=6  THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  THEN RESP_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,TRANS_DT,sysdate())=4  THEN RESP_IND_CNT ELSE 0 END) AS "4",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------Response - NowCo----------------------
Union all (SELECT concat(RISK_ST_ABBR,'Response',BUS_UNIT_ABBR,'NowCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 THEN RESP_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 THEN RESP_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 THEN RESP_IND_CNT ELSE 0 END) AS "16",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 THEN RESP_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 THEN RESP_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 THEN RESP_IND_CNT ELSE 0 END) AS "13",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 THEN RESP_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 THEN RESP_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 THEN RESP_IND_CNT ELSE 0 END) AS "10",
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7 THEN RESP_IND_CNT ELSE 0 END) AS "7", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  THEN RESP_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4 THEN RESP_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1 THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0 THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------Phone Response - NewCo----------------------
union all (SELECT concat(RISK_ST_ABBR,'Phone Response',BU_ABBR,'NewCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 THEN RESP_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 THEN RESP_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 THEN RESP_IND_CNT ELSE 0 END) AS "16",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=15 THEN RESP_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,TRANS_DT,sysdate())=14 THEN RESP_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,TRANS_DT,sysdate())=13 THEN RESP_IND_CNT ELSE 0 END) AS "13",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=12 THEN RESP_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 THEN RESP_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 THEN RESP_IND_CNT ELSE 0 END) AS "10",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=9  THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,TRANS_DT,sysdate())=8  THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  THEN RESP_IND_CNT ELSE 0 END) AS "7", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=6  THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  THEN RESP_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,TRANS_DT,sysdate())=4  THEN RESP_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null and ORIG_QTE_CNTCT_METH_CD='P' GROUP BY Key)


---------------------- Phone Response - NowCo----------------------
Union all (SELECT concat(RISK_ST_ABBR,'Phone Response',BUS_UNIT_ABBR,'NowCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 THEN RESP_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 THEN RESP_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 THEN RESP_IND_CNT ELSE 0 END) AS "16",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 THEN RESP_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 THEN RESP_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 THEN RESP_IND_CNT ELSE 0 END) AS "13",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 THEN RESP_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 THEN RESP_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 THEN RESP_IND_CNT ELSE 0 END) AS "10",
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7 THEN RESP_IND_CNT ELSE 0 END) AS "7", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  THEN RESP_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4 THEN RESP_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1 THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0 THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null and   DERIV_CHNNL_NM='Telephone' GROUP BY Key)


---------------------- Auto Completed Quote - NewCo----------------------
Union all (SELECT concat(RISK_ST_ABBR,'Completed Auto Quotes',BU_ABBR,'NewCo') as Key,
                                 sum(case when Datediff(month,TRANS_DT,sysdate())=18 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "15",  sum(case when Datediff(month,TRANS_DT,sysdate())=14 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "14",  sum(case when Datediff(month,TRANS_DT,sysdate())=13 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "13",
                                sum(case when Datediff(month,TRANS_DT,sysdate())=12 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "10", sum(case when Datediff(month,TRANS_DT,sysdate())=9 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,TRANS_DT,sysdate())=8 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "8",
                                sum(case when Datediff(month,TRANS_DT,sysdate())=7  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,TRANS_DT,sysdate())=4 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "4",
                                 sum(case when Datediff(month,TRANS_DT,sysdate())=3  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW"                                       Where COMPL_QTE_IND = 'Y' and RISK_ST_ABBR <> 'FL' GROUP BY Key)


---------------------- Auto Completed Quote - NowCo----------------------
Union All (SELECT concat(RISK_STATE_ABBR,'Completed Auto Quotes',BUS_UNIT_ABBR,'NowCo') as Key,
                                sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=18 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=17 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=16 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "16",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=15 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "15",  
                                sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=14 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "14",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=13 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "13",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=12 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "12",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=11 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "11",  
                                sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=10 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "10",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=9 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=8 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=7 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=6 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=5 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "5",
                                sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=4 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "4",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=3 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=2 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=1 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=0 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."AUTO_QUOTE_FLOW_SCDI_MODEL_VW" Where BUS_UNIT_ABBR <> 'CDRT'and COMPL_QUOTE_IND = 'Y'and RISK_STATE_ABBR <> 'FL'  GROUP BY Key)


----------------------PBR/CQ - NewCo----------------------
Union all (SELECT concat(RISK_ST_ABBR,'PBR/CQ',BU_ABBR,'NewCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "18",   sum(case when Datediff(month,TRANS_DT,sysdate())=17 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,TRANS_DT,sysdate())=16 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "16",   sum(case when Datediff(month,TRANS_DT,sysdate())=15 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "15",   sum(case when Datediff(month,TRANS_DT,sysdate())=14 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "14",   sum(case when Datediff(month,TRANS_DT,sysdate())=13 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "13",   sum(case when Datediff(month,TRANS_DT,sysdate())=12 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "12",   sum(case when Datediff(month,TRANS_DT,sysdate())=11 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "11", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=10 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "10",   sum(case when Datediff(month,TRANS_DT,sysdate())=9 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,TRANS_DT,sysdate())=8 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "5",
                               sum(case when Datediff(month,TRANS_DT,sysdate())=4 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "4",  sum(case when Datediff(month,TRANS_DT,sysdate())=3 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------PBR/CQ - NowCo----------------------
Union all ( Select concat(RISK_ST_ABBR,'PBR/CQ',BUS_UNIT_ABBR,'NowCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "15",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "11", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "4",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------Issue Count - NewCo----------------------
Union all (SELECT concat(RISK_ST_ABBR,'IssueCount',BU_ABBR,'NewCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                                sum(case when Datediff(month,TRANS_DT,sysdate())=18 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "15",   sum(case when Datediff(month,TRANS_DT,sysdate())=14 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=13 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,TRANS_DT,sysdate())=12 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "10",   sum(case when Datediff(month,TRANS_DT,sysdate())=9 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "9", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=8  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,TRANS_DT,sysdate())=4 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)

----------------------Issue Count - NowCo----------------------
Union all (Select concat(RISK_ST_ABBR,'IssueCount',BUS_UNIT_ABBR,'NowCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "16",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "15",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "12",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "11",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "9",
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7  and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------AIP - NewCo----------------------
Union all (SELECT concat(RISK_ST_ABBR,'AIP',BU_ABBR,'NewCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "15",   sum(case when Datediff(month,TRANS_DT,sysdate())=14 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=13 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "13", sum(case when Datediff(month,TRANS_DT,sysdate())=12 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "10",   sum(case when Datediff(month,TRANS_DT,sysdate())=9 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "9", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=8  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "5", sum(case when Datediff(month,TRANS_DT,sysdate())=4 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------AIP - NowCo----------------------
Union all (Select concat(RISK_ST_ABBR,'AIP',BUS_UNIT_ABBR,'NowCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=17 and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "17",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "16",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "15",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=12 and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "12",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "11",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "9",
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=7  and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=2  and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF 
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------AQP - NewCo----------------------
Union all (SELECT concat(RISK_ST_ABBR,'AQP',BU_ABBR,'NewCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "15", sum(case when Datediff(month,TRANS_DT,sysdate())=14 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=13 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "13", sum(case when Datediff(month,TRANS_DT,sysdate())=12 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "10", sum(case when Datediff(month,TRANS_DT,sysdate())=9 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "9", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=8  and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "5", sum(case when Datediff(month,TRANS_DT,sysdate())=4 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------AQP - NowCo----------------------
Union all ( Select concat(RISK_ST_ABBR,'AQP',BUS_UNIT_ABBR,'NowCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=18 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=17 and COMP_QTE_IND_CNT = '1' THEN TERM_WRIT_PREM ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "16", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "15", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=13 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=12 and COMP_QTE_IND_CNT = '1' THEN TERM_WRIT_PREM ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "11", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "9",
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=8  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=7  and COMP_QTE_IND_CNT = '1' THEN TERM_WRIT_PREM ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=3  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=2  and COMP_QTE_IND_CNT = '1' THEN TERM_WRIT_PREM ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------CQ - NewCo----------------------
Union all (SELECT concat(RISK_ST_ABBR,'CQ',BU_ABBR,'NewCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "15",   sum(case when Datediff(month,TRANS_DT,sysdate())=14 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=13 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,TRANS_DT,sysdate())=12 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "10",   sum(case when Datediff(month,TRANS_DT,sysdate())=9 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "9", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=8  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,TRANS_DT,sysdate())=4 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------CQ - NowCo----------------------
Union All (Select concat(RISK_ST_ABBR,'CQ',BUS_UNIT_ABBR,'NowCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=18 and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=17 and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=16 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=15 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=14 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=13 and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=12 and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=11 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=10 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=9  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "9",
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=8  and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=7  and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=6  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=5  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=4  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=3  and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=2  and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=1  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=0  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


---------------------- Auto Issues - NewCo----------------------
Union All (SELECT concat(RISK_ST_ABBR,'Auto Issues',BU_ABBR,'NewCo') as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 THEN ISSUE_IND_CNT ELSE 0 END) AS "18",  sum(case when Datediff(month,TRANS_DT,sysdate())=17 THEN ISSUE_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,TRANS_DT,sysdate())=16 THEN ISSUE_IND_CNT ELSE 0 END) AS "16",  sum(case when Datediff(month,TRANS_DT,sysdate())=15 THEN ISSUE_IND_CNT ELSE 0 END) AS "15",  sum(case when Datediff(month,TRANS_DT,sysdate())=14 THEN ISSUE_IND_CNT ELSE 0 END) AS "14",
                               sum(case when Datediff(month,TRANS_DT,sysdate())=13 THEN ISSUE_IND_CNT ELSE 0 END) AS "13",  sum(case when Datediff(month,TRANS_DT,sysdate())=12 THEN ISSUE_IND_CNT ELSE 0 END) AS "12",  sum(case when Datediff(month,TRANS_DT,sysdate())=11 THEN ISSUE_IND_CNT ELSE 0 END) AS "11",  sum(case when Datediff(month,TRANS_DT,sysdate())=10 THEN ISSUE_IND_CNT ELSE 0 END) AS "10",  sum(case when Datediff(month,TRANS_DT,sysdate())=9 THEN ISSUE_IND_CNT ELSE 0 END) AS "9",
                               sum(case when Datediff(month,TRANS_DT,sysdate())=8 THEN ISSUE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7 THEN ISSUE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6 THEN ISSUE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5 THEN ISSUE_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,TRANS_DT,sysdate())=4 THEN ISSUE_IND_CNT ELSE 0 END) AS "4",
                               sum(case when Datediff(month,TRANS_DT,sysdate())=3 THEN ISSUE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2 THEN ISSUE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1 THEN ISSUE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 THEN ISSUE_IND_CNT ELSE 0 END) AS "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF   
FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW"                                       Where COMPL_QTE_IND = 'Y' and RISK_ST_ABBR <> 'FL'   GROUP BY Key)


---------------------- Auto Issues  - NowCo----------------------
Union All (SELECT   concat(RISK_STATE_ABBR,'Auto Issues',BUS_UNIT_ABBR,'NowCo') as Key,
                               sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=18 THEN ISSUE_IND_CNT ELSE 0 END) AS "18",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=17 THEN ISSUE_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=16 THEN ISSUE_IND_CNT ELSE 0 END) AS "16",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=15 THEN ISSUE_IND_CNT ELSE 0 END) AS "15",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=14 THEN ISSUE_IND_CNT ELSE 0 END) AS "14",
                               sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=13 THEN ISSUE_IND_CNT ELSE 0 END) AS "13",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=12 THEN ISSUE_IND_CNT ELSE 0 END) AS "12",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=11 THEN ISSUE_IND_CNT ELSE 0 END) AS "11",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=10 THEN ISSUE_IND_CNT ELSE 0 END) AS "10",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=9 THEN ISSUE_IND_CNT ELSE 0 END) AS "9",
                               sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=8 THEN ISSUE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=7 THEN ISSUE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=6 THEN ISSUE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=5 THEN ISSUE_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=4 THEN ISSUE_IND_CNT ELSE 0 END) AS "4",
                               sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=3 THEN ISSUE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=2 THEN ISSUE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=1 THEN ISSUE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=0 THEN ISSUE_IND_CNT ELSE 0 END) as "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."AUTO_QUOTE_FLOW_SCDI_MODEL_VW" Where BUS_UNIT_ABBR <> 'CDRT' and RISK_STATE_ABBR <> 'FL' GROUP BY Key)


----------------------HIGSRP - NewCo----------------------
Union all (SELECT concat(RISK_ST_ABBR,'HIGSRP',BU_ABBR,'NewCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=18 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "18", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=17 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "17", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=16 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "16", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=15 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "15", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=14 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "14",
                               nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=13 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "13", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=12 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "12", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=11 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "11", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=10 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "10", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=9  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "9",
                               nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=8  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "8", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=7  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "7", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=6  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "6", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=5  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "5", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=4  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "4",
                               nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=3  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "3", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=2  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "2", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=1  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "1", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=0  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null and QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0 and ORIG_QTE_CNTCT_METH_CD = 'P' GROUP BY Key)



----------------------HIGSRP - NowCo----------------------
Union all (Select concat(RISK_ST_ABBR,'HIGSRP',BUS_UNIT_ABBR,'NowCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "18",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "17",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "16",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "15",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "14",  
                                nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "13",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "12",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "11",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "10",  nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "9",
                               nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "8",  nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "7",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "6",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "5",  nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "4", 
                                nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "3",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "2",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "1",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null and COMP_QTE_IND_CNT = 1 AND PRR_CARR_POL_PREM_AMT >= 300 AND TERM_WRIT_PREM > 0 and DERIV_CHNNL_NM = 'Telephone' and BUS_UNIT_ABBR = 'AARP' GROUP BY Key)

---------CW-----------------------------------------------------------------
----------------------Response - NewCo----------------------
Union all (SELECT concat('CW','Response',BU_ABBR,'NewCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                                sum(case when Datediff(month,TRANS_DT,sysdate())=18 THEN RESP_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 THEN RESP_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 THEN RESP_IND_CNT ELSE 0 END) AS "16",   
                                sum(case when Datediff(month,TRANS_DT,sysdate())=15 THEN RESP_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,TRANS_DT,sysdate())=14 THEN RESP_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,TRANS_DT,sysdate())=13 THEN RESP_IND_CNT ELSE 0 END) AS "13",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=12 THEN RESP_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 THEN RESP_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 THEN RESP_IND_CNT ELSE 0 END) AS "10",   
                                sum(case when Datediff(month,TRANS_DT,sysdate())=9  THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,TRANS_DT,sysdate())=8  THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  THEN RESP_IND_CNT ELSE 0 END) AS "7", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=6  THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  THEN RESP_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,TRANS_DT,sysdate())=4  THEN RESP_IND_CNT ELSE 0 END) AS "4",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------Response - NowCo----------------------
Union all (SELECT concat('CW','Response',BUS_UNIT_ABBR,'NowCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 THEN RESP_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 THEN RESP_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 THEN RESP_IND_CNT ELSE 0 END) AS "16",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 THEN RESP_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 THEN RESP_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 THEN RESP_IND_CNT ELSE 0 END) AS "13",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 THEN RESP_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 THEN RESP_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 THEN RESP_IND_CNT ELSE 0 END) AS "10",
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7 THEN RESP_IND_CNT ELSE 0 END) AS "7", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  THEN RESP_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4 THEN RESP_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1 THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0 THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------Phone Response - NewCo----------------------
union all (SELECT concat('CW','Phone Response',BU_ABBR,'NewCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 THEN RESP_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 THEN RESP_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 THEN RESP_IND_CNT ELSE 0 END) AS "16",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=15 THEN RESP_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,TRANS_DT,sysdate())=14 THEN RESP_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,TRANS_DT,sysdate())=13 THEN RESP_IND_CNT ELSE 0 END) AS "13",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=12 THEN RESP_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 THEN RESP_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 THEN RESP_IND_CNT ELSE 0 END) AS "10",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=9  THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,TRANS_DT,sysdate())=8  THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  THEN RESP_IND_CNT ELSE 0 END) AS "7", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=6  THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  THEN RESP_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,TRANS_DT,sysdate())=4  THEN RESP_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null and ORIG_QTE_CNTCT_METH_CD='P' GROUP BY Key)


---------------------- Phone Response - NowCo----------------------
Union all (SELECT concat('CW','Phone Response',BUS_UNIT_ABBR,'NowCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 THEN RESP_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 THEN RESP_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 THEN RESP_IND_CNT ELSE 0 END) AS "16",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 THEN RESP_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 THEN RESP_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 THEN RESP_IND_CNT ELSE 0 END) AS "13",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 THEN RESP_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 THEN RESP_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 THEN RESP_IND_CNT ELSE 0 END) AS "10",
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7 THEN RESP_IND_CNT ELSE 0 END) AS "7", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  THEN RESP_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4 THEN RESP_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1 THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0 THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null and   DERIV_CHNNL_NM='Telephone' GROUP BY Key)


---------------------- Auto Completed Quote - NewCo----------------------
Union all (SELECT concat('CW','Completed Auto Quotes',BU_ABBR,'NewCo') as Key,
                                 sum(case when Datediff(month,TRANS_DT,sysdate())=18 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "15",  sum(case when Datediff(month,TRANS_DT,sysdate())=14 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "14",  sum(case when Datediff(month,TRANS_DT,sysdate())=13 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "13",
                                sum(case when Datediff(month,TRANS_DT,sysdate())=12 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "10", sum(case when Datediff(month,TRANS_DT,sysdate())=9 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,TRANS_DT,sysdate())=8 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "8",
                                sum(case when Datediff(month,TRANS_DT,sysdate())=7  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,TRANS_DT,sysdate())=4 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "4",
                                 sum(case when Datediff(month,TRANS_DT,sysdate())=3  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW"                                       Where COMPL_QTE_IND = 'Y' and 'CW' <> 'FL' GROUP BY Key)


---------------------- Auto Completed Quote - NowCo----------------------
Union All (SELECT concat('CW','Completed Auto Quotes',BUS_UNIT_ABBR,'NowCo') as Key,
                                sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=18 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=17 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=16 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "16",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=15 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "15",  
                                sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=14 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "14",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=13 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "13",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=12 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "12",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=11 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "11",  
                                sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=10 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "10",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=9 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=8 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=7 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=6 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=5 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "5",
                                sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=4 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "4",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=3 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=2 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=1 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=0 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."AUTO_QUOTE_FLOW_SCDI_MODEL_VW" Where BUS_UNIT_ABBR <> 'CDRT'and COMPL_QUOTE_IND = 'Y'and 'CW' <> 'FL'  GROUP BY Key)

----------------------PBR/CQ - NewCo----------------------
Union all (SELECT concat('CW','PBR/CQ',BU_ABBR,'NewCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "18",   sum(case when Datediff(month,TRANS_DT,sysdate())=17 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,TRANS_DT,sysdate())=16 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "16",   sum(case when Datediff(month,TRANS_DT,sysdate())=15 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "15",   sum(case when Datediff(month,TRANS_DT,sysdate())=14 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "14",   sum(case when Datediff(month,TRANS_DT,sysdate())=13 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "13",   sum(case when Datediff(month,TRANS_DT,sysdate())=12 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "12",   sum(case when Datediff(month,TRANS_DT,sysdate())=11 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "11", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=10 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "10",   sum(case when Datediff(month,TRANS_DT,sysdate())=9 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,TRANS_DT,sysdate())=8 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "5",
                               sum(case when Datediff(month,TRANS_DT,sysdate())=4 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "4",  sum(case when Datediff(month,TRANS_DT,sysdate())=3 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------PBR/CQ - NowCo----------------------
Union all ( Select concat('CW','PBR/CQ',BUS_UNIT_ABBR,'NowCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "15",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "11", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "4",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------Issue Count - NewCo----------------------
Union all (SELECT concat('CW','IssueCount',BU_ABBR,'NewCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                                sum(case when Datediff(month,TRANS_DT,sysdate())=18 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "15",   sum(case when Datediff(month,TRANS_DT,sysdate())=14 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=13 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,TRANS_DT,sysdate())=12 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "10",   sum(case when Datediff(month,TRANS_DT,sysdate())=9 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "9", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=8  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,TRANS_DT,sysdate())=4 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------Issue Count - NowCo----------------------
Union all (Select concat('CW','IssueCount',BUS_UNIT_ABBR,'NowCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "16",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "15",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "12",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "11",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "9",
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7  and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------AIP - NewCo----------------------
Union all (SELECT concat('CW','AIP',BU_ABBR,'NewCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "15",   sum(case when Datediff(month,TRANS_DT,sysdate())=14 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=13 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "13", sum(case when Datediff(month,TRANS_DT,sysdate())=12 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "10",   sum(case when Datediff(month,TRANS_DT,sysdate())=9 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "9", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=8  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "5", sum(case when Datediff(month,TRANS_DT,sysdate())=4 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------AIP - NowCo----------------------
Union all (Select concat('CW','AIP',BUS_UNIT_ABBR,'NowCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=17 and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "17",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "16",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "15",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=12 and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "12",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "11",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "9",
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=7  and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=2  and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF 
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------AQP - NewCo----------------------
Union all (SELECT concat('CW','AQP',BU_ABBR,'NewCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "15", sum(case when Datediff(month,TRANS_DT,sysdate())=14 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=13 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "13", sum(case when Datediff(month,TRANS_DT,sysdate())=12 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "10", sum(case when Datediff(month,TRANS_DT,sysdate())=9 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "9", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=8  and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "5", sum(case when Datediff(month,TRANS_DT,sysdate())=4 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------AQP - NowCo----------------------
Union all ( Select concat('CW','AQP',BUS_UNIT_ABBR,'NowCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=18 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=17 and COMP_QTE_IND_CNT = '1' THEN TERM_WRIT_PREM ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "16", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "15", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=13 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=12 and COMP_QTE_IND_CNT = '1' THEN TERM_WRIT_PREM ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "11", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "9",
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=8  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=7  and COMP_QTE_IND_CNT = '1' THEN TERM_WRIT_PREM ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=3  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=2  and COMP_QTE_IND_CNT = '1' THEN TERM_WRIT_PREM ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------CQ - NewCo----------------------
Union all (SELECT concat('CW','CQ',BU_ABBR,'NewCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "15",   sum(case when Datediff(month,TRANS_DT,sysdate())=14 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=13 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,TRANS_DT,sysdate())=12 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "10",   sum(case when Datediff(month,TRANS_DT,sysdate())=9 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "9", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=8  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,TRANS_DT,sysdate())=4 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------CQ - NowCo----------------------
Union All (Select concat('CW','CQ',BUS_UNIT_ABBR,'NowCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=18 and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=17 and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=16 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=15 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=14 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=13 and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=12 and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=11 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=10 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=9  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "9",
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=8  and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=7  and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=6  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=5  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=4  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=3  and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=2  and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=1  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=0  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


---------------------- Auto Issues - NewCo----------------------
Union All (SELECT concat('CW','Auto Issues',BU_ABBR,'NewCo') as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 THEN ISSUE_IND_CNT ELSE 0 END) AS "18",  sum(case when Datediff(month,TRANS_DT,sysdate())=17 THEN ISSUE_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,TRANS_DT,sysdate())=16 THEN ISSUE_IND_CNT ELSE 0 END) AS "16",  sum(case when Datediff(month,TRANS_DT,sysdate())=15 THEN ISSUE_IND_CNT ELSE 0 END) AS "15",  sum(case when Datediff(month,TRANS_DT,sysdate())=14 THEN ISSUE_IND_CNT ELSE 0 END) AS "14",
                               sum(case when Datediff(month,TRANS_DT,sysdate())=13 THEN ISSUE_IND_CNT ELSE 0 END) AS "13",  sum(case when Datediff(month,TRANS_DT,sysdate())=12 THEN ISSUE_IND_CNT ELSE 0 END) AS "12",  sum(case when Datediff(month,TRANS_DT,sysdate())=11 THEN ISSUE_IND_CNT ELSE 0 END) AS "11",  sum(case when Datediff(month,TRANS_DT,sysdate())=10 THEN ISSUE_IND_CNT ELSE 0 END) AS "10",  sum(case when Datediff(month,TRANS_DT,sysdate())=9 THEN ISSUE_IND_CNT ELSE 0 END) AS "9",
                               sum(case when Datediff(month,TRANS_DT,sysdate())=8 THEN ISSUE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7 THEN ISSUE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6 THEN ISSUE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5 THEN ISSUE_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,TRANS_DT,sysdate())=4 THEN ISSUE_IND_CNT ELSE 0 END) AS "4",
                               sum(case when Datediff(month,TRANS_DT,sysdate())=3 THEN ISSUE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2 THEN ISSUE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1 THEN ISSUE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 THEN ISSUE_IND_CNT ELSE 0 END) AS "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF   
FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW"                                       Where COMPL_QTE_IND = 'Y' and 'CW' <> 'FL'   GROUP BY Key)


---------------------- Auto Issues  - NowCo----------------------
Union All (SELECT   concat('CW','Auto Issues',BUS_UNIT_ABBR,'NowCo') as Key,
                               sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=18 THEN ISSUE_IND_CNT ELSE 0 END) AS "18",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=17 THEN ISSUE_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=16 THEN ISSUE_IND_CNT ELSE 0 END) AS "16",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=15 THEN ISSUE_IND_CNT ELSE 0 END) AS "15",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=14 THEN ISSUE_IND_CNT ELSE 0 END) AS "14",
                               sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=13 THEN ISSUE_IND_CNT ELSE 0 END) AS "13",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=12 THEN ISSUE_IND_CNT ELSE 0 END) AS "12",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=11 THEN ISSUE_IND_CNT ELSE 0 END) AS "11",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=10 THEN ISSUE_IND_CNT ELSE 0 END) AS "10",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=9 THEN ISSUE_IND_CNT ELSE 0 END) AS "9",
                               sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=8 THEN ISSUE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=7 THEN ISSUE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=6 THEN ISSUE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=5 THEN ISSUE_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=4 THEN ISSUE_IND_CNT ELSE 0 END) AS "4",
                               sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=3 THEN ISSUE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=2 THEN ISSUE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=1 THEN ISSUE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=0 THEN ISSUE_IND_CNT ELSE 0 END) as "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."AUTO_QUOTE_FLOW_SCDI_MODEL_VW" Where BUS_UNIT_ABBR <> 'CDRT' and 'CW' <> 'FL' GROUP BY Key)


----------------------HIGSRP - NewCo----------------------
Union all (SELECT concat('CW','HIGSRP',BU_ABBR,'NewCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=18 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "18", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=17 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "17", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=16 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "16", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=15 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "15", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=14 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "14",
                               nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=13 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "13", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=12 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "12", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=11 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "11", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=10 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "10", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=9  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "9",
                               nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=8  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "8", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=7  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "7", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=6  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "6", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=5  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "5", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=4  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "4",
                               nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=3  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "3", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=2  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "2", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=1  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "1", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=0  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null and QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0 and ORIG_QTE_CNTCT_METH_CD = 'P' GROUP BY Key)



----------------------HIGSRP - NowCo----------------------
Union all (Select concat('CW','HIGSRP',BUS_UNIT_ABBR,'NowCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "18",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "17",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "16",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "15",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "14",  
                                nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "13",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "12",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "11",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "10",  nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "9",
                               nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "8",  nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "7",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "6",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "5",  nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "4", 
                                nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "3",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "2",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "1",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null and COMP_QTE_IND_CNT = 1 AND PRR_CARR_POL_PREM_AMT >= 300 AND TERM_WRIT_PREM > 0 and DERIV_CHNNL_NM = 'Telephone' and BUS_UNIT_ABBR = 'AARP' GROUP BY Key)



---------------------Region----
----------------------Response - NewCo----------------------
Union all (SELECT concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'Response',BU_ABBR,'NewCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                                sum(case when Datediff(month,TRANS_DT,sysdate())=18 THEN RESP_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 THEN RESP_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 THEN RESP_IND_CNT ELSE 0 END) AS "16",   
                                sum(case when Datediff(month,TRANS_DT,sysdate())=15 THEN RESP_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,TRANS_DT,sysdate())=14 THEN RESP_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,TRANS_DT,sysdate())=13 THEN RESP_IND_CNT ELSE 0 END) AS "13",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=12 THEN RESP_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 THEN RESP_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 THEN RESP_IND_CNT ELSE 0 END) AS "10",   
                                sum(case when Datediff(month,TRANS_DT,sysdate())=9  THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,TRANS_DT,sysdate())=8  THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  THEN RESP_IND_CNT ELSE 0 END) AS "7", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=6  THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  THEN RESP_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,TRANS_DT,sysdate())=4  THEN RESP_IND_CNT ELSE 0 END) AS "4",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------Response - NowCo----------------------
Union all (SELECT concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'Response',BUS_UNIT_ABBR,'NowCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 THEN RESP_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 THEN RESP_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 THEN RESP_IND_CNT ELSE 0 END) AS "16",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 THEN RESP_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 THEN RESP_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 THEN RESP_IND_CNT ELSE 0 END) AS "13",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 THEN RESP_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 THEN RESP_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 THEN RESP_IND_CNT ELSE 0 END) AS "10",
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7 THEN RESP_IND_CNT ELSE 0 END) AS "7", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  THEN RESP_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4 THEN RESP_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1 THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0 THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------Phone Response - NewCo----------------------
union all (SELECT concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'Phone Response',BU_ABBR,'NewCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 THEN RESP_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 THEN RESP_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 THEN RESP_IND_CNT ELSE 0 END) AS "16",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=15 THEN RESP_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,TRANS_DT,sysdate())=14 THEN RESP_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,TRANS_DT,sysdate())=13 THEN RESP_IND_CNT ELSE 0 END) AS "13",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=12 THEN RESP_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 THEN RESP_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 THEN RESP_IND_CNT ELSE 0 END) AS "10",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=9  THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,TRANS_DT,sysdate())=8  THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  THEN RESP_IND_CNT ELSE 0 END) AS "7", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=6  THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  THEN RESP_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,TRANS_DT,sysdate())=4  THEN RESP_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null and ORIG_QTE_CNTCT_METH_CD='P' GROUP BY Key)


---------------------- Phone Response - NowCo----------------------
Union all (SELECT concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'Phone Response',BUS_UNIT_ABBR,'NowCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 THEN RESP_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 THEN RESP_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 THEN RESP_IND_CNT ELSE 0 END) AS "16",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 THEN RESP_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 THEN RESP_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 THEN RESP_IND_CNT ELSE 0 END) AS "13",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 THEN RESP_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 THEN RESP_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 THEN RESP_IND_CNT ELSE 0 END) AS "10",
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7 THEN RESP_IND_CNT ELSE 0 END) AS "7", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  THEN RESP_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4 THEN RESP_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1 THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0 THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null and   DERIV_CHNNL_NM='Telephone' GROUP BY Key)


---------------------- Auto Completed Quote - NewCo----------------------
Union all (SELECT concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'Completed Auto Quotes',BU_ABBR,'NewCo') as Key,
                                 sum(case when Datediff(month,TRANS_DT,sysdate())=18 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "15",  sum(case when Datediff(month,TRANS_DT,sysdate())=14 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "14",  sum(case when Datediff(month,TRANS_DT,sysdate())=13 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "13",
                                sum(case when Datediff(month,TRANS_DT,sysdate())=12 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "10", sum(case when Datediff(month,TRANS_DT,sysdate())=9 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,TRANS_DT,sysdate())=8 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "8",
                                sum(case when Datediff(month,TRANS_DT,sysdate())=7  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,TRANS_DT,sysdate())=4 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "4",
                                 sum(case when Datediff(month,TRANS_DT,sysdate())=3  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW"                                       Where COMPL_QTE_IND = 'Y' and RISK_ST_ABBR <> 'FL' GROUP BY Key)


---------------------- Auto Completed Quote - NowCo----------------------
Union All (SELECT concat((case when RISK_STATE_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_STATE_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_STATE_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_STATE_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'Completed Auto Quotes',BUS_UNIT_ABBR,'NowCo') as Key,
                                sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=18 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=17 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=16 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "16",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=15 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "15",  
                                sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=14 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "14",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=13 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "13",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=12 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "12",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=11 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "11",  
                                sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=10 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "10",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=9 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=8 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=7 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=6 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=5 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "5",
                                sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=4 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "4",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=3 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=2 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=1 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=0 THEN COMPL_QUOTE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."AUTO_QUOTE_FLOW_SCDI_MODEL_VW" Where BUS_UNIT_ABBR <> 'CDRT'and COMPL_QUOTE_IND = 'Y'and RISK_STATE_ABBR <> 'FL'  GROUP BY Key)


----------------------PBR/CQ - NewCo----------------------
Union all (SELECT concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'PBR/CQ',BU_ABBR,'NewCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "18",   sum(case when Datediff(month,TRANS_DT,sysdate())=17 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,TRANS_DT,sysdate())=16 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "16",   sum(case when Datediff(month,TRANS_DT,sysdate())=15 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "15",   sum(case when Datediff(month,TRANS_DT,sysdate())=14 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "14",   sum(case when Datediff(month,TRANS_DT,sysdate())=13 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "13",   sum(case when Datediff(month,TRANS_DT,sysdate())=12 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "12",   sum(case when Datediff(month,TRANS_DT,sysdate())=11 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "11", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=10 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "10",   sum(case when Datediff(month,TRANS_DT,sysdate())=9 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,TRANS_DT,sysdate())=8 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "5",
                               sum(case when Datediff(month,TRANS_DT,sysdate())=4 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "4",  sum(case when Datediff(month,TRANS_DT,sysdate())=3 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 and (COMPL_QTE_IND_CNT =1 or QQ_IND_CNT=1) THEN RESP_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------PBR/CQ - NowCo----------------------
Union all ( Select concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'PBR/CQ',BUS_UNIT_ABBR,'NowCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "15",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "14", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "11", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 THEN COMP_QTE_IND_CNT ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "9",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "4",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------Issue Count - NewCo----------------------
Union all (SELECT concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'IssueCount',BU_ABBR,'NewCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                                sum(case when Datediff(month,TRANS_DT,sysdate())=18 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "15",   sum(case when Datediff(month,TRANS_DT,sysdate())=14 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=13 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,TRANS_DT,sysdate())=12 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "10",   sum(case when Datediff(month,TRANS_DT,sysdate())=9 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "9", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=8  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,TRANS_DT,sysdate())=4 and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0  and ISSUE_IND ='Y' THEN ISSUE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------Issue Count - NowCo----------------------
Union all (Select concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'IssueCount',BUS_UNIT_ABBR,'NowCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "16",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "15",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "12",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "11",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "9",
                               sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7  and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  and ISS_IND = 'Y' THEN ISS_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  and ISS_IND = 'Y'  THEN ISS_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------AIP - NewCo----------------------
Union all (SELECT concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'AIP',BU_ABBR,'NewCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "15",   sum(case when Datediff(month,TRANS_DT,sysdate())=14 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=13 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "13", sum(case when Datediff(month,TRANS_DT,sysdate())=12 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "10",   sum(case when Datediff(month,TRANS_DT,sysdate())=9 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "9", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=8  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "5", sum(case when Datediff(month,TRANS_DT,sysdate())=4 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 and ISSUE_IND ='Y' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------AIP - NowCo----------------------
Union all (Select concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'AIP',BUS_UNIT_ABBR,'NowCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=17 and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "17",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "16",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "15",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=12 and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "12",   sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "11",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "9",
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=7  and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=2  and ISS_IND = 'Y' THEN TERM_WRIT_PREM ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  and ISS_IND = 'Y'  THEN TERM_WRIT_PREM ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF 
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------AQP - NewCo----------------------
Union all (SELECT concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'AQP',BU_ABBR,'NewCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "15", sum(case when Datediff(month,TRANS_DT,sysdate())=14 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=13 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "13", sum(case when Datediff(month,TRANS_DT,sysdate())=12 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "10", sum(case when Datediff(month,TRANS_DT,sysdate())=9 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "9", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=8  and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "5", sum(case when Datediff(month,TRANS_DT,sysdate())=4 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 and COMPL_QTE_IND_CNT ='1' THEN POL_TTL_BILL_PREM_AMT ELSE 0 END) AS "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------AQP - NowCo----------------------
Union all ( Select concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'AQP',BUS_UNIT_ABBR,'NowCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=18 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=17 and COMP_QTE_IND_CNT = '1' THEN TERM_WRIT_PREM ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "16", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "15", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=13 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=12 and COMP_QTE_IND_CNT = '1' THEN TERM_WRIT_PREM ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "11", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "9",
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=8  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=7  and COMP_QTE_IND_CNT = '1' THEN TERM_WRIT_PREM ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=3  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=2  and COMP_QTE_IND_CNT = '1' THEN TERM_WRIT_PREM ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  and COMP_QTE_IND_CNT = '1'  THEN TERM_WRIT_PREM ELSE 0 END) AS "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


----------------------CQ - NewCo----------------------
Union all (SELECT concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'CQ',BU_ABBR,'NewCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,TRANS_DT,sysdate())=17 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,TRANS_DT,sysdate())=16 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,TRANS_DT,sysdate())=15 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "15",   sum(case when Datediff(month,TRANS_DT,sysdate())=14 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,TRANS_DT,sysdate())=13 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,TRANS_DT,sysdate())=12 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,TRANS_DT,sysdate())=11 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,TRANS_DT,sysdate())=10 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "10",   sum(case when Datediff(month,TRANS_DT,sysdate())=9 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "9", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=8  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,TRANS_DT,sysdate())=4 and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,TRANS_DT,sysdate())=3  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0  and COMPL_QTE_IND_CNT ='1' THEN COMPL_QTE_IND_CNT ELSE 0 END) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null GROUP BY Key)


----------------------CQ - NowCo----------------------
Union All (Select concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'CQ',BUS_UNIT_ABBR,'NowCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=18 and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "18", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=17 and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "17", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=16 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "16", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=15 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "15", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=14 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "14",  
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=13 and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "13", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=12 and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "12", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=11 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "11", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=10 and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "10", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=9  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "9",
                               sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=8  and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=7  and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=6  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=5  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "5", sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=4  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "4", 
                                sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=3  and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=2  and COMP_QTE_IND_CNT = '1' THEN COMP_QTE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=1  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,(TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID),'YYYYMMDD')),sysdate())=0  and COMP_QTE_IND_CNT = '1'  THEN COMP_QTE_IND_CNT ELSE 0 END) AS "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null GROUP BY Key)


---------------------- Auto Issues - NewCo----------------------
Union All (SELECT concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'Auto Issues',BU_ABBR,'NewCo') as Key,
                               sum(case when Datediff(month,TRANS_DT,sysdate())=18 THEN ISSUE_IND_CNT ELSE 0 END) AS "18",  sum(case when Datediff(month,TRANS_DT,sysdate())=17 THEN ISSUE_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,TRANS_DT,sysdate())=16 THEN ISSUE_IND_CNT ELSE 0 END) AS "16",  sum(case when Datediff(month,TRANS_DT,sysdate())=15 THEN ISSUE_IND_CNT ELSE 0 END) AS "15",  sum(case when Datediff(month,TRANS_DT,sysdate())=14 THEN ISSUE_IND_CNT ELSE 0 END) AS "14",
                               sum(case when Datediff(month,TRANS_DT,sysdate())=13 THEN ISSUE_IND_CNT ELSE 0 END) AS "13",  sum(case when Datediff(month,TRANS_DT,sysdate())=12 THEN ISSUE_IND_CNT ELSE 0 END) AS "12",  sum(case when Datediff(month,TRANS_DT,sysdate())=11 THEN ISSUE_IND_CNT ELSE 0 END) AS "11",  sum(case when Datediff(month,TRANS_DT,sysdate())=10 THEN ISSUE_IND_CNT ELSE 0 END) AS "10",  sum(case when Datediff(month,TRANS_DT,sysdate())=9 THEN ISSUE_IND_CNT ELSE 0 END) AS "9",
                               sum(case when Datediff(month,TRANS_DT,sysdate())=8 THEN ISSUE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,TRANS_DT,sysdate())=7 THEN ISSUE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,TRANS_DT,sysdate())=6 THEN ISSUE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,TRANS_DT,sysdate())=5 THEN ISSUE_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,TRANS_DT,sysdate())=4 THEN ISSUE_IND_CNT ELSE 0 END) AS "4",
                               sum(case when Datediff(month,TRANS_DT,sysdate())=3 THEN ISSUE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,TRANS_DT,sysdate())=2 THEN ISSUE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,TRANS_DT,sysdate())=1 THEN ISSUE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,TRANS_DT,sysdate())=0 THEN ISSUE_IND_CNT ELSE 0 END) AS "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF   
FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW"                                       Where COMPL_QTE_IND = 'Y' and RISK_ST_ABBR <> 'FL'   GROUP BY Key)


---------------------- Auto Issues  - NowCo----------------------
Union All (SELECT  concat((case when RISK_STATE_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_STATE_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_STATE_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_STATE_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'Auto Issues',BUS_UNIT_ABBR,'NowCo') as Key,
                               sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=18 THEN ISSUE_IND_CNT ELSE 0 END) AS "18",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=17 THEN ISSUE_IND_CNT ELSE 0 END) AS "17",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=16 THEN ISSUE_IND_CNT ELSE 0 END) AS "16",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=15 THEN ISSUE_IND_CNT ELSE 0 END) AS "15",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=14 THEN ISSUE_IND_CNT ELSE 0 END) AS "14",
                               sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=13 THEN ISSUE_IND_CNT ELSE 0 END) AS "13",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=12 THEN ISSUE_IND_CNT ELSE 0 END) AS "12",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=11 THEN ISSUE_IND_CNT ELSE 0 END) AS "11",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=10 THEN ISSUE_IND_CNT ELSE 0 END) AS "10",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=9 THEN ISSUE_IND_CNT ELSE 0 END) AS "9",
                               sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=8 THEN ISSUE_IND_CNT ELSE 0 END) AS "8",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=7 THEN ISSUE_IND_CNT ELSE 0 END) AS "7",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=6 THEN ISSUE_IND_CNT ELSE 0 END) AS "6",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=5 THEN ISSUE_IND_CNT ELSE 0 END) AS "5",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=4 THEN ISSUE_IND_CNT ELSE 0 END) AS "4",
                               sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=3 THEN ISSUE_IND_CNT ELSE 0 END) AS "3",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=2 THEN ISSUE_IND_CNT ELSE 0 END) AS "2",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=1 THEN ISSUE_IND_CNT ELSE 0 END) AS "1",  sum(case when Datediff(month,QUOTE_LAST_TRANSACTION_DT,sysdate())=0 THEN ISSUE_IND_CNT ELSE 0 END) as "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."AUTO_QUOTE_FLOW_SCDI_MODEL_VW" Where BUS_UNIT_ABBR <> 'CDRT' and RISK_STATE_ABBR <> 'FL' GROUP BY Key)


----------------------HIGSRP - NewCo----------------------
Union all (SELECT concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'HIGSRP',BU_ABBR,'NewCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=18 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "18", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=17 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "17", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=16 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "16", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=15 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "15", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=14 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "14",
                               nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=13 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "13", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=12 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "12", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=11 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "11", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=10 THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "10", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=9  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "9",
                               nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=8  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "8", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=7  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "7", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=6  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "6", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=5  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "5", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=4  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "4",
                               nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=3  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "3", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=2  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "2", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=1  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "1", nullifzero(Avg((case when Datediff(month,TRANS_DT,sysdate())=0  THEN (QQ_ANNL_POL_PREM_AMT/PCARR_POL_TERM_TTL_PREM_AMT) else null end))) as "0",
                               TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"                                      where POL_FORM_CD is not null and QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0 and ORIG_QTE_CNTCT_METH_CD = 'P' GROUP BY Key)



----------------------HIGSRP - NowCo----------------------
Union all (Select concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'HIGSRP',BUS_UNIT_ABBR,'NowCo',(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,
                               nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=18 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "18",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=17 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "17",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=16 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "16",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=15 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "15",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=14 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "14",  
                                nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=13 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "13",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=12 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "12",    nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=11 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "11",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=10 THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "10",  nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=9  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "9",
                               nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=8  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "8",  nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=7  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "7",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=6  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "6",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=5  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "5",  nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=4  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "4", 
                                nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=3  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "3",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=2  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "2",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=1  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "1",   nullifzero(Avg((case when Datediff(month,(TO_DATE (TO_CHAR (LAST_TRANS_DT_PK_ID), 'YYYYMMDD')),sysdate())=0  THEN (TERM_WRIT_PREM/PRR_CARR_POL_PREM_AMT) ELSE null END))) AS "0",
                                TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM  "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"                where POL_FORM_CD is not null and COMP_QTE_IND_CNT = 1 AND PRR_CARR_POL_PREM_AMT >= 300 AND TERM_WRIT_PREM > 0 and DERIV_CHNNL_NM = 'Telephone' and BUS_UNIT_ABBR = 'AARP' GROUP BY Key)

order by Key