WITH prot_class AS -- CW Segmentation by Protection Class
(
	SELECT CONCAT('CW','Protection Class',(
	CASE WHEN PRTCT_CLASS_CD IN ('1','2','3','4') THEN 'A. 1-4'
		 WHEN PRTCT_CLASS_CD IN ('5') THEN 'B. 5'
		 WHEN PRTCT_CLASS_CD IN ('6') THEN 'C. 6'
		 WHEN PRTCT_CLASS_CD IN ('7') THEN 'D. 7'
		 WHEN PRTCT_CLASS_CD IN ('8','1W','1X','1Y','2W','2X','2Y','3W','3X','3Y','4W','4X','4Y','5W','5X','5Y','6W','6X','6Y','7W','7X','7Y','8W','8B','8X','8Y','9') THEN 'E. 8-9 and Split'
		 WHEN PRTCT_CLASS_CD IN ('10C','10','10W') THEN 'f. 10'
		 ELSE 'Unknown' END),BU_ABBR,'NewCo','Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

prot_class_form_cd AS -- CW Segmentation by Protection Class Form Code
(
	SELECT CONCAT('CW','Protection Class',(
	CASE WHEN PRTCT_CLASS_CD IN ('1','2','3','4') THEN 'A. 1-4'
		 WHEN PRTCT_CLASS_CD IN ('5') THEN 'B. 5'
		 WHEN PRTCT_CLASS_CD IN ('6') THEN 'C. 6'
		 WHEN PRTCT_CLASS_CD IN ('7') THEN 'D. 7'
		 WHEN PRTCT_CLASS_CD IN ('8','1W','1X','1Y','2W','2X','2Y','3W','3X','3Y','4W','4X','4Y','5W','5X','5Y','6W','6X','6Y','7W','7X','7Y','8W','8B','8X','8Y','9') THEN 'E. 8-9 and Split'
		 WHEN PRTCT_CLASS_CD IN ('10C','10','10W') THEN 'f. 10'
		 ELSE 'Unknown' END),BU_ABBR,'NewCo',(CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg' WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C' ELSE 'Other' END)) as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

acct_credit AS -- CW Segmentation by Account Credit
(
	SELECT CONCAT('CW', 'Account Credit', ACCT_CR_IND, BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	LEFT JOIN (SELECT PROP_QTE_TRANS_ID, ACCT_CR_IND FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_DWELL_LATST_VW")
	USING(PROP_QTE_TRANS_ID)
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

acct_credit_form_cd AS -- CW Segmentation by Account Credit Form Code
(
	SELECT CONCAT('CW', 'Account Credit', ACCT_CR_IND, BU_ABBR, 'NewCo',(
	CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
		 WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
		 ELSE 'Other' END)) as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	LEFT JOIN (SELECT PROP_QTE_TRANS_ID, ACCT_CR_IND FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_DWELL_LATST_VW")
	USING(PROP_QTE_TRANS_ID)
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

ins_scr_decile AS -- CW Segmentation by Insurance Score Decile
(
	SELECT CONCAT('CW','Insurance Score Decile',(
	CASE WHEN INS_SCR_CD BETWEEN 830 AND 899 THEN 'Decile 01'
		 WHEN INS_SCR_CD BETWEEN 804 AND 829 THEN 'Decile 02'
		 WHEN INS_SCR_CD BETWEEN 783 AND 803 THEN 'Decile 03'
		 WHEN INS_SCR_CD BETWEEN 762 AND 782 THEN 'Decile 04'
		 WHEN INS_SCR_CD BETWEEN 739 AND 761 THEN 'Decile 05'
		 WHEN INS_SCR_CD BETWEEN 708 AND 738 THEN 'Decile 06'
		 WHEN INS_SCR_CD BETWEEN 663 AND 707 THEN 'Decile 07'
		 WHEN INS_SCR_CD BETWEEN 591 AND 662 THEN 'Decile 08'
		 WHEN INS_SCR_CD BETWEEN 484 AND 590 THEN 'Decile 09'
		 WHEN INS_SCR_CD BETWEEN 100 AND 483 THEN 'Decile 10'
		 ELSE 'NH/NS' END), BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

ins_scr_decile_form_cd AS -- CW Segmentation by Insurance Score Decile Form Code
(
	SELECT CONCAT('CW','Insurance Score Decile',(
	CASE WHEN INS_SCR_CD BETWEEN 830 AND 899 THEN 'Decile 01'
		 WHEN INS_SCR_CD BETWEEN 804 AND 829 THEN 'Decile 02'
		 WHEN INS_SCR_CD BETWEEN 783 AND 803 THEN 'Decile 03'
		 WHEN INS_SCR_CD BETWEEN 762 AND 782 THEN 'Decile 04'
		 WHEN INS_SCR_CD BETWEEN 739 AND 761 THEN 'Decile 05'
		 WHEN INS_SCR_CD BETWEEN 708 AND 738 THEN 'Decile 06'
		 WHEN INS_SCR_CD BETWEEN 663 AND 707 THEN 'Decile 07'
		 WHEN INS_SCR_CD BETWEEN 591 AND 662 THEN 'Decile 08'
		 WHEN INS_SCR_CD BETWEEN 484 AND 590 THEN 'Decile 09'
		 WHEN INS_SCR_CD BETWEEN 100 AND 483 THEN 'Decile 10'
		 ELSE 'NH/NS' END), BU_ABBR, 'NewCo',(
		 CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
			  WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
			  ELSE 'Other' END)) as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

ins_age AS -- CW Segmentation by Insured Age Group
(
	SELECT CONCAT('CW','Insured Age Group',(
	CASE WHEN DATEDIFF(YEAR, ACCT_DOB, POL_EFF_DT) - 1 <= 49 THEN 'a. 25-49'
		 WHEN DATEDIFF(YEAR, ACCT_DOB, POL_EFF_DT) - 1 <= 54  THEN 'b. 50-54'
		 WHEN DATEDIFF(YEAR, ACCT_DOB, POL_EFF_DT) - 1 <= 59  THEN 'c. 55-59'
		 WHEN DATEDIFF(YEAR, ACCT_DOB, POL_EFF_DT) - 1 <= 64  THEN 'd. 60-64'
		 WHEN DATEDIFF(YEAR, ACCT_DOB, POL_EFF_DT) - 1 <= 69  THEN 'e. 65-69'
		 WHEN DATEDIFF(YEAR, ACCT_DOB, POL_EFF_DT) - 1 <= 74  THEN 'f. 70-74'
		 WHEN DATEDIFF(YEAR, ACCT_DOB, POL_EFF_DT) - 1 <= 79  THEN 'g. 75-79'
		 WHEN DATEDIFF(YEAR, ACCT_DOB, POL_EFF_DT) - 1 <= 120  THEN 'h. 80+'
		 ELSE 'i. null' END), BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

ins_age_form_cd AS -- CW Segmentation by Insured Age Group Form Code
(
	SELECT CONCAT('CW','Insured Age Group',(
	CASE WHEN DATEDIFF(YEAR, ACCT_DOB, POL_EFF_DT) - 1 <= 49 THEN 'a. 25-49'
		 WHEN DATEDIFF(YEAR, ACCT_DOB, POL_EFF_DT) - 1 <= 54  THEN 'b. 50-54'
		 WHEN DATEDIFF(YEAR, ACCT_DOB, POL_EFF_DT) - 1 <= 59  THEN 'c. 55-59'
		 WHEN DATEDIFF(YEAR, ACCT_DOB, POL_EFF_DT) - 1 <= 64  THEN 'd. 60-64'
		 WHEN DATEDIFF(YEAR, ACCT_DOB, POL_EFF_DT) - 1 <= 69  THEN 'e. 65-69'
		 WHEN DATEDIFF(YEAR, ACCT_DOB, POL_EFF_DT) - 1 <= 74  THEN 'f. 70-74'
		 WHEN DATEDIFF(YEAR, ACCT_DOB, POL_EFF_DT) - 1 <= 79  THEN 'g. 75-79'
		 WHEN DATEDIFF(YEAR, ACCT_DOB, POL_EFF_DT) - 1 <= 120  THEN 'h. 80+'
		 ELSE 'i. null' END), BU_ABBR,'NewCo',(
		 CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
			  WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
			  ELSE 'Other' END)) as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

hh_member AS -- CW Segmentation by Household Member Count
(
	SELECT CONCAT('CW','Household Member Count',(
	CASE WHEN HH_MEMB_CNT = 0 THEN 'other'
		 WHEN HH_MEMB_CNT = 1 THEN 'a. 1'
		 WHEN HH_MEMB_CNT = 2 THEN 'b. 2'
		 WHEN HH_MEMB_CNT = 3 THEN 'c. 3'
		 WHEN HH_MEMB_CNT > 3 and HH_MEMB_CNT <= 12 THEN 'd. 4+'
		 ELSE 'other' END), BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	LEFT JOIN (SELECT PROP_QTE_TRANS_ID, HH_MEMB_CNT FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_DWELL_LATST_VW")
	USING(PROP_QTE_TRANS_ID)
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

hh_member_form_cd AS -- CW Segmentation by Household Member Count Form Code
(
	SELECT CONCAT('CW','Household Member Count',(
	CASE WHEN HH_MEMB_CNT = 0 THEN 'other'
		 WHEN HH_MEMB_CNT = 1 THEN 'a. 1'
		 WHEN HH_MEMB_CNT = 2 THEN 'b. 2'
		 WHEN HH_MEMB_CNT = 3 THEN 'c. 3'
		 WHEN HH_MEMB_CNT > 3 and HH_MEMB_CNT <= 12 THEN 'd. 4+'
		 ELSE 'other' END), BU_ABBR, 'NewCo',(
		 CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
			  WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
			  ELSE 'Other' END)) as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	LEFT JOIN (SELECT PROP_QTE_TRANS_ID, HH_MEMB_CNT FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_DWELL_LATST_VW")
	USING(PROP_QTE_TRANS_ID)
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

aarp_member AS -- CW Segmentation by AARP Member Status
(
	SELECT CONCAT('CW','AARP Member',(
	CASE WHEN AARP_MEMB_STAT_DESC = 'Tenured Member' THEN 'Tenured Member'
		 ELSE 'New Member' END), BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

aarp_member_form_cd AS -- CW Segmentation by AARP Member Status Form Code
(
	SELECT CONCAT('CW','AARP Member',(
	CASE WHEN AARP_MEMB_STAT_DESC = 'Tenured Member' THEN 'Tenured Member'
		 ELSE 'New Member' END), BU_ABBR, 'NewCo',(
		 CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
			  WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
			  ELSE 'Other' END)) as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

aarp_member_years AS -- CW Segmentation by AARP Member Years
(
	SELECT CONCAT('CW','AARP Member Years',(
	CASE WHEN AARP_MEMB_DAY_CNT = '0' THEN 'A. 0 Days'
		 WHEN AARP_MEMB_DAY_CNT <= 364 THEN 'B. Less than 1 year'
		 WHEN AARP_MEMB_DAY_CNT <= 1824 THEN 'C. 1-4 years'
		 WHEN AARP_MEMB_DAY_CNT <= 3649 THEN 'D. 5-9 years'
		 WHEN AARP_MEMB_DAY_CNT <= 5474 THEN 'E. 10-14 years'
		 WHEN AARP_MEMB_DAY_CNT <= 7299 THEN 'F. 15-19 years'
		 WHEN AARP_MEMB_DAY_CNT <= 9124 THEN 'G. 20-24 years'
		 WHEN AARP_MEMB_DAY_CNT <= 10949 THEN 'H. 25-29 years'
		 WHEN AARP_MEMB_DAY_CNT <= 85000 THEN 'I. 30+ years'
		 ELSE 'A. 0 Days' END), BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

aarp_member_years_form_cd AS -- CW Segmentation by AARP Member Years Form Code
(
	SELECT CONCAT('CW','AARP Member Years',(
	CASE WHEN AARP_MEMB_DAY_CNT = '0' THEN 'A. 0 Days'
		 WHEN AARP_MEMB_DAY_CNT <= 364 THEN 'B. Less than 1 year'
		 WHEN AARP_MEMB_DAY_CNT <= 1824 THEN 'C. 1-4 years'
		 WHEN AARP_MEMB_DAY_CNT <= 3649 THEN 'D. 5-9 years'
		 WHEN AARP_MEMB_DAY_CNT <= 5474 THEN 'E. 10-14 years'
		 WHEN AARP_MEMB_DAY_CNT <= 7299 THEN 'F. 15-19 years'
		 WHEN AARP_MEMB_DAY_CNT <= 9124 THEN 'G. 20-24 years'
		 WHEN AARP_MEMB_DAY_CNT <= 10949 THEN 'H. 25-29 years'
		 WHEN AARP_MEMB_DAY_CNT <= 85000 THEN 'I. 30+ years'
		 ELSE 'A. 0 Days' END), BU_ABBR, 'NewCo',(
		 CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
			  WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
			  ELSE 'Other' END)) as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

auto_afa AS -- CW Segmentation by Auto AFA Count
(
	SELECT CONCAT('CW','Auto AFA Count',(
	CASE WHEN HOME_RATE_PCARR_POL_AFA_CNT = 0 THEN '0'
		 WHEN HOME_RATE_PCARR_POL_AFA_CNT = 1 THEN '1'
		 WHEN HOME_RATE_PCARR_POL_AFA_CNT = 2 THEN '2+'
		 WHEN HOME_RATE_PCARR_POL_AFA_CNT IS NULL THEN 'Unknown'
		 ELSE '2+' END),BU_ABBR,'NewCo','Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

auto_afa_form_cd AS -- CW Segmentation by Auto AFA Count Form Code
(
	SELECT CONCAT('CW','Auto AFA Count',(
	CASE WHEN HOME_RATE_PCARR_POL_AFA_CNT = 0 THEN '0'
		 WHEN HOME_RATE_PCARR_POL_AFA_CNT = 1 THEN '1'
		 WHEN HOME_RATE_PCARR_POL_AFA_CNT = 2 THEN '2+'
		 WHEN HOME_RATE_PCARR_POL_AFA_CNT IS NULL THEN 'Unknown'
		 ELSE '2+' END), BU_ABBR, 'NewCo',(
		 CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
			  WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
			  ELSE 'Other' END)) as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

auto_naf AS -- CW Segmentation by Auto NAF Count
(
	SELECT CONCAT('CW','Auto NAF Count',(
	CASE WHEN HOME_RATE_PCARR_POL_NAF_ACCID_CNT = 0 THEN '0'
		 WHEN HOME_RATE_PCARR_POL_NAF_ACCID_CNT = 1 THEN '1'
		 WHEN HOME_RATE_PCARR_POL_NAF_ACCID_CNT = 2 THEN '2+'
		 WHEN HOME_RATE_PCARR_POL_NAF_ACCID_CNT IS NULL THEN 'Unknown'
		 ELSE '2+' END),BU_ABBR,'NewCo','Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

auto_naf_form_cd AS -- CW Segmentation by Auto NAF Count Form Code
(
	SELECT CONCAT('CW','Auto NAF Count',(
	CASE WHEN HOME_RATE_PCARR_POL_NAF_ACCID_CNT = 0 THEN '0'
		 WHEN HOME_RATE_PCARR_POL_NAF_ACCID_CNT = 1 THEN '1'
		 WHEN HOME_RATE_PCARR_POL_NAF_ACCID_CNT = 2 THEN '2+'
		 WHEN HOME_RATE_PCARR_POL_NAF_ACCID_CNT IS NULL THEN 'Unknown'
		 ELSE '2+' END), BU_ABBR, 'NewCo',(
		 CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
			  WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
			  ELSE 'Other' END)) as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

mortgage_count AS -- CW Segmentation by Mortgage Count
(
	SELECT CONCAT('CW','Mortgage Count',(
	CASE WHEN MTGE_CNT = 0 THEN '0'
		 WHEN MTGE_CNT = 1 THEN '1'
		 WHEN MTGE_CNT = 2 THEN '2+'
		 WHEN MTGE_CNT IS NULL THEN 'Unknown'
		 ELSE '2+' END),BU_ABBR,'NewCo','Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

mortgage_count_form_cd AS -- CW Segmentation by Mortgage Count Form Code
(
	SELECT CONCAT('CW','Mortgage Count',(
	CASE WHEN MTGE_CNT = 0 THEN '0'
		 WHEN MTGE_CNT = 1 THEN '1'
		 WHEN MTGE_CNT = 2 THEN '2+'
		 WHEN MTGE_CNT IS NULL THEN 'Unknown'
		 ELSE '2+' END), BU_ABBR, 'NewCo',(
		 CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
			  WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
			  ELSE 'Other' END)) as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

prior_cat_claim AS -- CW Segmentation by Prior CAT Claim Count
(
	SELECT CONCAT('CW','Prior CAT Claim Count',(
	CASE WHEN PCARR_CAT_CLM_CNT = 0 THEN 'A. None'
		 WHEN PCARR_CAT_CLM_CNT = 1 THEN 'B. 1'
		 WHEN PCARR_CAT_CLM_CNT > 1 THEN 'C. 2+'
		 WHEN PCARR_CAT_CLM_CNT IS NULL THEN 'A. None'
		 ELSE 'Unknown' END), BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

prior_cat_claim_form_cd AS -- CW Segmentation by Prior CAT Claim Count Form Code
(
	SELECT CONCAT('CW','Prior CAT Claim Count',(
	CASE WHEN PCARR_CAT_CLM_CNT = 0 THEN 'A. None'
		 WHEN PCARR_CAT_CLM_CNT = 1 THEN 'B. 1'
		 WHEN PCARR_CAT_CLM_CNT > 1 THEN 'C. 2+'
		 WHEN PCARR_CAT_CLM_CNT IS NULL THEN 'A. None'
		 ELSE 'Unknown' END), BU_ABBR, 'NewCo',(
		 CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
			  WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
			  ELSE 'Other' END)) as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

prior_xcat_claim AS -- CW Segmentation by Prior xCAT Claim Count
(
	SELECT CONCAT('CW','Prior xCAT Claim Count',(
	CASE WHEN PCARR_XCAT_CLM_CNT = 0 THEN 'A. None'
		 WHEN PCARR_XCAT_CLM_CNT = 1 THEN 'B. 1'
		 WHEN PCARR_XCAT_CLM_CNT > 1 THEN 'C. 2+'
		 WHEN PCARR_XCAT_CLM_CNT IS NULL THEN 'A. None'
		 ELSE 'Unknown' END), BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

prior_xcat_claim_form_cd AS -- CW Segmentation by Prior xCAT Claim Count Form Code
(
	SELECT CONCAT('CW','Prior xCAT Claim Count',(
	CASE WHEN PCARR_XCAT_CLM_CNT = 0 THEN 'A. None'
		 WHEN PCARR_XCAT_CLM_CNT = 1 THEN 'B. 1'
		 WHEN PCARR_XCAT_CLM_CNT > 1 THEN 'C. 2+'
		 WHEN PCARR_XCAT_CLM_CNT IS NULL THEN 'A. None'
		 ELSE 'Unknown' END), BU_ABBR, 'NewCo',(
		 CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
			  WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
			  ELSE 'Other' END)) as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

deduc AS -- CW Segmentation by Deductible
(
	SELECT CONCAT('CW','Deductible',(
	CASE WHEN COV_DEDUC_AMT_TYP_DESC = 'FLAT' AND COV_FLAT_DEDUC_AMT IN ('500','750') THEN 'a. Less than 1000'
		 WHEN COV_DEDUC_AMT_TYP_DESC = 'FLAT' AND COV_FLAT_DEDUC_AMT IN ('1000','1500') THEN 'b. 1000-1500'
		 WHEN COV_DEDUC_AMT_TYP_DESC = 'FLAT' AND COV_FLAT_DEDUC_AMT IN ('2000','2500') THEN 'c. 2000-2500'
		 WHEN COV_DEDUC_AMT_TYP_DESC = 'FLAT' AND COV_FLAT_DEDUC_AMT IN ('3000','4000','5000','7500','10000') THEN 'd. 3000+'
		 WHEN COV_DEDUC_AMT_TYP_DESC = 'PERCENT' AND COV_PCT_DEDUC_CD = (1) THEN 'e. 0.5%'
		 WHEN COV_DEDUC_AMT_TYP_DESC = 'PERCENT' and COV_PCT_DEDUC_CD in(2,3,4,5,6,7,8) THEN 'f. 1.0 or more%'
		 ELSE 'f. Other' END), BU_ABBR, 'NewCo','Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

deduc_form_cd AS -- CW Segmentation by Deductible Form Code
(
	SELECT CONCAT('CW','Deductible',(
	CASE WHEN COV_DEDUC_AMT_TYP_DESC = 'FLAT' AND COV_FLAT_DEDUC_AMT IN ('500','750') THEN 'a. Less than 1000'
		 WHEN COV_DEDUC_AMT_TYP_DESC = 'FLAT' AND COV_FLAT_DEDUC_AMT IN ('1000','1500') THEN 'b. 1000-1500'
		 WHEN COV_DEDUC_AMT_TYP_DESC = 'FLAT' AND COV_FLAT_DEDUC_AMT IN ('2000','2500') THEN 'c. 2000-2500'
		 WHEN COV_DEDUC_AMT_TYP_DESC = 'FLAT' AND COV_FLAT_DEDUC_AMT IN ('3000','4000','5000','7500','10000') THEN 'd. 3000+'
		 WHEN COV_DEDUC_AMT_TYP_DESC = 'PERCENT' AND COV_PCT_DEDUC_CD = (1) THEN 'e. 0.5%'
		 WHEN COV_DEDUC_AMT_TYP_DESC = 'PERCENT' and COV_PCT_DEDUC_CD IN (2,3,4,5,6,7,8) THEN 'f. 1.0 or more%'
		 ELSE 'f. Other' END), BU_ABBR, 'NewCo',(
		 CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
			  WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
			  ELSE 'Other' END)) as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

wind_deduc AS -- CW Segmentation by Wind Deductible
(
	SELECT CONCAT('CW','Wind Deductible',(
	CASE WHEN COV_DEDUC_AMT_TYP_DESC = 'PERCENT' AND COV_PCT_DEDUC_CD = (1) THEN '0.5% All Peril'
	WHEN COV_DEDUC_AMT_TYP_DESC = 'PERCENT' AND COV_PCT_DEDUC_CD IN (2,3,4,5,6,7,8) THEN '1.0%+ All Peril'
		 WHEN WND_HAIL_DEDUC_AMT = '0.01' THEN '1% Wind Hail'
		 WHEN WND_HAIL_DEDUC_AMT = '0.02' THEN '2% Wind Hail'
		 WHEN WND_HAIL_DEDUC_AMT = '0.05' THEN '5% Wind Hail'
		 WHEN WND_HAIL_DEDUC_AMT = '1500' THEN 'Other Wind Hail'
		 WHEN HURR_COV_DEDUC_CD = '1' THEN '1% Hurriance'
		 WHEN HURR_COV_DEDUC_CD = '2' THEN '2% Hurricane'
		 WHEN HURR_COV_DEDUC_CD = '5' THEN '5% Hurricane'
		 WHEN WND_HAIL_DEDUC_AMT IS NULL THEN 'None'
		 WHEN WND_HAIL_DEDUC_AMT = 'NA' THEN 'None'
		 ELSE 'Other' END), BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

opt_cov_pkg AS -- CW Segmentation by Optional Coverage Package
(
	SELECT CONCAT('CW','Optional Coverage Package',(
	CASE WHEN OPT_COV_PKG_CD = 'P1B001' THEN 'P1'
		 WHEN OPT_COV_PKG_CD = 'P2B001' THEN 'P2'
		 WHEN OPT_COV_PKG_CD = 'P3B001' THEN 'P3'
		 WHEN OPT_COV_PKG_CD = 'P1C001' THEN 'P1'
		 WHEN OPT_COV_PKG_CD = 'P1T001' THEN 'P1'
		 ELSE 'None' END), BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

opt_cov_pkg_form_cd AS -- CW Segmentation by Optional Coverage Package Form Code
(
	SELECT CONCAT('CW','Optional Coverage Package',(
	CASE WHEN OPT_COV_PKG_CD = 'P1B001' THEN 'P1'
		 WHEN OPT_COV_PKG_CD = 'P2B001' THEN 'P2'
		 WHEN OPT_COV_PKG_CD = 'P3B001' THEN 'P3'
		 WHEN OPT_COV_PKG_CD = 'P1C001' THEN 'P1'
		 WHEN OPT_COV_PKG_CD = 'P1T001' THEN 'P1'
		 ELSE 'None' END), BU_ABBR, 'NewCo',(
		 CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
			  WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
			  ELSE 'Other' END)) as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

cov_a AS -- CW Segmentation by Coverage A
(
	SELECT CONCAT('CW','Coverage A',(
	CASE WHEN COA < 150000 THEN 'A. <150k'
		 WHEN COA < 300000 THEN 'B. 150-299k'
		 WHEN COA < 375000 THEN 'C 300-374'
		 WHEN COA < 450000 THEN 'D. 375-449k'
		 WHEN COA < 650000 THEN 'E. 450-649k'
		 WHEN COA < 1000000 THEN 'F. 650-1m'
		 WHEN COA < 12000000 THEN 'G. 1m+'
		 ELSE 'Unknown' END), BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	LEFT JOIN (SELECT PROP_QTE_TRANS_ID, COA from "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_PROP_QUOTE_COV_VW")
	USING(PROP_QTE_TRANS_ID)
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

sq_ft AS -- CW Segmentation by Square Foot Group
(
	SELECT CONCAT('CW','Square Foot Group',(
	CASE WHEN DWELL_TTL_AREA_SQFT_CNT BETWEEN 1 AND 1200 THEN 'a. 1-1200'
		 WHEN DWELL_TTL_AREA_SQFT_CNT BETWEEN 1201 AND 1500 THEN 'b. 1201-1500'
		 WHEN DWELL_TTL_AREA_SQFT_CNT BETWEEN 1501 AND 2000 THEN 'c. 1501-2000'
		 WHEN DWELL_TTL_AREA_SQFT_CNT BETWEEN 2001 AND 2500 THEN 'd. 2001-2500'
		 WHEN DWELL_TTL_AREA_SQFT_CNT BETWEEN 2501 AND 3000 THEN 'e. 2501-3000'
		 WHEN DWELL_TTL_AREA_SQFT_CNT BETWEEN 3001 AND 9999 THEN 'f. 3001+'
		 ELSE 'Unknown' END), BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	LEFT JOIN (SELECT PROP_QTE_TRANS_ID, DWELL_TTL_AREA_SQFT_CNT FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_DWELL_LATST_VW")
	USING(PROP_QTE_TRANS_ID)
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

cov_a_sq_ft AS -- CW Segmentation by Cov A Per SqFt
(
	SELECT CONCAT('CW','Cov A Per SqFt',(
	CASE WHEN ROUND(DIV0NULL(COA, DWELL_TTL_AREA_SQFT_CNT),0) BETWEEN 0 AND 169  THEN 'a. Less than 170'
		 WHEN ROUND(DIV0NULL(COA, DWELL_TTL_AREA_SQFT_CNT),0) BETWEEN 170 AND 189 THEN 'b. 170-189'
		 WHEN ROUND(DIV0NULL(COA, DWELL_TTL_AREA_SQFT_CNT),0) BETWEEN 190 AND 209 THEN 'c. 190-209'
		 WHEN ROUND(DIV0NULL(COA, DWELL_TTL_AREA_SQFT_CNT),0) BETWEEN 210 AND 239 THEN 'd. 210-239'
		 WHEN ROUND(DIV0NULL(COA, DWELL_TTL_AREA_SQFT_CNT),0) >= 240 THEN 'e. 240+'
		 ELSE 'Unknown' END), BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW" t1
	LEFT JOIN (SELECT PROP_QTE_TRANS_ID, COA FROM "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_PROP_QUOTE_COV_VW") t2
	ON t1.PROP_QTE_TRANS_ID = t2.PROP_QTE_TRANS_ID
	LEFT JOIN (SELECT PROP_QTE_TRANS_ID, DWELL_TTL_AREA_SQFT_CNT FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_DWELL_LATST_VW") t3
	ON t1.PROP_QTE_TRANS_ID = t3.PROP_QTE_TRANS_ID
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

dwell_age AS -- CW Segmentation by Dwelling Age Group
(
	SELECT CONCAT('CW','Dwelling Age Group',(
	CASE WHEN DWELL_AGE <= 5 THEN 'A. 0-5'
		 WHEN DWELL_AGE <= 10 THEN 'B. 6-10'
		 WHEN DWELL_AGE <= 20 THEN 'C 11-20'
		 WHEN DWELL_AGE <= 30 THEN 'D. 21-30'
		 WHEN DWELL_AGE <= 40 THEN 'E. 31-40'
		 WHEN DWELL_AGE <= 50 THEN 'F. 41-50'
		 WHEN DWELL_AGE <= 60 THEN 'G. 51-60'
		 WHEN DWELL_AGE <= 70 THEN 'H. 61-70'
		 WHEN DWELL_AGE <= 200 THEN 'I. 71+'
		 ELSE 'Unknown' END), BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	LEFT JOIN (SELECT PROP_QTE_TRANS_ID, DWELL_AGE FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_DWELL_LATST_VW")
	USING(PROP_QTE_TRANS_ID)
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

roof_age AS -- CW Segmentation by Roof Age
(
	SELECT CONCAT('CW','Roof Age Group',(
	CASE WHEN PROP_ROOF_AGE <= 5 THEN 'A. 0-5'
		 WHEN PROP_ROOF_AGE <= 10 THEN 'B. 6-10'
		 WHEN PROP_ROOF_AGE <= 20 THEN 'C 11-20'
		 WHEN PROP_ROOF_AGE <= 200 THEN 'D. 21+'
		 ELSE 'Unknown' END 
        ),BU_ABBR,'NewCo','Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	LEFT JOIN (SELECT PROP_QTE_TRANS_ID, PROP_ROOF_AGE FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_DWELL_LATST_VW")
	USING(PROP_QTE_TRANS_ID)
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

roof_sqft AS -- CW Segmentation by Roof SqFt Size
(
	SELECT CONCAT('CW','Roof SqFt Size',(
	CASE WHEN AERIAL_ROOF_SQFT_CNT IS NULL THEN 'G. Unknown'
		 WHEN AERIAL_ROOF_SQFT_CNT < 1300 THEN 'A. Less than 1300'
		 WHEN AERIAL_ROOF_SQFT_CNT < 2000 THEN 'B. 1300-1999'
		 WHEN AERIAL_ROOF_SQFT_CNT < 2500 THEN 'C. 2000-2499'
		 WHEN AERIAL_ROOF_SQFT_CNT < 3000 THEN 'D. 2500-2999'
		 WHEN AERIAL_ROOF_SQFT_CNT < 4000 THEN 'E. 3000-3999'
		 WHEN AERIAL_ROOF_SQFT_CNT < 300000 THEN 'F. 4000+'
		 ELSE 'G. Unknown' END),BU_ABBR,'NewCo','Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	LEFT JOIN (SELECT PROP_QTE_TRANS_ID, AERIAL_ROOF_SQFT_CNT FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_DWELL_LATST_VW")
	USING(PROP_QTE_TRANS_ID)
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

hail_roof AS -- CW Segmentation by Hail Roof Symbol Code
(
	SELECT CONCAT('CW','Hail Roof Symbol Group',(
	CASE WHEN HAIL_PERIL_ROOF_SYM_CD = 'R0' THEN 'a. R0'
		 WHEN HAIL_PERIL_ROOF_SYM_CD IN ('R1', 'R2', 'R3', 'R4', 'R5', 'R6', 'R7', 'R8', 'R9', 'R10') THEN 'b. R1-R10'
		 WHEN HAIL_PERIL_ROOF_SYM_CD IN ('R11', 'R12', 'R13', 'R14', 'R15', 'R16', 'R17', 'R18', 'R19', 'R20','R21', 'R22', 'R23', 'R24', 'R25') THEN 'c. R11-R25'
		 WHEN HAIL_PERIL_ROOF_SYM_CD IN ('R26', 'R27', 'R28', 'R29', 'R30', 'R31', 'R32', 'R33', 'R34', 'R35','R36', 'R37', 'R38', 'R39', 'R40') THEN 'd. R26-R40'
		 WHEN HAIL_PERIL_ROOF_SYM_CD IN ('R41', 'R42', 'R43', 'R44', 'R45', 'R46', 'R47', 'R48', 'R49', 'R50','R51', 'R52', 'R53', 'R54', 'R55','R56', 'R57', 'R58', 'R59') THEN 'e. R41-R59'
		 WHEN HAIL_PERIL_ROOF_SYM_CD IN ('R60', 'R61', 'R62', 'R63', 'R64', 'R65', 'R66', 'R67', 'R68', 'R69','R70', 'R71', 'R72', 'R73', 'R74', 'R75','R76', 'R77', 'R78', 'R79','R80', 'R81', 'R82', 'R83', 'R84', 'R85', 'R86', 'R87', 'R88', 'R89','R90','R91', 'R92', 'R93', 'R94', 'R95','R96', 'R97', 'R98', 'R99') THEN 'f. R60-R99'
		 ELSE 'g. null' END), BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

roof_cond AS -- CW Segmentation by Roof Condition Score
(
	SELECT CONCAT('CW', 'Roof Condition Score', roof_cond_deriv_scr_num, BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	LEFT JOIN (SELECT PROP_QTE_TRANS_ID, roof_cond_deriv_scr_num FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_DWELL_LATST_VW")
	USING(PROP_QTE_TRANS_ID)
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

roof_shape AS -- CW Segmentation by Roof Shape
(
	SELECT CONCAT('CW','Roof Shape',( 
    CASE WHEN DERIV_ROOF_SHAPE_DESC = 'gable' THEN 'a. Gable'
		 WHEN DERIV_ROOF_SHAPE_DESC = 'hip' THEN 'b. Hip'
		 WHEN DERIV_ROOF_SHAPE_DESC = 'mixed' THEN 'c. Mixed'
		 WHEN DERIV_ROOF_SHAPE_DESC = 'flat' THEN 'd. Flat'
		 WHEN DERIV_ROOF_SHAPE_DESC IS NULL THEN 'f. Blank'
		 ELSE 'e. Other' END), BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	LEFT JOIN (SELECT PROP_QTE_TRANS_ID, DERIV_ROOF_SHAPE_DESC FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_DWELL_LATST_VW")
	USING(PROP_QTE_TRANS_ID)
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

build_fax_conf AS -- CW Segmentation by Build Fax Roof Age Confidence
(
	SELECT CONCAT('CW','Build Fax Roof Age Confidence',( 
    CASE WHEN BLD_FAX_ROOF_AGE_CONFID_DESC IN ( 'High','9') THEN 'a. High/9'
		 WHEN BLD_FAX_ROOF_AGE_CONFID_DESC IN ('Medium','8') THEN 'b. Medium/8'
		 WHEN BLD_FAX_ROOF_AGE_CONFID_DESC IN ('Low','7') THEN 'c. Low/7'
		 WHEN BLD_FAX_ROOF_AGE_CONFID_DESC IN ('Modeled','5') THEN 'd. Modeled/5'
		 WHEN BLD_FAX_ROOF_AGE_CONFID_DESC IS NULL THEN 'e. Other/Unknown'
		 ELSE 'e. Other/Unknown' END), BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	LEFT JOIN (SELECT PROP_QTE_TRANS_ID, BLD_FAX_ROOF_AGE_CONFID_DESC FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_DWELL_LATST_VW")
	USING(PROP_QTE_TRANS_ID)
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

tree_overhang AS -- CW Segmentation by Tree Overhang
(
	SELECT CONCAT('CW','Tree Overhang',( 
    CASE WHEN ROOF_TREE_CANPY_STAT_DESC = 'tree_overhang_major' THEN 'a. Major'
		 WHEN ROOF_TREE_CANPY_STAT_DESC = 'tree_overhang_moderate' THEN 'b. Moderate'
		 WHEN ROOF_TREE_CANPY_STAT_DESC = 'tree_overhang_minor' THEN 'c. Minor'
		 WHEN ROOF_TREE_CANPY_STAT_DESC = 'no_tree_overhang' THEN 'd. No Overhang'
		 WHEN ROOF_TREE_CANPY_STAT_DESC = 'not_available' THEN 'e. Unkn/NotAvail/Blank'
		 WHEN ROOF_TREE_CANPY_STAT_DESC = 'unknown' THEN 'e. Unkn/NotAvail/Blank'
		 WHEN ROOF_TREE_CANPY_STAT_DESC is null THEN 'e. Unkn/NotAvail/Blank'
		 ELSE 'e. Unkn/NotAvail/Blank' END), BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	LEFT JOIN (SELECT PROP_QTE_TRANS_ID, ROOF_TREE_CANPY_STAT_DESC FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_DWELL_LATST_VW")
	USING(PROP_QTE_TRANS_ID)
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

cape_cov AS -- CW Segmentation by Cape Coverage
(
	SELECT CONCAT('CW','Cape Coverage',(
	CASE WHEN CAPE_ANAL_SRVC_ERR_MSG_DESC = 'API request was successful' THEN 'a. Cape Hit'
		 WHEN LEFT(CAPE_ANAL_SRVC_ERR_MSG_DESC,35) = 'The input location is outside of Ca' THEN 'b. Outside of Cape Coverage'
		 WHEN CAPE_ANAL_SRVC_ERR_MSG_DESC IS NULL THEN 'd. Blank'
		 ELSE 'c. Other' END), BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

const_mat AS -- CW Segmentation by Construction Material
(
	SELECT CONCAT('CW','Construction Material',(
	CASE WHEN Dwell_Rate_Constr_Typ_Desc IN ('Frame','Masonry','MasonryVeneer') THEN Dwell_Rate_Constr_Typ_Desc
		 ELSE 'Superior/Other/Unknown' END), BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	LEFT JOIN (SELECT PROP_QTE_TRANS_ID, Dwell_Rate_Constr_Typ_Desc FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_DWELL_LATST_VW")
	USING(PROP_QTE_TRANS_ID)
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

story_cnt AS -- CW Segmentation by Story Count
(
	SELECT CONCAT('CW','Story Count',(
	CASE WHEN DWELL_STRY_CNT_CD = '1' THEN 'a. 1'
		 WHEN DWELL_STRY_CNT_CD = '1.5' THEN 'b. 1.5'
		 WHEN DWELL_STRY_CNT_CD = '2' THEN 'c. 2'
		 WHEN DWELL_STRY_CNT_CD IN ('2','2.5','3','3.5','4','4.5','5') THEN 'd. 2.5+'
		 WHEN DWELL_STRY_CNT_CD IN ('BI','SPLIT') THEN 'E. BI/SPLIT'
		 WHEN DWELL_STRY_CNT_CD is null THEN 'f. Other/Unknown'
		 ELSE 'f. Other/Unknown' END), BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	LEFT JOIN (SELECT PROP_QTE_TRANS_ID, DWELL_STRY_CNT_CD FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_DWELL_LATST_VW")
	USING(PROP_QTE_TRANS_ID)
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

fire_alarm AS -- CW Segmentation by Fire Alarm
(
	SELECT CONCAT('CW','Fire Alarm',(
	CASE WHEN FIRE_ALARM_DESC = 'Monitored' THEN 'a. Monitored'
		 WHEN FIRE_ALARM_DESC = 'NonMonitored' THEN 'b. Non-Monitored'
		 WHEN FIRE_ALARM_DESC = 'None' THEN 'c. None'
		 WHEN FIRE_ALARM_DESC IS NULL THEN 'd. Blank'
		 ELSE 'e. Other' END), BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	LEFT JOIN (SELECT PROP_QTE_TRANS_ID, FIRE_ALARM_DESC FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_DWELL_LATST_VW")
	USING(PROP_QTE_TRANS_ID)
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

fire_alarm_form_cd AS -- CW Segmentation by Fire Alarm Form Code
(
	SELECT CONCAT('CW','Fire Alarm',(
	CASE WHEN FIRE_ALARM_DESC = 'Monitored' THEN 'a. Monitored'
		 WHEN FIRE_ALARM_DESC = 'NonMonitored' THEN 'b. Non-Monitored'
		 WHEN FIRE_ALARM_DESC = 'None' THEN 'c. None'
		 WHEN FIRE_ALARM_DESC IS NULL THEN 'd. Blank'
		 ELSE 'e. Other' END),BU_ABBR,'NewCo',(
		 CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
			  WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
			  ELSE 'Other' END)) as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	LEFT JOIN (SELECT PROP_QTE_TRANS_ID, FIRE_ALARM_DESC FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_DWELL_LATST_VW")
	USING(PROP_QTE_TRANS_ID)
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

dist_to_coast AS -- CW Segmentation by Distance to Coast
(
	SELECT CONCAT('CW','Distance to Coast',(
	CASE WHEN RISK_ST_ABBR IN ('AK','AR','IA','ID','IL','MN','MO','IN','KS','KY','NM','OH','OK','UT','WI','WV','VT','SD','TN','WY','ND','NE','OR','PA','MI','AZ','CO','MT') THEN 'A. Non DTC State'
		 WHEN RATE_DSTNC_TO_COAST_FT_CNT <= 2000 THEN 'b. 0-2000'
		 WHEN RATE_DSTNC_TO_COAST_FT_CNT > 2000 and RATE_DSTNC_TO_COAST_FT_CNT <= 5280 THEN 'c. 2001-5280'
		 WHEN RATE_DSTNC_TO_COAST_FT_CNT > 5280 and RATE_DSTNC_TO_COAST_FT_CNT <= 26399 THEN 'd. 1-4 miles'
		 WHEN RATE_DSTNC_TO_COAST_FT_CNT > 26400 and RATE_DSTNC_TO_COAST_FT_CNT <= 52799 THEN 'e. 5-9 miles'
		 WHEN RATE_DSTNC_TO_COAST_FT_CNT > 52800 and RATE_DSTNC_TO_COAST_FT_CNT <= 105599 THEN 'f. 10-19 miles'
		 WHEN RATE_DSTNC_TO_COAST_FT_CNT > 105600 and RATE_DSTNC_TO_COAST_FT_CNT <= 263999 THEN 'g. 20-49 miles'
		 WHEN RATE_DSTNC_TO_COAST_FT_CNT > 264000 and RATE_DSTNC_TO_COAST_FT_CNT <= 395999 THEN 'h. 50-74 miles'
		 WHEN RATE_DSTNC_TO_COAST_FT_CNT > 396000 and RATE_DSTNC_TO_COAST_FT_CNT <= 527999 THEN 'i. 75-99 miles'
		 WHEN RATE_DSTNC_TO_COAST_FT_CNT > 528000 and RATE_DSTNC_TO_COAST_FT_CNT <= 791999 THEN 'j. 100-149 miles'
		 WHEN RATE_DSTNC_TO_COAST_FT_CNT > 792000 and RATE_DSTNC_TO_COAST_FT_CNT <= 9999998 THEN 'k. 150+ miles' 
		 WHEN RATE_DSTNC_TO_COAST_FT_CNT = 9999999 THEN 'l 9999999 feet'
		 ELSE 'other' END), BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	LEFT JOIN (SELECT PROP_QTE_TRANS_ID, RATE_DSTNC_TO_COAST_FT_CNT FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_DWELL_LATST_VW")
	USING(PROP_QTE_TRANS_ID)
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

fireline_score AS -- CW Segmentation by Fireline Score
(
	SELECT CONCAT('CW','Fireline Score',(
	CASE WHEN FIRELN_WLDFR_RISK_SCR_NUM = 0 THEN '0'
		 WHEN FIRELN_WLDFR_RISK_SCR_NUM = 1 THEN '1'
		 WHEN FIRELN_WLDFR_RISK_SCR_NUM = 2 THEN '2'
		 WHEN FIRELN_WLDFR_RISK_SCR_NUM = 3 THEN '3'
		 WHEN FIRELN_WLDFR_RISK_SCR_NUM = 4 THEN '4'
		 WHEN FIRELN_WLDFR_RISK_SCR_NUM = 5 THEN '5'
		 WHEN FIRELN_WLDFR_RISK_SCR_NUM = 6 THEN '6'
		 WHEN FIRELN_WLDFR_RISK_SCR_NUM >= 7 THEN '7+'
		 WHEN FIRELN_WLDFR_RISK_SCR_NUM IS NULL THEN 'N/A'
		 ELSE 'other' END), BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	LEFT JOIN (SELECT PROP_QTE_TRANS_ID, FIRELN_WLDFR_RISK_SCR_NUM FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_DWELL_LATST_VW")
	USING(PROP_QTE_TRANS_ID)
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

hazard_hub AS -- CW Segmentation by Hazard Hub Score
(
	SELECT CONCAT('CW','HazardHub',(
	CASE WHEN HAZ_HUB_WLDFR_SCR_NUM < 18 THEN 'A. 0-17'
		 WHEN HAZ_HUB_WLDFR_SCR_NUM < 21 THEN 'B. 18-20'
		 WHEN HAZ_HUB_WLDFR_SCR_NUM < 27 THEN 'C. 21-26'
		 WHEN HAZ_HUB_WLDFR_SCR_NUM < 34 THEN 'D. 27-33'
		 WHEN HAZ_HUB_WLDFR_SCR_NUM < 98 THEN 'E. 34-97'
		 WHEN HAZ_HUB_WLDFR_SCR_NUM IN ('98','99') THEN 'F. NH/NS'
		 ELSE 'other' END), BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	LEFT JOIN (SELECT PROP_QTE_TRANS_ID, HAZ_HUB_WLDFR_SCR_NUM FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_DWELL_LATST_VW")
	USING(PROP_QTE_TRANS_ID)
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

limited_access AS -- CW Segmentation by Limited Access
(
	SELECT CONCAT('CW', 'Limited Access', LTD_ACCSS_CR_IND, BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	LEFT JOIN (SELECT PROP_QTE_TRANS_ID, LTD_ACCSS_CR_IND FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_DWELL_LATST_VW")
	USING(PROP_QTE_TRANS_ID)
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

dwell_substate AS -- CW Segmentation by Dwelling Substate
(
	SELECT CONCAT('CW','Dwelling Substate',(
	CASE WHEN RISK_ST_ABBR = 'IA' AND GARAGE_SUBSTATE IN ('Cedar Rapids/Iowa City metro', 'Central Iowa', 'Des Moines/Ames Metro', 'East Iowa', 'West Iowa/KS border') THEN GARAGE_SUBSTATE
		 WHEN RISK_ST_ABBR <> 'IA' AND LEFT(RISK_ST_ABBR, 2) = LEFT(GARAGE_SUBSTATE,2) THEN GARAGE_SUBSTATE
		 ELSE 'Out of State Mail' END), BU_ABBR, 'NewCo', 'Total') as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	LEFT JOIN (SELECT PROP_QTE_TRANS_ID, DWELL_LOC_ADDR_FULL_ZIP_CD FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_DWELL_LATST_VW")
	USING(PROP_QTE_TRANS_ID)
	LEFT JOIN (SELECT ZIP_CODE, STATE_ABBR, GARAGE_SUBSTATE FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."STATE_PRODUCT_SUBSTATE") t2
	ON t2.ZIP_CODE = LEFT(DWELL_LOC_ADDR_FULL_ZIP_CD, 5)
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
),

dwell_substate_form_cd AS -- CW Segmentation by Dwelling Substate Form Code
(
	SELECT CONCAT('CW','Dwelling Substate',(
	CASE WHEN RISK_ST_ABBR = 'IA' AND GARAGE_SUBSTATE IN ('Cedar Rapids/Iowa City metro', 'Central Iowa', 'Des Moines/Ames Metro', 'East Iowa', 'West Iowa/KS border') THEN GARAGE_SUBSTATE
		 WHEN RISK_ST_ABBR <> 'IA' AND LEFT(RISK_ST_ABBR, 2) = LEFT(GARAGE_SUBSTATE,2) THEN GARAGE_SUBSTATE
		 ELSE 'Out of State Mail' END), BU_ABBR, 'NewCo', (
		 CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
			  WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
			  ELSE 'Other' END)) as Key,
	-- Response
	one_cond_scorecard(12, TRANS_DT, RESP_IND_CNT, 1, 1) AS "12 Response",
	one_cond_scorecard(11, TRANS_DT, RESP_IND_CNT, 1, 1) AS "11 Response",
	one_cond_scorecard(10, TRANS_DT, RESP_IND_CNT, 1, 1) AS "10 Response",
	one_cond_scorecard(9, TRANS_DT, RESP_IND_CNT, 1, 1) AS "09 Response",
	one_cond_scorecard(8, TRANS_DT, RESP_IND_CNT, 1, 1) AS "08 Response",
	one_cond_scorecard(7, TRANS_DT, RESP_IND_CNT, 1, 1) AS "07 Response",
	one_cond_scorecard(6, TRANS_DT, RESP_IND_CNT, 1, 1) AS "06 Response",
	one_cond_scorecard(5, TRANS_DT, RESP_IND_CNT, 1, 1) AS "05 Response",
	one_cond_scorecard(4, TRANS_DT, RESP_IND_CNT, 1, 1) AS "04 Response",
	one_cond_scorecard(3, TRANS_DT, RESP_IND_CNT, 1, 1) AS "03 Response",
	one_cond_scorecard(2, TRANS_DT, RESP_IND_CNT, 1, 1) AS "02 Response",
	one_cond_scorecard(1, TRANS_DT, RESP_IND_CNT, 1, 1) AS "01 Response",
	one_cond_scorecard(0, TRANS_DT, RESP_IND_CNT, 1, 1) AS "00 Response",
	-- PBR
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "12 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "11 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "10 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "09 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "08 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "07 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "06 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "05 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "04 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "03 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "02 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "01 PBR",
	SUM(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN COMPL_QTE_IND_CNT
			 WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 THEN 1 ELSE 0 END) AS "00 PBR",
	-- Issues
	one_cond_scorecard(12, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "12 Issued",
	one_cond_scorecard(11, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "11 Issued",
	one_cond_scorecard(10, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "10 Issued",
	one_cond_scorecard(9, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "9 Issued",
	one_cond_scorecard(8, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "8 Issued",
	one_cond_scorecard(7, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "7 Issued",
	one_cond_scorecard(6, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "6 Issued",
	one_cond_scorecard(5, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "5 Issued",
	one_cond_scorecard(4, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "4 Issued",
	one_cond_scorecard(3, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "3 Issued",
	one_cond_scorecard(2, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "2 Issued",
	one_cond_scorecard(1, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "1 Issued",
	one_cond_scorecard(0, TRANS_DT, ISSUE_IND_CNT, 1, 1) AS "0 Issued",
	-- AQP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "12 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "11 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "10 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "9 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "8 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "7 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "6 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "5 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "4 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "3 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "2 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "1 AQP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND COMPL_QTE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / COMPL_QTE_IND_CNT ELSE NULL END)) AS "0 AQP",
	-- AIP
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "12 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "11 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "10 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "9 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "8 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "7 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "6 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "5 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "4 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "3 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "2 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "1 AIP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND ISSUE_IND_CNT = 1 THEN POL_TTL_BILL_PREM_AMT / ISSUE_IND_CNT ELSE NULL END)) AS "0 AIP",
	-- HIGSRP 
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 12 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "12 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 11 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "11 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 10 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "10 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 9 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "09 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 8 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "08 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 7 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "07 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 6 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "06 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 5 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "05 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 4 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "04 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 3 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "03 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 2 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "02 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 1 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "01 Phone HIGSRP",
	NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH, TRANS_DT, SYSDATE()) = 0 AND QQ_IND_CNT = 1 AND PCARR_POL_TERM_TTL_PREM_AMT >= 300 AND POL_TTL_BILL_PREM_AMT > 0
						AND ORIG_QTE_CNTCT_METH_CD = 'P' THEN QQ_ANNL_POL_PREM_AMT / PCARR_POL_TERM_TTL_PREM_AMT ELSE NULL END)) as "00 Phone HIGSRP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_LATST_VW"
	LEFT JOIN (SELECT PROP_QTE_TRANS_ID, DWELL_LOC_ADDR_FULL_ZIP_CD FROM "PRD_PL_DB"."APP_DCPA_DM"."PROP_QUOTE_DWELL_LATST_VW")
	USING(PROP_QTE_TRANS_ID)
	LEFT JOIN (SELECT ZIP_CODE, STATE_ABBR, GARAGE_SUBSTATE FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."STATE_PRODUCT_SUBSTATE") t2
	ON t2.ZIP_CODE = LEFT(DWELL_LOC_ADDR_FULL_ZIP_CD, 5)
	WHERE POL_FORM_CD IS NOT NULL
	GROUP BY Key
)

SELECT * FROM
(
	SELECT * FROM prot_class
	UNION ALL
	SELECT * FROM prot_class_form_cd
	UNION ALL
	SELECT * FROM acct_credit
	UNION ALL
	SELECT * FROM acct_credit_form_cd
	UNION ALL
	SELECT * FROM ins_scr_decile
	UNION ALL
	SELECT * FROM ins_scr_decile_form_cd
	UNION ALL
	SELECT * FROM ins_age
	UNION ALL
	SELECT * FROM ins_age_form_cd
	UNION ALL
	SELECT * FROM hh_member
	UNION ALL
	SELECT * FROM hh_member_form_cd
	UNION ALL
	SELECT * FROM aarp_member
	UNION ALL
	SELECT * FROM aarp_member_form_cd
	UNION ALL
	SELECT * FROM aarp_member_years
	UNION ALL
	SELECT * FROM aarp_member_years_form_cd
	UNION ALL
	SELECT * FROM auto_afa
	UNION ALL
	SELECT * FROM auto_afa_form_cd
	UNION ALL
	SELECT * FROM auto_naf
	UNION ALL
	SELECT * FROM auto_naf_form_cd
	UNION ALL
	SELECT * FROM mortgage_count
	UNION ALL
	SELECT * FROM mortgage_count_form_cd
	UNION ALL
	SELECT * FROM prior_cat_claim
	UNION ALL
	SELECT * FROM prior_cat_claim_form_cd
	UNION ALL
	SELECT * FROM prior_xcat_claim
	UNION ALL
	SELECT * FROM prior_xcat_claim_form_cd
	UNION ALL
	SELECT * FROM deduc
	UNION ALL
	SELECT * FROM deduc_form_cd
	UNION ALL
	SELECT * FROM wind_deduc
	UNION ALL
	SELECT * FROM opt_cov_pkg
	UNION ALL
	SELECT * FROM opt_cov_pkg_form_cd
	UNION ALL
	SELECT * FROM cov_a
	UNION ALL
	SELECT * FROM sq_ft
	UNION ALL
	SELECT * FROM cov_a_sq_ft
	UNION ALL
	SELECT * FROM dwell_age
	UNION ALL
	SELECT * FROM roof_age
	UNION ALL
	SELECT * FROM roof_sqft
	UNION ALL
	SELECT * FROM hail_roof
	UNION ALL
	SELECT * FROM roof_cond
	UNION ALL
	SELECT * FROM roof_shape
	UNION ALL
	SELECT * FROM build_fax_conf
	UNION ALL
	SELECT * FROM tree_overhang
	UNION ALL
	SELECT * FROM cape_cov
	UNION ALL
	SELECT * FROM const_mat
	UNION ALL
	SELECT * FROM story_cnt
	UNION ALL
	SELECT * FROM fire_alarm
	UNION ALL
	SELECT * FROM fire_alarm_form_cd
	UNION ALL
	SELECT * FROM dist_to_coast
	UNION ALL
	SELECT * FROM fireline_score
	UNION ALL
	SELECT * FROM hazard_hub
	UNION ALL
	SELECT * FROM limited_access
	UNION ALL
	SELECT * FROM dwell_substate
	UNION ALL
	SELECT * FROM dwell_substate_form_cd
)
ORDER BY KEY