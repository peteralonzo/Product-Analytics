WITH state_e_30 AS -- State E+30 R Inforce Data
(
	SELECT CONCAT(RISK_STATE,'E+30 R',BUS_UNIT_ABBR,
	CASE WHEN NEWCO_INDICATOR = 'Y' THEN 'Newco'
		 ELSE 'nowco' END,'Total') as Key,
	perst_calc_scorecard(18, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "18",
    perst_calc_scorecard(17, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "17",
    perst_calc_scorecard(16, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "16",
    perst_calc_scorecard(15, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "15",
    perst_calc_scorecard(14, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "14",
    perst_calc_scorecard(13, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "13",
    perst_calc_scorecard(12, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "12",
    perst_calc_scorecard(11, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "11",
    perst_calc_scorecard(10, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "10",
    perst_calc_scorecard(9, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "9",
    perst_calc_scorecard(8, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "8",
    perst_calc_scorecard(7, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "7",
    perst_calc_scorecard(6, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "6",
    perst_calc_scorecard(5, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "5",
    perst_calc_scorecard(4, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "4",
    perst_calc_scorecard(3, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "3",
    perst_calc_scorecard(2, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "2",
    perst_calc_scorecard(1, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "1",
    perst_calc_scorecard(0, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "0",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"
	WHERE POL_NEW_RENEW_CD = 'R' AND POL_EFF_DT >= '2023-01-01'
	AND BUS_UNIT_ABBR <> 'CDRT' AND LOB = 'HOME' AND ATR_E_30 = 1  
	AND CONCAT(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY',
	'NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY',
	'WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP',
	'INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP',
	'NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP',
	'UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP',
	'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP',
	'ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP',
	'WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

state_e_0 AS -- State E+0 R Inforce Data 
(
	SELECT CONCAT(RISK_STATE,'E+0 R',BUS_UNIT_ABBR,
	CASE WHEN NEWCO_INDICATOR = 'Y' THEN 'Newco'
		 ELSE 'nowco' END,'Total') as Key,
	perst_calc_scorecard(18, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "18",
    perst_calc_scorecard(17, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "17",
    perst_calc_scorecard(16, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "16",
    perst_calc_scorecard(15, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "15",
    perst_calc_scorecard(14, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "14",
    perst_calc_scorecard(13, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "13",
    perst_calc_scorecard(12, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "12",
    perst_calc_scorecard(11, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "11",
    perst_calc_scorecard(10, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "10",
    perst_calc_scorecard(9, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "9",
    perst_calc_scorecard(8, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "8",
    perst_calc_scorecard(7, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "7",
    perst_calc_scorecard(6, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "6",
    perst_calc_scorecard(5, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "5",
    perst_calc_scorecard(4, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "4",
    perst_calc_scorecard(3, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "3",
    perst_calc_scorecard(2, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "2",
    perst_calc_scorecard(1, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "1",
    perst_calc_scorecard(0, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "0",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"
	WHERE POL_NEW_RENEW_CD = 'R' AND POL_EFF_DT >= '2023-01-01'
	AND BUS_UNIT_ABBR <> 'CDRT' AND LOB = 'HOME' AND ATR_E_FLAT = 1  
	AND CONCAT(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY',
	'NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY',
	'WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP',
	'INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP',
	'NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP',
	'UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP',
	'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP',
	'ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP',
	'WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

state_e_ult AS -- State E+Ult R Inforce Data
(
	SELECT CONCAT(RISK_STATE,'E+Ult R',BUS_UNIT_ABBR,
	CASE WHEN NEWCO_INDICATOR = 'Y' THEN 'Newco'
		 ELSE 'nowco' END,'Total') as Key,
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 18 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 18 THEN ULT_ATR_CNT ELSE 0 END)) AS "18",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 17 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 17 THEN ULT_ATR_CNT ELSE 0 END)) AS "17",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 16 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 16 THEN ULT_ATR_CNT ELSE 0 END)) AS "16",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 15 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 15 THEN ULT_ATR_CNT ELSE 0 END)) AS "15",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 14 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 14 THEN ULT_ATR_CNT ELSE 0 END)) AS "14",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 13 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 13 THEN ULT_ATR_CNT ELSE 0 END)) AS "13",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 12 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 12 THEN ULT_ATR_CNT ELSE 0 END)) AS "12",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 11 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 11 THEN ULT_ATR_CNT ELSE 0 END)) AS "11",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 10 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 10 THEN ULT_ATR_CNT ELSE 0 END)) AS "10",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 9 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 9 THEN ULT_ATR_CNT ELSE 0 END)) AS "9",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 8 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 8 THEN ULT_ATR_CNT ELSE 0 END)) AS "8",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 7 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 7 THEN ULT_ATR_CNT ELSE 0 END)) AS "7",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 6 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 6 THEN ULT_ATR_CNT ELSE 0 END)) AS "6",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 5 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 5 THEN ULT_ATR_CNT ELSE 0 END)) AS "5",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 4 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 4 THEN ULT_ATR_CNT ELSE 0 END)) AS "4",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 3 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 3 THEN ULT_ATR_CNT ELSE 0 END)) AS "3",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 2 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 2 THEN ULT_ATR_CNT ELSE 0 END)) AS "2",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 1 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 1 THEN ULT_ATR_CNT ELSE 0 END)) AS "1",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 0 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 0 THEN ULT_ATR_CNT ELSE 0 END)) AS "0",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"
	WHERE POL_NEW_RENEW_CD = 'R' AND POL_EFF_DT >= '2023-01-01'
	AND BUS_UNIT_ABBR <> 'CDRT' AND LOB = 'HOME' AND ULT_ATR_CNT = 1  
	AND CONCAT(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY',
	'NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY',
	'WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP',
	'INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP',
	'NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP',
	'UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP',
	'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP',
	'ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP',
	'WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

state_prem_change AS -- State Prem Change Inforce Data
(
	SELECT CONCAT(RISK_STATE,'PremiumChange',BUS_UNIT_ABBR,
	CASE WHEN NEWCO_INDICATOR = 'Y' THEN 'Newco'
		 ELSE 'nowco' END,'Total') as Key,
	DIV0NULL(zero_cond_scorecard(18, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(18, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "18",
	DIV0NULL(zero_cond_scorecard(17, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(17, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "17",
	DIV0NULL(zero_cond_scorecard(16, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(16, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "16",
	DIV0NULL(zero_cond_scorecard(15, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(15, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "15",
	DIV0NULL(zero_cond_scorecard(14, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(14, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "14",
	DIV0NULL(zero_cond_scorecard(13, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(13, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "13",
	DIV0NULL(zero_cond_scorecard(12, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(12, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "12",
	DIV0NULL(zero_cond_scorecard(11, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(11, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "11",
	DIV0NULL(zero_cond_scorecard(10, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(10, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "10",
	DIV0NULL(zero_cond_scorecard(9, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(9, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "9",
	DIV0NULL(zero_cond_scorecard(8, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(8, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "8",
	DIV0NULL(zero_cond_scorecard(7, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(7, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "7",
	DIV0NULL(zero_cond_scorecard(6, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(6, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "6",
	DIV0NULL(zero_cond_scorecard(5, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(5, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "5",
	DIV0NULL(zero_cond_scorecard(4, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(4, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "4",
	DIV0NULL(zero_cond_scorecard(3, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(3, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "3",
	DIV0NULL(zero_cond_scorecard(2, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(2, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "2",
	DIV0NULL(zero_cond_scorecard(1, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(1, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "1",
	DIV0NULL(zero_cond_scorecard(0, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(0, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "0",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"
	WHERE POL_NEW_RENEW_CD = 'R' AND POL_EFF_DT >= '2023-01-01'
	AND BUS_UNIT_ABBR <> 'CDRT' AND LOB = 'HOME' AND ULT_ATR_CNT = 1  
	AND CONCAT(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY',
	'NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY',
	'WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP',
	'INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP',
	'NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP',
	'UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP',
	'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP',
	'ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP',
	'WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

state_e_30_form_cd AS -- State E+30 R by Policy Form Code Inforce Data
(
	SELECT CONCAT(RISK_STATE,'E+30 R',BUS_UNIT_ABBR, CASE WHEN NEWCO_INDICATOR='Y' THEN 'Newco' ELSE 'nowco' END,
	CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
		 WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
		 ELSE 'Other' END) as Key,
	perst_calc_scorecard(18, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "18",
    perst_calc_scorecard(17, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "17",
    perst_calc_scorecard(16, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "16",
    perst_calc_scorecard(15, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "15",
    perst_calc_scorecard(14, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "14",
    perst_calc_scorecard(13, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "13",
    perst_calc_scorecard(12, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "12",
    perst_calc_scorecard(11, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "11",
    perst_calc_scorecard(10, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "10",
    perst_calc_scorecard(9, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "9",
    perst_calc_scorecard(8, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "8",
    perst_calc_scorecard(7, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "7",
    perst_calc_scorecard(6, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "6",
    perst_calc_scorecard(5, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "5",
    perst_calc_scorecard(4, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "4",
    perst_calc_scorecard(3, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "3",
    perst_calc_scorecard(2, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "2",
    perst_calc_scorecard(1, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "1",
    perst_calc_scorecard(0, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "0",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"
	WHERE POL_NEW_RENEW_CD = 'R' AND POL_EFF_DT >= '2023-01-01'
	AND BUS_UNIT_ABBR <> 'CDRT' AND LOB = 'HOME' AND ATR_E_30 = 1  
	AND CONCAT(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY',
	'NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY',
	'WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP',
	'INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP',
	'NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP',
	'UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP',
	'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP',
	'ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP',
	'WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

state_e_0_form_cd AS -- State E+0 R by Policy Form Code Inforce Data
(
	SELECT CONCAT(RISK_STATE,'E+0 R',BUS_UNIT_ABBR, CASE WHEN NEWCO_INDICATOR='Y' THEN 'Newco' ELSE 'nowco' END,
	CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
		 WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
		 ELSE 'Other' END) as Key,
	perst_calc_scorecard(18, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "18",
    perst_calc_scorecard(17, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "17",
    perst_calc_scorecard(16, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "16",
    perst_calc_scorecard(15, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "15",
    perst_calc_scorecard(14, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "14",
    perst_calc_scorecard(13, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "13",
    perst_calc_scorecard(12, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "12",
    perst_calc_scorecard(11, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "11",
    perst_calc_scorecard(10, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "10",
    perst_calc_scorecard(9, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "9",
    perst_calc_scorecard(8, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "8",
    perst_calc_scorecard(7, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "7",
    perst_calc_scorecard(6, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "6",
    perst_calc_scorecard(5, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "5",
    perst_calc_scorecard(4, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "4",
    perst_calc_scorecard(3, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "3",
    perst_calc_scorecard(2, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "2",
    perst_calc_scorecard(1, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "1",
    perst_calc_scorecard(0, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "0",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"
	WHERE POL_NEW_RENEW_CD = 'R' AND POL_EFF_DT >= '2023-01-01'
	AND BUS_UNIT_ABBR <> 'CDRT' AND LOB = 'HOME' AND ATR_E_FLAT = 1  
	AND CONCAT(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY',
	'NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY',
	'WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP',
	'INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP',
	'NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP',
	'UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP',
	'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP',
	'ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP',
	'WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

state_e_ult_form_cd AS -- State E+Ult R by Policy Form Code Inforce Data
(
	SELECT CONCAT(RISK_STATE,'E+Ult R',BUS_UNIT_ABBR, CASE WHEN NEWCO_INDICATOR='Y' THEN 'Newco' ELSE 'nowco' END,
	CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
		 WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
		 ELSE 'Other' END) as Key,
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 18 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 18 THEN ULT_ATR_CNT ELSE 0 END)) AS "18",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 17 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 17 THEN ULT_ATR_CNT ELSE 0 END)) AS "17",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 16 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 16 THEN ULT_ATR_CNT ELSE 0 END)) AS "16",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 15 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 15 THEN ULT_ATR_CNT ELSE 0 END)) AS "15",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 14 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 14 THEN ULT_ATR_CNT ELSE 0 END)) AS "14",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 13 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 13 THEN ULT_ATR_CNT ELSE 0 END)) AS "13",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 12 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 12 THEN ULT_ATR_CNT ELSE 0 END)) AS "12",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 11 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 11 THEN ULT_ATR_CNT ELSE 0 END)) AS "11",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 10 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 10 THEN ULT_ATR_CNT ELSE 0 END)) AS "10",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 9 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 9 THEN ULT_ATR_CNT ELSE 0 END)) AS "9",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 8 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 8 THEN ULT_ATR_CNT ELSE 0 END)) AS "8",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 7 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 7 THEN ULT_ATR_CNT ELSE 0 END)) AS "7",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 6 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 6 THEN ULT_ATR_CNT ELSE 0 END)) AS "6",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 5 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 5 THEN ULT_ATR_CNT ELSE 0 END)) AS "5",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 4 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 4 THEN ULT_ATR_CNT ELSE 0 END)) AS "4",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 3 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 3 THEN ULT_ATR_CNT ELSE 0 END)) AS "3",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 2 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 2 THEN ULT_ATR_CNT ELSE 0 END)) AS "2",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 1 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 1 THEN ULT_ATR_CNT ELSE 0 END)) AS "1",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 0 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 0 THEN ULT_ATR_CNT ELSE 0 END)) AS "0",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"
	WHERE POL_NEW_RENEW_CD = 'R' AND POL_EFF_DT >= '2023-01-01'
	AND BUS_UNIT_ABBR <> 'CDRT' AND LOB = 'HOME' AND ULT_ATR_CNT = 1  
	AND CONCAT(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY',
	'NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY',
	'WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP',
	'INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP',
	'NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP',
	'UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP',
	'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP',
	'ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP',
	'WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

state_prem_change_form_cd AS -- State Prem Change by Policy Form Code Inforce Data
(
	SELECT CONCAT(RISK_STATE,'PremiumChange',BUS_UNIT_ABBR, CASE WHEN NEWCO_INDICATOR='Y' THEN 'Newco' ELSE 'nowco' END,
	CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
		 WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
		 ELSE 'Other' END) as Key,
	DIV0NULL(zero_cond_scorecard(18, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(18, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "18",
	DIV0NULL(zero_cond_scorecard(17, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(17, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "17",
	DIV0NULL(zero_cond_scorecard(16, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(16, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "16",
	DIV0NULL(zero_cond_scorecard(15, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(15, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "15",
	DIV0NULL(zero_cond_scorecard(14, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(14, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "14",
	DIV0NULL(zero_cond_scorecard(13, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(13, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "13",
	DIV0NULL(zero_cond_scorecard(12, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(12, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "12",
	DIV0NULL(zero_cond_scorecard(11, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(11, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "11",
	DIV0NULL(zero_cond_scorecard(10, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(10, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "10",
	DIV0NULL(zero_cond_scorecard(9, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(9, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "9",
	DIV0NULL(zero_cond_scorecard(8, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(8, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "8",
	DIV0NULL(zero_cond_scorecard(7, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(7, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "7",
	DIV0NULL(zero_cond_scorecard(6, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(6, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "6",
	DIV0NULL(zero_cond_scorecard(5, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(5, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "5",
	DIV0NULL(zero_cond_scorecard(4, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(4, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "4",
	DIV0NULL(zero_cond_scorecard(3, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(3, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "3",
	DIV0NULL(zero_cond_scorecard(2, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(2, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "2",
	DIV0NULL(zero_cond_scorecard(1, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(1, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "1",
	DIV0NULL(zero_cond_scorecard(0, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(0, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "0",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"
	WHERE POL_NEW_RENEW_CD = 'R' AND POL_EFF_DT >= '2023-01-01'
	AND BUS_UNIT_ABBR <> 'CDRT' AND LOB = 'HOME' AND ULT_ATR_CNT = 1  
	AND CONCAT(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY',
	'NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY',
	'WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP',
	'INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP',
	'NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP',
	'UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP',
	'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP',
	'ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP',
	'WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

cw_e_30 AS -- CW E+30 R Inforce Data
(
	SELECT CONCAT('CW','E+30 R',BUS_UNIT_ABBR,
	CASE WHEN NEWCO_INDICATOR = 'Y' THEN 'Newco'
		 ELSE 'nowco' END,'Total') as Key,
	perst_calc_scorecard(18, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "18",
    perst_calc_scorecard(17, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "17",
    perst_calc_scorecard(16, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "16",
    perst_calc_scorecard(15, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "15",
    perst_calc_scorecard(14, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "14",
    perst_calc_scorecard(13, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "13",
    perst_calc_scorecard(12, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "12",
    perst_calc_scorecard(11, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "11",
    perst_calc_scorecard(10, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "10",
    perst_calc_scorecard(9, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "9",
    perst_calc_scorecard(8, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "8",
    perst_calc_scorecard(7, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "7",
    perst_calc_scorecard(6, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "6",
    perst_calc_scorecard(5, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "5",
    perst_calc_scorecard(4, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "4",
    perst_calc_scorecard(3, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "3",
    perst_calc_scorecard(2, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "2",
    perst_calc_scorecard(1, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "1",
    perst_calc_scorecard(0, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "0",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"
	WHERE POL_NEW_RENEW_CD = 'R' AND POL_EFF_DT >= '2023-01-01'
	AND BUS_UNIT_ABBR <> 'CDRT' AND LOB = 'HOME' AND ATR_E_30 = 1  
	AND CONCAT(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY',
	'NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY',
	'WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP',
	'INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP',
	'NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP',
	'UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP',
	'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP',
	'ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP',
	'WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

cw_e_0 AS -- CW E+0 R Inforce Data 
(
	SELECT CONCAT('CW','E+0 R',BUS_UNIT_ABBR,
	CASE WHEN NEWCO_INDICATOR = 'Y' THEN 'Newco'
		 ELSE 'nowco' END,'Total') as Key,
	perst_calc_scorecard(18, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "18",
    perst_calc_scorecard(17, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "17",
    perst_calc_scorecard(16, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "16",
    perst_calc_scorecard(15, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "15",
    perst_calc_scorecard(14, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "14",
    perst_calc_scorecard(13, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "13",
    perst_calc_scorecard(12, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "12",
    perst_calc_scorecard(11, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "11",
    perst_calc_scorecard(10, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "10",
    perst_calc_scorecard(9, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "9",
    perst_calc_scorecard(8, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "8",
    perst_calc_scorecard(7, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "7",
    perst_calc_scorecard(6, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "6",
    perst_calc_scorecard(5, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "5",
    perst_calc_scorecard(4, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "4",
    perst_calc_scorecard(3, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "3",
    perst_calc_scorecard(2, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "2",
    perst_calc_scorecard(1, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "1",
    perst_calc_scorecard(0, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "0",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"
	WHERE POL_NEW_RENEW_CD = 'R' AND POL_EFF_DT >= '2023-01-01'
	AND BUS_UNIT_ABBR <> 'CDRT' AND LOB = 'HOME' AND ATR_E_FLAT = 1  
	AND CONCAT(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY',
	'NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY',
	'WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP',
	'INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP',
	'NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP',
	'UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP',
	'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP',
	'ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP',
	'WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

cw_e_ult AS -- CW E+Ult R Inforce Data
(
	SELECT CONCAT('CW','E+Ult R',BUS_UNIT_ABBR,
	CASE WHEN NEWCO_INDICATOR = 'Y' THEN 'Newco'
		 ELSE 'nowco' END,'Total') as Key,
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 18 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 18 THEN ULT_ATR_CNT ELSE 0 END)) AS "18",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 17 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 17 THEN ULT_ATR_CNT ELSE 0 END)) AS "17",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 16 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 16 THEN ULT_ATR_CNT ELSE 0 END)) AS "16",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 15 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 15 THEN ULT_ATR_CNT ELSE 0 END)) AS "15",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 14 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 14 THEN ULT_ATR_CNT ELSE 0 END)) AS "14",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 13 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 13 THEN ULT_ATR_CNT ELSE 0 END)) AS "13",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 12 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 12 THEN ULT_ATR_CNT ELSE 0 END)) AS "12",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 11 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 11 THEN ULT_ATR_CNT ELSE 0 END)) AS "11",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 10 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 10 THEN ULT_ATR_CNT ELSE 0 END)) AS "10",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 9 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 9 THEN ULT_ATR_CNT ELSE 0 END)) AS "9",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 8 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 8 THEN ULT_ATR_CNT ELSE 0 END)) AS "8",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 7 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 7 THEN ULT_ATR_CNT ELSE 0 END)) AS "7",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 6 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 6 THEN ULT_ATR_CNT ELSE 0 END)) AS "6",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 5 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 5 THEN ULT_ATR_CNT ELSE 0 END)) AS "5",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 4 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 4 THEN ULT_ATR_CNT ELSE 0 END)) AS "4",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 3 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 3 THEN ULT_ATR_CNT ELSE 0 END)) AS "3",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 2 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 2 THEN ULT_ATR_CNT ELSE 0 END)) AS "2",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 1 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 1 THEN ULT_ATR_CNT ELSE 0 END)) AS "1",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 0 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 0 THEN ULT_ATR_CNT ELSE 0 END)) AS "0",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"
	WHERE POL_NEW_RENEW_CD = 'R' AND POL_EFF_DT >= '2023-01-01'
	AND BUS_UNIT_ABBR <> 'CDRT' AND LOB = 'HOME' AND ULT_ATR_CNT = 1  
	AND CONCAT(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY',
	'NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY',
	'WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP',
	'INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP',
	'NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP',
	'UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP',
	'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP',
	'ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP',
	'WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

cw_prem_change AS -- CW Prem Change Inforce Data
(
	SELECT CONCAT('CW','PremiumChange',BUS_UNIT_ABBR,
	CASE WHEN NEWCO_INDICATOR = 'Y' THEN 'Newco'
		 ELSE 'nowco' END,'Total') as Key,
	DIV0NULL(zero_cond_scorecard(18, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(18, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "18",
	DIV0NULL(zero_cond_scorecard(17, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(17, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "17",
	DIV0NULL(zero_cond_scorecard(16, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(16, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "16",
	DIV0NULL(zero_cond_scorecard(15, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(15, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "15",
	DIV0NULL(zero_cond_scorecard(14, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(14, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "14",
	DIV0NULL(zero_cond_scorecard(13, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(13, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "13",
	DIV0NULL(zero_cond_scorecard(12, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(12, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "12",
	DIV0NULL(zero_cond_scorecard(11, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(11, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "11",
	DIV0NULL(zero_cond_scorecard(10, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(10, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "10",
	DIV0NULL(zero_cond_scorecard(9, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(9, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "9",
	DIV0NULL(zero_cond_scorecard(8, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(8, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "8",
	DIV0NULL(zero_cond_scorecard(7, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(7, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "7",
	DIV0NULL(zero_cond_scorecard(6, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(6, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "6",
	DIV0NULL(zero_cond_scorecard(5, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(5, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "5",
	DIV0NULL(zero_cond_scorecard(4, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(4, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "4",
	DIV0NULL(zero_cond_scorecard(3, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(3, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "3",
	DIV0NULL(zero_cond_scorecard(2, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(2, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "2",
	DIV0NULL(zero_cond_scorecard(1, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(1, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "1",
	DIV0NULL(zero_cond_scorecard(0, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(0, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "0",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"
	WHERE POL_NEW_RENEW_CD = 'R' AND POL_EFF_DT >= '2023-01-01'
	AND BUS_UNIT_ABBR <> 'CDRT' AND LOB = 'HOME' AND ULT_ATR_CNT = 1  
	AND CONCAT(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY',
	'NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY',
	'WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP',
	'INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP',
	'NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP',
	'UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP',
	'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP',
	'ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP',
	'WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

cw_e_30_form_cd AS -- CW E+30 R by Policy Form Code Inforce Data
(
	SELECT CONCAT('CW','E+30 R',BUS_UNIT_ABBR, CASE WHEN NEWCO_INDICATOR='Y' THEN 'Newco' ELSE 'nowco' END,
	CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
		 WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
		 ELSE 'Other' END) as Key,
	perst_calc_scorecard(18, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "18",
    perst_calc_scorecard(17, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "17",
    perst_calc_scorecard(16, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "16",
    perst_calc_scorecard(15, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "15",
    perst_calc_scorecard(14, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "14",
    perst_calc_scorecard(13, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "13",
    perst_calc_scorecard(12, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "12",
    perst_calc_scorecard(11, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "11",
    perst_calc_scorecard(10, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "10",
    perst_calc_scorecard(9, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "9",
    perst_calc_scorecard(8, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "8",
    perst_calc_scorecard(7, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "7",
    perst_calc_scorecard(6, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "6",
    perst_calc_scorecard(5, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "5",
    perst_calc_scorecard(4, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "4",
    perst_calc_scorecard(3, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "3",
    perst_calc_scorecard(2, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "2",
    perst_calc_scorecard(1, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "1",
    perst_calc_scorecard(0, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "0",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"
	WHERE POL_NEW_RENEW_CD = 'R' AND POL_EFF_DT >= '2023-01-01'
	AND BUS_UNIT_ABBR <> 'CDRT' AND LOB = 'HOME' AND ATR_E_30 = 1  
	AND CONCAT(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY',
	'NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY',
	'WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP',
	'INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP',
	'NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP',
	'UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP',
	'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP',
	'ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP',
	'WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

cw_e_0_form_cd AS -- CW E+0 R by Policy Form Code Inforce Data
(
	SELECT CONCAT('CW','E+0 R',BUS_UNIT_ABBR, CASE WHEN NEWCO_INDICATOR='Y' THEN 'Newco' ELSE 'nowco' END,
	CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
		 WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
		 ELSE 'Other' END) as Key,
	perst_calc_scorecard(18, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "18",
    perst_calc_scorecard(17, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "17",
    perst_calc_scorecard(16, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "16",
    perst_calc_scorecard(15, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "15",
    perst_calc_scorecard(14, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "14",
    perst_calc_scorecard(13, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "13",
    perst_calc_scorecard(12, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "12",
    perst_calc_scorecard(11, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "11",
    perst_calc_scorecard(10, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "10",
    perst_calc_scorecard(9, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "9",
    perst_calc_scorecard(8, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "8",
    perst_calc_scorecard(7, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "7",
    perst_calc_scorecard(6, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "6",
    perst_calc_scorecard(5, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "5",
    perst_calc_scorecard(4, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "4",
    perst_calc_scorecard(3, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "3",
    perst_calc_scorecard(2, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "2",
    perst_calc_scorecard(1, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "1",
    perst_calc_scorecard(0, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "0",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"
	WHERE POL_NEW_RENEW_CD = 'R' AND POL_EFF_DT >= '2023-01-01'
	AND BUS_UNIT_ABBR <> 'CDRT' AND LOB = 'HOME' AND ATR_E_FLAT = 1  
	AND CONCAT(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY',
	'NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY',
	'WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP',
	'INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP',
	'NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP',
	'UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP',
	'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP',
	'ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP',
	'WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

cw_e_ult_form_cd AS -- CW E+Ult R by Policy Form Code Inforce Data
(
	SELECT CONCAT('CW','E+Ult R',BUS_UNIT_ABBR, CASE WHEN NEWCO_INDICATOR='Y' THEN 'Newco' ELSE 'nowco' END,
	CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
		 WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
		 ELSE 'Other' END) as Key,
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 18 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 18 THEN ULT_ATR_CNT ELSE 0 END)) AS "18",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 17 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 17 THEN ULT_ATR_CNT ELSE 0 END)) AS "17",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 16 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 16 THEN ULT_ATR_CNT ELSE 0 END)) AS "16",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 15 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 15 THEN ULT_ATR_CNT ELSE 0 END)) AS "15",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 14 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 14 THEN ULT_ATR_CNT ELSE 0 END)) AS "14",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 13 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 13 THEN ULT_ATR_CNT ELSE 0 END)) AS "13",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 12 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 12 THEN ULT_ATR_CNT ELSE 0 END)) AS "12",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 11 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 11 THEN ULT_ATR_CNT ELSE 0 END)) AS "11",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 10 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 10 THEN ULT_ATR_CNT ELSE 0 END)) AS "10",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 9 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 9 THEN ULT_ATR_CNT ELSE 0 END)) AS "9",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 8 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 8 THEN ULT_ATR_CNT ELSE 0 END)) AS "8",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 7 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 7 THEN ULT_ATR_CNT ELSE 0 END)) AS "7",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 6 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 6 THEN ULT_ATR_CNT ELSE 0 END)) AS "6",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 5 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 5 THEN ULT_ATR_CNT ELSE 0 END)) AS "5",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 4 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 4 THEN ULT_ATR_CNT ELSE 0 END)) AS "4",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 3 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 3 THEN ULT_ATR_CNT ELSE 0 END)) AS "3",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 2 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 2 THEN ULT_ATR_CNT ELSE 0 END)) AS "2",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 1 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 1 THEN ULT_ATR_CNT ELSE 0 END)) AS "1",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 0 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 0 THEN ULT_ATR_CNT ELSE 0 END)) AS "0",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"
	WHERE POL_NEW_RENEW_CD = 'R' AND POL_EFF_DT >= '2023-01-01'
	AND BUS_UNIT_ABBR <> 'CDRT' AND LOB = 'HOME' AND ULT_ATR_CNT = 1  
	AND CONCAT(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY',
	'NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY',
	'WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP',
	'INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP',
	'NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP',
	'UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP',
	'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP',
	'ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP',
	'WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

cw_prem_change_form_cd AS -- CW Prem Change by Policy Form Code Inforce Data
(
	SELECT CONCAT('CW','PremiumChange',BUS_UNIT_ABBR, CASE WHEN NEWCO_INDICATOR='Y' THEN 'Newco' ELSE 'nowco' END,
	CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
		 WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
		 ELSE 'Other' END) as Key,
	DIV0NULL(zero_cond_scorecard(18, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(18, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "18",
	DIV0NULL(zero_cond_scorecard(17, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(17, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "17",
	DIV0NULL(zero_cond_scorecard(16, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(16, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "16",
	DIV0NULL(zero_cond_scorecard(15, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(15, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "15",
	DIV0NULL(zero_cond_scorecard(14, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(14, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "14",
	DIV0NULL(zero_cond_scorecard(13, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(13, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "13",
	DIV0NULL(zero_cond_scorecard(12, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(12, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "12",
	DIV0NULL(zero_cond_scorecard(11, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(11, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "11",
	DIV0NULL(zero_cond_scorecard(10, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(10, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "10",
	DIV0NULL(zero_cond_scorecard(9, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(9, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "9",
	DIV0NULL(zero_cond_scorecard(8, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(8, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "8",
	DIV0NULL(zero_cond_scorecard(7, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(7, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "7",
	DIV0NULL(zero_cond_scorecard(6, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(6, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "6",
	DIV0NULL(zero_cond_scorecard(5, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(5, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "5",
	DIV0NULL(zero_cond_scorecard(4, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(4, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "4",
	DIV0NULL(zero_cond_scorecard(3, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(3, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "3",
	DIV0NULL(zero_cond_scorecard(2, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(2, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "2",
	DIV0NULL(zero_cond_scorecard(1, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(1, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "1",
	DIV0NULL(zero_cond_scorecard(0, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(0, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "0",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"
	WHERE POL_NEW_RENEW_CD = 'R' AND POL_EFF_DT >= '2023-01-01'
	AND BUS_UNIT_ABBR <> 'CDRT' AND LOB = 'HOME' AND ULT_ATR_CNT = 1  
	AND CONCAT(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY',
	'NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY',
	'WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP',
	'INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP',
	'NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP',
	'UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP',
	'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP',
	'ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP',
	'WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

region_e_30 AS -- Regional E+30 R Inforce Data
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_STATE),'E+30 R',BUS_UNIT_ABBR,
	CASE WHEN NEWCO_INDICATOR = 'Y' THEN 'Newco'
		 ELSE 'nowco' END,'Total') as Key,
	perst_calc_scorecard(18, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "18",
    perst_calc_scorecard(17, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "17",
    perst_calc_scorecard(16, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "16",
    perst_calc_scorecard(15, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "15",
    perst_calc_scorecard(14, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "14",
    perst_calc_scorecard(13, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "13",
    perst_calc_scorecard(12, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "12",
    perst_calc_scorecard(11, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "11",
    perst_calc_scorecard(10, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "10",
    perst_calc_scorecard(9, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "9",
    perst_calc_scorecard(8, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "8",
    perst_calc_scorecard(7, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "7",
    perst_calc_scorecard(6, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "6",
    perst_calc_scorecard(5, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "5",
    perst_calc_scorecard(4, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "4",
    perst_calc_scorecard(3, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "3",
    perst_calc_scorecard(2, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "2",
    perst_calc_scorecard(1, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "1",
    perst_calc_scorecard(0, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "0",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"
	WHERE POL_NEW_RENEW_CD = 'R' AND POL_EFF_DT >= '2023-01-01'
	AND BUS_UNIT_ABBR <> 'CDRT' AND LOB = 'HOME' AND ATR_E_30 = 1  
	AND CONCAT(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY',
	'NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY',
	'WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP',
	'INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP',
	'NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP',
	'UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP',
	'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP',
	'ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP',
	'WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

region_e_0 AS -- Regional E+0 R Inforce Data 
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_STATE),'E+0 R',BUS_UNIT_ABBR,
	CASE WHEN NEWCO_INDICATOR = 'Y' THEN 'Newco'
		 ELSE 'nowco' END,'Total') as Key,
	perst_calc_scorecard(18, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "18",
    perst_calc_scorecard(17, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "17",
    perst_calc_scorecard(16, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "16",
    perst_calc_scorecard(15, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "15",
    perst_calc_scorecard(14, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "14",
    perst_calc_scorecard(13, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "13",
    perst_calc_scorecard(12, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "12",
    perst_calc_scorecard(11, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "11",
    perst_calc_scorecard(10, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "10",
    perst_calc_scorecard(9, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "9",
    perst_calc_scorecard(8, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "8",
    perst_calc_scorecard(7, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "7",
    perst_calc_scorecard(6, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "6",
    perst_calc_scorecard(5, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "5",
    perst_calc_scorecard(4, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "4",
    perst_calc_scorecard(3, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "3",
    perst_calc_scorecard(2, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "2",
    perst_calc_scorecard(1, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "1",
    perst_calc_scorecard(0, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "0",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"
	WHERE POL_NEW_RENEW_CD = 'R' AND POL_EFF_DT >= '2023-01-01'
	AND BUS_UNIT_ABBR <> 'CDRT' AND LOB = 'HOME' AND ATR_E_FLAT = 1  
	AND CONCAT(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY',
	'NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY',
	'WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP',
	'INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP',
	'NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP',
	'UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP',
	'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP',
	'ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP',
	'WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

region_e_ult AS -- Regional E+Ult R Inforce Data
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_STATE),'E+Ult R',BUS_UNIT_ABBR,
	CASE WHEN NEWCO_INDICATOR = 'Y' THEN 'Newco'
		 ELSE 'nowco' END,'Total') as Key,
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 18 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 18 THEN ULT_ATR_CNT ELSE 0 END)) AS "18",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 17 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 17 THEN ULT_ATR_CNT ELSE 0 END)) AS "17",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 16 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 16 THEN ULT_ATR_CNT ELSE 0 END)) AS "16",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 15 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 15 THEN ULT_ATR_CNT ELSE 0 END)) AS "15",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 14 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 14 THEN ULT_ATR_CNT ELSE 0 END)) AS "14",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 13 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 13 THEN ULT_ATR_CNT ELSE 0 END)) AS "13",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 12 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 12 THEN ULT_ATR_CNT ELSE 0 END)) AS "12",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 11 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 11 THEN ULT_ATR_CNT ELSE 0 END)) AS "11",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 10 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 10 THEN ULT_ATR_CNT ELSE 0 END)) AS "10",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 9 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 9 THEN ULT_ATR_CNT ELSE 0 END)) AS "9",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 8 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 8 THEN ULT_ATR_CNT ELSE 0 END)) AS "8",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 7 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 7 THEN ULT_ATR_CNT ELSE 0 END)) AS "7",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 6 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 6 THEN ULT_ATR_CNT ELSE 0 END)) AS "6",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 5 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 5 THEN ULT_ATR_CNT ELSE 0 END)) AS "5",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 4 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 4 THEN ULT_ATR_CNT ELSE 0 END)) AS "4",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 3 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 3 THEN ULT_ATR_CNT ELSE 0 END)) AS "3",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 2 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 2 THEN ULT_ATR_CNT ELSE 0 END)) AS "2",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 1 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 1 THEN ULT_ATR_CNT ELSE 0 END)) AS "1",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 0 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 0 THEN ULT_ATR_CNT ELSE 0 END)) AS "0",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"
	WHERE POL_NEW_RENEW_CD = 'R' AND POL_EFF_DT >= '2023-01-01'
	AND BUS_UNIT_ABBR <> 'CDRT' AND LOB = 'HOME' AND ULT_ATR_CNT = 1  
	AND CONCAT(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY',
	'NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY',
	'WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP',
	'INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP',
	'NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP',
	'UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP',
	'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP',
	'ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP',
	'WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

region_prem_change AS -- Regional Prem Change Inforce Data
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_STATE),'PremiumChange',BUS_UNIT_ABBR,
	CASE WHEN NEWCO_INDICATOR = 'Y' THEN 'Newco'
		 ELSE 'nowco' END,'Total') as Key,
	DIV0NULL(zero_cond_scorecard(18, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(18, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "18",
	DIV0NULL(zero_cond_scorecard(17, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(17, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "17",
	DIV0NULL(zero_cond_scorecard(16, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(16, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "16",
	DIV0NULL(zero_cond_scorecard(15, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(15, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "15",
	DIV0NULL(zero_cond_scorecard(14, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(14, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "14",
	DIV0NULL(zero_cond_scorecard(13, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(13, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "13",
	DIV0NULL(zero_cond_scorecard(12, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(12, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "12",
	DIV0NULL(zero_cond_scorecard(11, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(11, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "11",
	DIV0NULL(zero_cond_scorecard(10, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(10, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "10",
	DIV0NULL(zero_cond_scorecard(9, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(9, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "9",
	DIV0NULL(zero_cond_scorecard(8, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(8, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "8",
	DIV0NULL(zero_cond_scorecard(7, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(7, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "7",
	DIV0NULL(zero_cond_scorecard(6, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(6, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "6",
	DIV0NULL(zero_cond_scorecard(5, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(5, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "5",
	DIV0NULL(zero_cond_scorecard(4, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(4, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "4",
	DIV0NULL(zero_cond_scorecard(3, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(3, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "3",
	DIV0NULL(zero_cond_scorecard(2, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(2, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "2",
	DIV0NULL(zero_cond_scorecard(1, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(1, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "1",
	DIV0NULL(zero_cond_scorecard(0, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(0, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "0",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"
	WHERE POL_NEW_RENEW_CD = 'R' AND POL_EFF_DT >= '2023-01-01'
	AND BUS_UNIT_ABBR <> 'CDRT' AND LOB = 'HOME' AND ULT_ATR_CNT = 1  
	AND CONCAT(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY',
	'NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY',
	'WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP',
	'INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP',
	'NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP',
	'UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP',
	'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP',
	'ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP',
	'WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

region_e_30_form_cd AS -- Regional E+30 R by Policy Form Code Inforce Data
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_STATE),'E+30 R',BUS_UNIT_ABBR, CASE WHEN NEWCO_INDICATOR='Y' THEN 'Newco' ELSE 'nowco' END,
	CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
		 WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
		 ELSE 'Other' END) as Key,
	perst_calc_scorecard(18, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "18",
    perst_calc_scorecard(17, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "17",
    perst_calc_scorecard(16, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "16",
    perst_calc_scorecard(15, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "15",
    perst_calc_scorecard(14, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "14",
    perst_calc_scorecard(13, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "13",
    perst_calc_scorecard(12, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "12",
    perst_calc_scorecard(11, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "11",
    perst_calc_scorecard(10, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "10",
    perst_calc_scorecard(9, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "9",
    perst_calc_scorecard(8, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "8",
    perst_calc_scorecard(7, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "7",
    perst_calc_scorecard(6, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "6",
    perst_calc_scorecard(5, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "5",
    perst_calc_scorecard(4, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "4",
    perst_calc_scorecard(3, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "3",
    perst_calc_scorecard(2, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "2",
    perst_calc_scorecard(1, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "1",
    perst_calc_scorecard(0, POL_EFF_DT, CANCEL_E_30, ATR_E_30) AS "0",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"
	WHERE POL_NEW_RENEW_CD = 'R' AND POL_EFF_DT >= '2023-01-01'
	AND BUS_UNIT_ABBR <> 'CDRT' AND LOB = 'HOME' AND ATR_E_30 = 1  
	AND CONCAT(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY',
	'NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY',
	'WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP',
	'INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP',
	'NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP',
	'UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP',
	'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP',
	'ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP',
	'WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

region_e_0_form_cd AS -- Regional E+0 R by Policy Form Code Inforce Data
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_STATE),'E+0 R',BUS_UNIT_ABBR, CASE WHEN NEWCO_INDICATOR='Y' THEN 'Newco' ELSE 'nowco' END,
	CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
		 WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
		 ELSE 'Other' END) as Key,
	perst_calc_scorecard(18, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "18",
    perst_calc_scorecard(17, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "17",
    perst_calc_scorecard(16, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "16",
    perst_calc_scorecard(15, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "15",
    perst_calc_scorecard(14, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "14",
    perst_calc_scorecard(13, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "13",
    perst_calc_scorecard(12, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "12",
    perst_calc_scorecard(11, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "11",
    perst_calc_scorecard(10, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "10",
    perst_calc_scorecard(9, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "9",
    perst_calc_scorecard(8, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "8",
    perst_calc_scorecard(7, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "7",
    perst_calc_scorecard(6, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "6",
    perst_calc_scorecard(5, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "5",
    perst_calc_scorecard(4, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "4",
    perst_calc_scorecard(3, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "3",
    perst_calc_scorecard(2, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "2",
    perst_calc_scorecard(1, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "1",
    perst_calc_scorecard(0, POL_EFF_DT, CANCEL_E_FLAT, ATR_E_FLAT) AS "0",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"
	WHERE POL_NEW_RENEW_CD = 'R' AND POL_EFF_DT >= '2023-01-01'
	AND BUS_UNIT_ABBR <> 'CDRT' AND LOB = 'HOME' AND ATR_E_FLAT = 1  
	AND CONCAT(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY',
	'NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY',
	'WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP',
	'INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP',
	'NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP',
	'UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP',
	'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP',
	'ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP',
	'WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

region_e_ult_form_cd AS -- Regional E+Ult R by Policy Form Code Inforce Data
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_STATE),'E+Ult R',BUS_UNIT_ABBR, CASE WHEN NEWCO_INDICATOR='Y' THEN 'Newco' ELSE 'nowco' END,
	CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
		 WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
		 ELSE 'Other' END) as Key,
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 18 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 18 THEN ULT_ATR_CNT ELSE 0 END)) AS "18",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 17 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 17 THEN ULT_ATR_CNT ELSE 0 END)) AS "17",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 16 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 16 THEN ULT_ATR_CNT ELSE 0 END)) AS "16",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 15 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 15 THEN ULT_ATR_CNT ELSE 0 END)) AS "15",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 14 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 14 THEN ULT_ATR_CNT ELSE 0 END)) AS "14",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 13 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 13 THEN ULT_ATR_CNT ELSE 0 END)) AS "13",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 12 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 12 THEN ULT_ATR_CNT ELSE 0 END)) AS "12",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 11 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 11 THEN ULT_ATR_CNT ELSE 0 END)) AS "11",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 10 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 10 THEN ULT_ATR_CNT ELSE 0 END)) AS "10",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 9 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 9 THEN ULT_ATR_CNT ELSE 0 END)) AS "9",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 8 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 8 THEN ULT_ATR_CNT ELSE 0 END)) AS "8",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 7 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 7 THEN ULT_ATR_CNT ELSE 0 END)) AS "7",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 6 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 6 THEN ULT_ATR_CNT ELSE 0 END)) AS "6",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 5 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 5 THEN ULT_ATR_CNT ELSE 0 END)) AS "5",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 4 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 4 THEN ULT_ATR_CNT ELSE 0 END)) AS "4",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 3 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 3 THEN ULT_ATR_CNT ELSE 0 END)) AS "3",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 2 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 2 THEN ULT_ATR_CNT ELSE 0 END)) AS "2",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 1 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 1 THEN ULT_ATR_CNT ELSE 0 END)) AS "1",
	1 - DIV0NULL(SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 0 THEN ULT_CANC_CNT ELSE 0 END), 
				 SUM(CASE WHEN DATEDIFF(MONTH, POL_EFF_DT, SYSDATE()) = 0 THEN ULT_ATR_CNT ELSE 0 END)) AS "0",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"
	WHERE POL_NEW_RENEW_CD = 'R' AND POL_EFF_DT >= '2023-01-01'
	AND BUS_UNIT_ABBR <> 'CDRT' AND LOB = 'HOME' AND ULT_ATR_CNT = 1  
	AND CONCAT(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY',
	'NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY',
	'WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP',
	'INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP',
	'NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP',
	'UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP',
	'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP',
	'ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP',
	'WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

region_prem_change_form_cd AS -- Regional Prem Change by Policy Form Code Inforce Data
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_STATE),'PremiumChange',BUS_UNIT_ABBR, CASE WHEN NEWCO_INDICATOR='Y' THEN 'Newco' ELSE 'nowco' END,
	CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
		 WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
		 ELSE 'Other' END) as Key,
	DIV0NULL(zero_cond_scorecard(18, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(18, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "18",
	DIV0NULL(zero_cond_scorecard(17, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(17, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "17",
	DIV0NULL(zero_cond_scorecard(16, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(16, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "16",
	DIV0NULL(zero_cond_scorecard(15, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(15, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "15",
	DIV0NULL(zero_cond_scorecard(14, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(14, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "14",
	DIV0NULL(zero_cond_scorecard(13, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(13, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "13",
	DIV0NULL(zero_cond_scorecard(12, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(12, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "12",
	DIV0NULL(zero_cond_scorecard(11, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(11, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "11",
	DIV0NULL(zero_cond_scorecard(10, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(10, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "10",
	DIV0NULL(zero_cond_scorecard(9, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(9, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "9",
	DIV0NULL(zero_cond_scorecard(8, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(8, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "8",
	DIV0NULL(zero_cond_scorecard(7, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(7, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "7",
	DIV0NULL(zero_cond_scorecard(6, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(6, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "6",
	DIV0NULL(zero_cond_scorecard(5, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(5, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "5",
	DIV0NULL(zero_cond_scorecard(4, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(4, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "4",
	DIV0NULL(zero_cond_scorecard(3, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(3, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "3",
	DIV0NULL(zero_cond_scorecard(2, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(2, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "2",
	DIV0NULL(zero_cond_scorecard(1, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(1, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "1",
	DIV0NULL(zero_cond_scorecard(0, POL_EFF_DT, FIRST_TRANS_PREM), zero_cond_scorecard(0, POL_EFF_DT, PRIOR_TERM_LATEST_PREM)) - 1 AS "0",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"
	WHERE POL_NEW_RENEW_CD = 'R' AND POL_EFF_DT >= '2023-01-01'
	AND BUS_UNIT_ABBR <> 'CDRT' AND LOB = 'HOME' AND ULT_ATR_CNT = 1  
	AND CONCAT(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY',
	'NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY',
	'WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP',
	'INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP',
	'NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP',
	'UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP',
	'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP',
	'ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP',
	'WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

state_inforce AS -- State Inforce Counts from MonthEnd
(
	SELECT CONCAT(STATE_ABBR,'Inforce',BUS_UNIT_ABBR, CASE WHEN NEWCO_IND = 'Y' THEN 'Newco' ELSE 'nowco' END,'Total') as Key,
	zero_cond_scorecard(18, ME_DT, POL_INFORCE_CNT) AS "18",
	zero_cond_scorecard(17, ME_DT, POL_INFORCE_CNT) AS "17",
	zero_cond_scorecard(16, ME_DT, POL_INFORCE_CNT) AS "16",
	zero_cond_scorecard(15, ME_DT, POL_INFORCE_CNT) AS "15",
	zero_cond_scorecard(14, ME_DT, POL_INFORCE_CNT) AS "14",
	zero_cond_scorecard(13, ME_DT, POL_INFORCE_CNT) AS "13",
	zero_cond_scorecard(12, ME_DT, POL_INFORCE_CNT) AS "12",
	zero_cond_scorecard(11, ME_DT, POL_INFORCE_CNT) AS "11",
	zero_cond_scorecard(10, ME_DT, POL_INFORCE_CNT) AS "10",
	zero_cond_scorecard(9, ME_DT, POL_INFORCE_CNT) AS "9",
	zero_cond_scorecard(8, ME_DT, POL_INFORCE_CNT) AS "8",
	zero_cond_scorecard(7, ME_DT, POL_INFORCE_CNT) AS "7",
	zero_cond_scorecard(6, ME_DT, POL_INFORCE_CNT) AS "6",
	zero_cond_scorecard(5, ME_DT, POL_INFORCE_CNT) AS "5",
	zero_cond_scorecard(4, ME_DT, POL_INFORCE_CNT) AS "4",
	zero_cond_scorecard(3, ME_DT, POL_INFORCE_CNT) AS "3",
	zero_cond_scorecard(2, ME_DT, POL_INFORCE_CNT) AS "2",
	zero_cond_scorecard(1, ME_DT, POL_INFORCE_CNT) AS "1",
	zero_cond_scorecard(0, ME_DT, POL_INFORCE_CNT) AS "0",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."HOME_INFORCE_MONTHEND"
	WHERE CONCAT(STATE_ABBR,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY',  'MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY',
	'NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY', 'TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY',
	'WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP', 'DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP',
	'IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP', 'MOHNGAARP','MSHNGAARP','MTHNGAARP',
	'NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP', 'SCHNGAARP','SDHNGAARP',
	'TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY', 'ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP', 'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP',
	'MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP', 'SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP',
	'UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP', 'MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP',
	'FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

region_inforce AS -- Regional Inforce Counts from MonthEnd
(
	SELECT CONCAT(GET_REGION_SCORECARD(STATE_ABBR),'Inforce',BUS_UNIT_ABBR, CASE WHEN NEWCO_IND = 'Y' THEN 'Newco' ELSE 'nowco' END,'Total') as Key,
	zero_cond_scorecard(18, ME_DT, POL_INFORCE_CNT) AS "18",
	zero_cond_scorecard(17, ME_DT, POL_INFORCE_CNT) AS "17",
	zero_cond_scorecard(16, ME_DT, POL_INFORCE_CNT) AS "16",
	zero_cond_scorecard(15, ME_DT, POL_INFORCE_CNT) AS "15",
	zero_cond_scorecard(14, ME_DT, POL_INFORCE_CNT) AS "14",
	zero_cond_scorecard(13, ME_DT, POL_INFORCE_CNT) AS "13",
	zero_cond_scorecard(12, ME_DT, POL_INFORCE_CNT) AS "12",
	zero_cond_scorecard(11, ME_DT, POL_INFORCE_CNT) AS "11",
	zero_cond_scorecard(10, ME_DT, POL_INFORCE_CNT) AS "10",
	zero_cond_scorecard(9, ME_DT, POL_INFORCE_CNT) AS "9",
	zero_cond_scorecard(8, ME_DT, POL_INFORCE_CNT) AS "8",
	zero_cond_scorecard(7, ME_DT, POL_INFORCE_CNT) AS "7",
	zero_cond_scorecard(6, ME_DT, POL_INFORCE_CNT) AS "6",
	zero_cond_scorecard(5, ME_DT, POL_INFORCE_CNT) AS "5",
	zero_cond_scorecard(4, ME_DT, POL_INFORCE_CNT) AS "4",
	zero_cond_scorecard(3, ME_DT, POL_INFORCE_CNT) AS "3",
	zero_cond_scorecard(2, ME_DT, POL_INFORCE_CNT) AS "2",
	zero_cond_scorecard(1, ME_DT, POL_INFORCE_CNT) AS "1",
	zero_cond_scorecard(0, ME_DT, POL_INFORCE_CNT) AS "0",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."HOME_INFORCE_MONTHEND"
	WHERE CONCAT(STATE_ABBR,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY',  'MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY',
	'NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY', 'TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY',
	'WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP', 'DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP',
	'IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP', 'MOHNGAARP','MSHNGAARP','MTHNGAARP',
	'NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP', 'SCHNGAARP','SDHNGAARP',
	'TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY', 'ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP', 'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP',
	'MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP', 'SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP',
	'UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP', 'MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP',
	'FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

cw_inforce AS -- CW Inforce Counts from MonthEnd
(
	SELECT CONCAT('CW','Inforce',BUS_UNIT_ABBR, CASE WHEN NEWCO_IND = 'Y' THEN 'Newco' ELSE 'nowco' END,'Total') as Key,
	zero_cond_scorecard(18, ME_DT, POL_INFORCE_CNT) AS "18",
	zero_cond_scorecard(17, ME_DT, POL_INFORCE_CNT) AS "17",
	zero_cond_scorecard(16, ME_DT, POL_INFORCE_CNT) AS "16",
	zero_cond_scorecard(15, ME_DT, POL_INFORCE_CNT) AS "15",
	zero_cond_scorecard(14, ME_DT, POL_INFORCE_CNT) AS "14",
	zero_cond_scorecard(13, ME_DT, POL_INFORCE_CNT) AS "13",
	zero_cond_scorecard(12, ME_DT, POL_INFORCE_CNT) AS "12",
	zero_cond_scorecard(11, ME_DT, POL_INFORCE_CNT) AS "11",
	zero_cond_scorecard(10, ME_DT, POL_INFORCE_CNT) AS "10",
	zero_cond_scorecard(9, ME_DT, POL_INFORCE_CNT) AS "9",
	zero_cond_scorecard(8, ME_DT, POL_INFORCE_CNT) AS "8",
	zero_cond_scorecard(7, ME_DT, POL_INFORCE_CNT) AS "7",
	zero_cond_scorecard(6, ME_DT, POL_INFORCE_CNT) AS "6",
	zero_cond_scorecard(5, ME_DT, POL_INFORCE_CNT) AS "5",
	zero_cond_scorecard(4, ME_DT, POL_INFORCE_CNT) AS "4",
	zero_cond_scorecard(3, ME_DT, POL_INFORCE_CNT) AS "3",
	zero_cond_scorecard(2, ME_DT, POL_INFORCE_CNT) AS "2",
	zero_cond_scorecard(1, ME_DT, POL_INFORCE_CNT) AS "1",
	zero_cond_scorecard(0, ME_DT, POL_INFORCE_CNT) AS "0",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."HOME_INFORCE_MONTHEND"
	WHERE CONCAT(STATE_ABBR,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY',  'MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY',
	'NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY', 'TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY',
	'WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP', 'DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP',
	'IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP', 'MOHNGAARP','MSHNGAARP','MTHNGAARP',
	'NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP', 'SCHNGAARP','SDHNGAARP',
	'TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY', 'ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP', 'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP',
	'MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP', 'SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP',
	'UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP', 'MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP',
	'FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

state_wp AS -- State Written Premium from MonthEnd
(
	SELECT CONCAT(STATE_ABBR,'Written Premium',BUS_UNIT_ABBR, CASE WHEN NEWCO_IND = 'Y' THEN 'Newco' ELSE 'nowco' END,'Total') as Key,
	zero_cond_scorecard(18, ME_DT, TERM_WRIT_PREM) AS "18",
	zero_cond_scorecard(17, ME_DT, TERM_WRIT_PREM) AS "17",
	zero_cond_scorecard(16, ME_DT, TERM_WRIT_PREM) AS "16",
	zero_cond_scorecard(15, ME_DT, TERM_WRIT_PREM) AS "15",
	zero_cond_scorecard(14, ME_DT, TERM_WRIT_PREM) AS "14",
	zero_cond_scorecard(13, ME_DT, TERM_WRIT_PREM) AS "13",
	zero_cond_scorecard(12, ME_DT, TERM_WRIT_PREM) AS "12",
	zero_cond_scorecard(11, ME_DT, TERM_WRIT_PREM) AS "11",
	zero_cond_scorecard(10, ME_DT, TERM_WRIT_PREM) AS "10",
	zero_cond_scorecard(9, ME_DT, TERM_WRIT_PREM) AS "9",
	zero_cond_scorecard(8, ME_DT, TERM_WRIT_PREM) AS "8",
	zero_cond_scorecard(7, ME_DT, TERM_WRIT_PREM) AS "7",
	zero_cond_scorecard(6, ME_DT, TERM_WRIT_PREM) AS "6",
	zero_cond_scorecard(5, ME_DT, TERM_WRIT_PREM) AS "5",
	zero_cond_scorecard(4, ME_DT, TERM_WRIT_PREM) AS "4",
	zero_cond_scorecard(3, ME_DT, TERM_WRIT_PREM) AS "3",
	zero_cond_scorecard(2, ME_DT, TERM_WRIT_PREM) AS "2",
	zero_cond_scorecard(1, ME_DT, TERM_WRIT_PREM) AS "1",
	zero_cond_scorecard(0, ME_DT, TERM_WRIT_PREM) AS "0",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."HOME_INFORCE_MONTHEND"
	WHERE CONCAT(STATE_ABBR,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY',  'MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY',
	'NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY', 'TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY',
	'WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP', 'DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP',
	'IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP', 'MOHNGAARP','MSHNGAARP','MTHNGAARP',
	'NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP', 'SCHNGAARP','SDHNGAARP',
	'TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY', 'ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP', 'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP',
	'MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP', 'SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP',
	'UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP', 'MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP',
	'FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

cw_wp AS -- CW Written Premium from MonthEnd
(
	SELECT CONCAT('CW','Written Premium',BUS_UNIT_ABBR, CASE WHEN NEWCO_IND = 'Y' THEN 'Newco' ELSE 'nowco' END,'Total') as Key,
	zero_cond_scorecard(18, ME_DT, TERM_WRIT_PREM) AS "18",
	zero_cond_scorecard(17, ME_DT, TERM_WRIT_PREM) AS "17",
	zero_cond_scorecard(16, ME_DT, TERM_WRIT_PREM) AS "16",
	zero_cond_scorecard(15, ME_DT, TERM_WRIT_PREM) AS "15",
	zero_cond_scorecard(14, ME_DT, TERM_WRIT_PREM) AS "14",
	zero_cond_scorecard(13, ME_DT, TERM_WRIT_PREM) AS "13",
	zero_cond_scorecard(12, ME_DT, TERM_WRIT_PREM) AS "12",
	zero_cond_scorecard(11, ME_DT, TERM_WRIT_PREM) AS "11",
	zero_cond_scorecard(10, ME_DT, TERM_WRIT_PREM) AS "10",
	zero_cond_scorecard(9, ME_DT, TERM_WRIT_PREM) AS "9",
	zero_cond_scorecard(8, ME_DT, TERM_WRIT_PREM) AS "8",
	zero_cond_scorecard(7, ME_DT, TERM_WRIT_PREM) AS "7",
	zero_cond_scorecard(6, ME_DT, TERM_WRIT_PREM) AS "6",
	zero_cond_scorecard(5, ME_DT, TERM_WRIT_PREM) AS "5",
	zero_cond_scorecard(4, ME_DT, TERM_WRIT_PREM) AS "4",
	zero_cond_scorecard(3, ME_DT, TERM_WRIT_PREM) AS "3",
	zero_cond_scorecard(2, ME_DT, TERM_WRIT_PREM) AS "2",
	zero_cond_scorecard(1, ME_DT, TERM_WRIT_PREM) AS "1",
	zero_cond_scorecard(0, ME_DT, TERM_WRIT_PREM) AS "0",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."HOME_INFORCE_MONTHEND"
	WHERE CONCAT(STATE_ABBR,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY',  'MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY',
	'NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY', 'TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY',
	'WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP', 'DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP',
	'IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP', 'MOHNGAARP','MSHNGAARP','MTHNGAARP',
	'NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP', 'SCHNGAARP','SDHNGAARP',
	'TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY', 'ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP', 'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP',
	'MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP', 'SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP',
	'UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP', 'MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP',
	'FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

region_wp AS -- Regional Written Premium from MonthEnd
(
	SELECT CONCAT(GET_REGION_SCORECARD(STATE_ABBR),'Written Premium',BUS_UNIT_ABBR, CASE WHEN NEWCO_IND = 'Y' THEN 'Newco' ELSE 'nowco' END,'Total') as Key,
	zero_cond_scorecard(18, ME_DT, TERM_WRIT_PREM) AS "18",
	zero_cond_scorecard(17, ME_DT, TERM_WRIT_PREM) AS "17",
	zero_cond_scorecard(16, ME_DT, TERM_WRIT_PREM) AS "16",
	zero_cond_scorecard(15, ME_DT, TERM_WRIT_PREM) AS "15",
	zero_cond_scorecard(14, ME_DT, TERM_WRIT_PREM) AS "14",
	zero_cond_scorecard(13, ME_DT, TERM_WRIT_PREM) AS "13",
	zero_cond_scorecard(12, ME_DT, TERM_WRIT_PREM) AS "12",
	zero_cond_scorecard(11, ME_DT, TERM_WRIT_PREM) AS "11",
	zero_cond_scorecard(10, ME_DT, TERM_WRIT_PREM) AS "10",
	zero_cond_scorecard(9, ME_DT, TERM_WRIT_PREM) AS "9",
	zero_cond_scorecard(8, ME_DT, TERM_WRIT_PREM) AS "8",
	zero_cond_scorecard(7, ME_DT, TERM_WRIT_PREM) AS "7",
	zero_cond_scorecard(6, ME_DT, TERM_WRIT_PREM) AS "6",
	zero_cond_scorecard(5, ME_DT, TERM_WRIT_PREM) AS "5",
	zero_cond_scorecard(4, ME_DT, TERM_WRIT_PREM) AS "4",
	zero_cond_scorecard(3, ME_DT, TERM_WRIT_PREM) AS "3",
	zero_cond_scorecard(2, ME_DT, TERM_WRIT_PREM) AS "2",
	zero_cond_scorecard(1, ME_DT, TERM_WRIT_PREM) AS "1",
	zero_cond_scorecard(0, ME_DT, TERM_WRIT_PREM) AS "0",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."HOME_INFORCE_MONTHEND"
	WHERE CONCAT(STATE_ABBR,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY',  'MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY',
	'NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY', 'TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY',
	'WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP', 'DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP',
	'IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP', 'MOHNGAARP','MSHNGAARP','MTHNGAARP',
	'NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP', 'SCHNGAARP','SDHNGAARP',
	'TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY', 'ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP', 'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP',
	'MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP', 'SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP',
	'UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP', 'MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP',
	'FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

state_inforce_form_cd AS -- State Inforce Counts by Policy Form Code from MonthEnd
(
	SELECT CONCAT(STATE_ABBR,'Inforce',BUS_UNIT_ABBR, CASE WHEN NEWCO_IND ='Y' THEN 'Newco' ELSE 'nowco' END,
	CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
		 WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
		 ELSE 'Other' END) as Key,
	zero_cond_scorecard(18, ME_DT, POL_INFORCE_CNT) AS "18",
	zero_cond_scorecard(17, ME_DT, POL_INFORCE_CNT) AS "17",
	zero_cond_scorecard(16, ME_DT, POL_INFORCE_CNT) AS "16",
	zero_cond_scorecard(15, ME_DT, POL_INFORCE_CNT) AS "15",
	zero_cond_scorecard(14, ME_DT, POL_INFORCE_CNT) AS "14",
	zero_cond_scorecard(13, ME_DT, POL_INFORCE_CNT) AS "13",
	zero_cond_scorecard(12, ME_DT, POL_INFORCE_CNT) AS "12",
	zero_cond_scorecard(11, ME_DT, POL_INFORCE_CNT) AS "11",
	zero_cond_scorecard(10, ME_DT, POL_INFORCE_CNT) AS "10",
	zero_cond_scorecard(9, ME_DT, POL_INFORCE_CNT) AS "9",
	zero_cond_scorecard(8, ME_DT, POL_INFORCE_CNT) AS "8",
	zero_cond_scorecard(7, ME_DT, POL_INFORCE_CNT) AS "7",
	zero_cond_scorecard(6, ME_DT, POL_INFORCE_CNT) AS "6",
	zero_cond_scorecard(5, ME_DT, POL_INFORCE_CNT) AS "5",
	zero_cond_scorecard(4, ME_DT, POL_INFORCE_CNT) AS "4",
	zero_cond_scorecard(3, ME_DT, POL_INFORCE_CNT) AS "3",
	zero_cond_scorecard(2, ME_DT, POL_INFORCE_CNT) AS "2",
	zero_cond_scorecard(1, ME_DT, POL_INFORCE_CNT) AS "1",
	zero_cond_scorecard(0, ME_DT, POL_INFORCE_CNT) AS "0",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."HOME_INFORCE_MONTHEND"
	WHERE CONCAT(STATE_ABBR,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY',  'MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY',
	'NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY', 'TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY',
	'WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP', 'DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP',
	'IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP', 'MOHNGAARP','MSHNGAARP','MTHNGAARP',
	'NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP', 'SCHNGAARP','SDHNGAARP',
	'TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY', 'ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP', 'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP',
	'MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP', 'SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP',
	'UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP', 'MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP',
	'FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

region_inforce_form_cd AS -- Regional Inforce Counts by Policy Form Code from MonthEnd
(
	SELECT CONCAT(GET_REGION_SCORECARD(STATE_ABBR),'Inforce',BUS_UNIT_ABBR, CASE WHEN NEWCO_IND ='Y' THEN 'Newco' ELSE 'nowco' END,
	CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
		 WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
		 ELSE 'Other' END) as Key,
	zero_cond_scorecard(18, ME_DT, POL_INFORCE_CNT) AS "18",
	zero_cond_scorecard(17, ME_DT, POL_INFORCE_CNT) AS "17",
	zero_cond_scorecard(16, ME_DT, POL_INFORCE_CNT) AS "16",
	zero_cond_scorecard(15, ME_DT, POL_INFORCE_CNT) AS "15",
	zero_cond_scorecard(14, ME_DT, POL_INFORCE_CNT) AS "14",
	zero_cond_scorecard(13, ME_DT, POL_INFORCE_CNT) AS "13",
	zero_cond_scorecard(12, ME_DT, POL_INFORCE_CNT) AS "12",
	zero_cond_scorecard(11, ME_DT, POL_INFORCE_CNT) AS "11",
	zero_cond_scorecard(10, ME_DT, POL_INFORCE_CNT) AS "10",
	zero_cond_scorecard(9, ME_DT, POL_INFORCE_CNT) AS "9",
	zero_cond_scorecard(8, ME_DT, POL_INFORCE_CNT) AS "8",
	zero_cond_scorecard(7, ME_DT, POL_INFORCE_CNT) AS "7",
	zero_cond_scorecard(6, ME_DT, POL_INFORCE_CNT) AS "6",
	zero_cond_scorecard(5, ME_DT, POL_INFORCE_CNT) AS "5",
	zero_cond_scorecard(4, ME_DT, POL_INFORCE_CNT) AS "4",
	zero_cond_scorecard(3, ME_DT, POL_INFORCE_CNT) AS "3",
	zero_cond_scorecard(2, ME_DT, POL_INFORCE_CNT) AS "2",
	zero_cond_scorecard(1, ME_DT, POL_INFORCE_CNT) AS "1",
	zero_cond_scorecard(0, ME_DT, POL_INFORCE_CNT) AS "0",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."HOME_INFORCE_MONTHEND"
	WHERE CONCAT(STATE_ABBR,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY',  'MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY',
	'NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY', 'TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY',
	'WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP', 'DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP',
	'IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP', 'MOHNGAARP','MSHNGAARP','MTHNGAARP',
	'NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP', 'SCHNGAARP','SDHNGAARP',
	'TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY', 'ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP', 'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP',
	'MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP', 'SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP',
	'UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP', 'MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP',
	'FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

cw_inforce_form_cd AS -- CW Inforce Counts by Policy Form Code from MonthEnd
(
	SELECT CONCAT('CW','Inforce',BUS_UNIT_ABBR, CASE WHEN NEWCO_IND ='Y' THEN 'Newco' ELSE 'nowco' END,
	CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
		 WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
		 ELSE 'Other' END) as Key,
	zero_cond_scorecard(18, ME_DT, POL_INFORCE_CNT) AS "18",
	zero_cond_scorecard(17, ME_DT, POL_INFORCE_CNT) AS "17",
	zero_cond_scorecard(16, ME_DT, POL_INFORCE_CNT) AS "16",
	zero_cond_scorecard(15, ME_DT, POL_INFORCE_CNT) AS "15",
	zero_cond_scorecard(14, ME_DT, POL_INFORCE_CNT) AS "14",
	zero_cond_scorecard(13, ME_DT, POL_INFORCE_CNT) AS "13",
	zero_cond_scorecard(12, ME_DT, POL_INFORCE_CNT) AS "12",
	zero_cond_scorecard(11, ME_DT, POL_INFORCE_CNT) AS "11",
	zero_cond_scorecard(10, ME_DT, POL_INFORCE_CNT) AS "10",
	zero_cond_scorecard(9, ME_DT, POL_INFORCE_CNT) AS "9",
	zero_cond_scorecard(8, ME_DT, POL_INFORCE_CNT) AS "8",
	zero_cond_scorecard(7, ME_DT, POL_INFORCE_CNT) AS "7",
	zero_cond_scorecard(6, ME_DT, POL_INFORCE_CNT) AS "6",
	zero_cond_scorecard(5, ME_DT, POL_INFORCE_CNT) AS "5",
	zero_cond_scorecard(4, ME_DT, POL_INFORCE_CNT) AS "4",
	zero_cond_scorecard(3, ME_DT, POL_INFORCE_CNT) AS "3",
	zero_cond_scorecard(2, ME_DT, POL_INFORCE_CNT) AS "2",
	zero_cond_scorecard(1, ME_DT, POL_INFORCE_CNT) AS "1",
	zero_cond_scorecard(0, ME_DT, POL_INFORCE_CNT) AS "0",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."HOME_INFORCE_MONTHEND"
	WHERE CONCAT(STATE_ABBR,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY',  'MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY',
	'NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY', 'TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY',
	'WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP', 'DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP',
	'IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP', 'MOHNGAARP','MSHNGAARP','MTHNGAARP',
	'NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP', 'SCHNGAARP','SDHNGAARP',
	'TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY', 'ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP', 'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP',
	'MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP', 'SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP',
	'UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP', 'MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP',
	'FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

state_wp_form_cd AS -- State Written Premium by Policy Form Code from MonthEnd
(
	SELECT CONCAT(STATE_ABBR,'Written Premium',BUS_UNIT_ABBR, CASE WHEN NEWCO_IND ='Y' THEN 'Newco' ELSE 'nowco' END,
	CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
		 WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
		 ELSE 'Other' END) as Key,
	zero_cond_scorecard(18, ME_DT, TERM_WRIT_PREM) AS "18",
	zero_cond_scorecard(17, ME_DT, TERM_WRIT_PREM) AS "17",
	zero_cond_scorecard(16, ME_DT, TERM_WRIT_PREM) AS "16",
	zero_cond_scorecard(15, ME_DT, TERM_WRIT_PREM) AS "15",
	zero_cond_scorecard(14, ME_DT, TERM_WRIT_PREM) AS "14",
	zero_cond_scorecard(13, ME_DT, TERM_WRIT_PREM) AS "13",
	zero_cond_scorecard(12, ME_DT, TERM_WRIT_PREM) AS "12",
	zero_cond_scorecard(11, ME_DT, TERM_WRIT_PREM) AS "11",
	zero_cond_scorecard(10, ME_DT, TERM_WRIT_PREM) AS "10",
	zero_cond_scorecard(9, ME_DT, TERM_WRIT_PREM) AS "9",
	zero_cond_scorecard(8, ME_DT, TERM_WRIT_PREM) AS "8",
	zero_cond_scorecard(7, ME_DT, TERM_WRIT_PREM) AS "7",
	zero_cond_scorecard(6, ME_DT, TERM_WRIT_PREM) AS "6",
	zero_cond_scorecard(5, ME_DT, TERM_WRIT_PREM) AS "5",
	zero_cond_scorecard(4, ME_DT, TERM_WRIT_PREM) AS "4",
	zero_cond_scorecard(3, ME_DT, TERM_WRIT_PREM) AS "3",
	zero_cond_scorecard(2, ME_DT, TERM_WRIT_PREM) AS "2",
	zero_cond_scorecard(1, ME_DT, TERM_WRIT_PREM) AS "1",
	zero_cond_scorecard(0, ME_DT, TERM_WRIT_PREM) AS "0",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."HOME_INFORCE_MONTHEND"
	WHERE CONCAT(STATE_ABBR,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY',  'MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY',
	'NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY', 'TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY',
	'WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP', 'DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP',
	'IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP', 'MOHNGAARP','MSHNGAARP','MTHNGAARP',
	'NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP', 'SCHNGAARP','SDHNGAARP',
	'TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY', 'ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP', 'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP',
	'MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP', 'SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP',
	'UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP', 'MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP',
	'FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

cw_wp_form_cd AS -- CW Written Premium by Policy Form Code from MonthEnd
(
	SELECT CONCAT('CW','Written Premium',BUS_UNIT_ABBR, CASE WHEN NEWCO_IND ='Y' THEN 'Newco' ELSE 'nowco' END,
	CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
		 WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
		 ELSE 'Other' END) as Key,
	zero_cond_scorecard(18, ME_DT, TERM_WRIT_PREM) AS "18",
	zero_cond_scorecard(17, ME_DT, TERM_WRIT_PREM) AS "17",
	zero_cond_scorecard(16, ME_DT, TERM_WRIT_PREM) AS "16",
	zero_cond_scorecard(15, ME_DT, TERM_WRIT_PREM) AS "15",
	zero_cond_scorecard(14, ME_DT, TERM_WRIT_PREM) AS "14",
	zero_cond_scorecard(13, ME_DT, TERM_WRIT_PREM) AS "13",
	zero_cond_scorecard(12, ME_DT, TERM_WRIT_PREM) AS "12",
	zero_cond_scorecard(11, ME_DT, TERM_WRIT_PREM) AS "11",
	zero_cond_scorecard(10, ME_DT, TERM_WRIT_PREM) AS "10",
	zero_cond_scorecard(9, ME_DT, TERM_WRIT_PREM) AS "9",
	zero_cond_scorecard(8, ME_DT, TERM_WRIT_PREM) AS "8",
	zero_cond_scorecard(7, ME_DT, TERM_WRIT_PREM) AS "7",
	zero_cond_scorecard(6, ME_DT, TERM_WRIT_PREM) AS "6",
	zero_cond_scorecard(5, ME_DT, TERM_WRIT_PREM) AS "5",
	zero_cond_scorecard(4, ME_DT, TERM_WRIT_PREM) AS "4",
	zero_cond_scorecard(3, ME_DT, TERM_WRIT_PREM) AS "3",
	zero_cond_scorecard(2, ME_DT, TERM_WRIT_PREM) AS "2",
	zero_cond_scorecard(1, ME_DT, TERM_WRIT_PREM) AS "1",
	zero_cond_scorecard(0, ME_DT, TERM_WRIT_PREM) AS "0",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."HOME_INFORCE_MONTHEND"
	WHERE CONCAT(STATE_ABBR,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY',  'MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY',
	'NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY', 'TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY',
	'WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP', 'DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP',
	'IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP', 'MOHNGAARP','MSHNGAARP','MTHNGAARP',
	'NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP', 'SCHNGAARP','SDHNGAARP',
	'TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY', 'ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP', 'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP',
	'MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP', 'SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP',
	'UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP', 'MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP',
	'FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
),

region_wp_form_cd AS -- Regional Written Premium by Policy Form Code from MonthEnd
(
	SELECT CONCAT(GET_REGION_SCORECARD(STATE_ABBR),'Written Premium',BUS_UNIT_ABBR, CASE WHEN NEWCO_IND ='Y' THEN 'Newco' ELSE 'nowco' END,
	CASE WHEN POL_FORM_CD IN ('HO3','HO5','3','5','HO7') THEN 'Bldg'
		 WHEN POL_FORM_CD IN ('HO4','HO6','4','6') THEN 'T/C'
		 ELSE 'Other' END) as Key,
	zero_cond_scorecard(18, ME_DT, TERM_WRIT_PREM) AS "18",
	zero_cond_scorecard(17, ME_DT, TERM_WRIT_PREM) AS "17",
	zero_cond_scorecard(16, ME_DT, TERM_WRIT_PREM) AS "16",
	zero_cond_scorecard(15, ME_DT, TERM_WRIT_PREM) AS "15",
	zero_cond_scorecard(14, ME_DT, TERM_WRIT_PREM) AS "14",
	zero_cond_scorecard(13, ME_DT, TERM_WRIT_PREM) AS "13",
	zero_cond_scorecard(12, ME_DT, TERM_WRIT_PREM) AS "12",
	zero_cond_scorecard(11, ME_DT, TERM_WRIT_PREM) AS "11",
	zero_cond_scorecard(10, ME_DT, TERM_WRIT_PREM) AS "10",
	zero_cond_scorecard(9, ME_DT, TERM_WRIT_PREM) AS "9",
	zero_cond_scorecard(8, ME_DT, TERM_WRIT_PREM) AS "8",
	zero_cond_scorecard(7, ME_DT, TERM_WRIT_PREM) AS "7",
	zero_cond_scorecard(6, ME_DT, TERM_WRIT_PREM) AS "6",
	zero_cond_scorecard(5, ME_DT, TERM_WRIT_PREM) AS "5",
	zero_cond_scorecard(4, ME_DT, TERM_WRIT_PREM) AS "4",
	zero_cond_scorecard(3, ME_DT, TERM_WRIT_PREM) AS "3",
	zero_cond_scorecard(2, ME_DT, TERM_WRIT_PREM) AS "2",
	zero_cond_scorecard(1, ME_DT, TERM_WRIT_PREM) AS "1",
	zero_cond_scorecard(0, ME_DT, TERM_WRIT_PREM) AS "0",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."HOME_INFORCE_MONTHEND"
	WHERE CONCAT(STATE_ABBR,RATE_PLAN_CD,BUS_UNIT_ABBR) IN ('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY',
	'IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY',  'MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY',
	'NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY', 'TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY',
	'WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP', 'DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP',
	'IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP', 'MOHNGAARP','MSHNGAARP','MTHNGAARP',
	'NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP', 'SCHNGAARP','SDHNGAARP',
	'TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY', 'ALHPRVAARP','ARHPRVAARP',
	'AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP', 'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP',
	'MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP', 'SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP',
	'UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP', 'MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP',
	'FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP')
	GROUP BY Key
)

SELECT * FROM
(
	SELECT * FROM state_e_30
	UNION ALL
	SELECT * FROM state_e_0
	UNION ALL
	SELECT * FROM state_e_ult
	UNION ALL
	SELECT * FROM state_prem_change
	UNION ALL
	SELECT * FROM state_e_30_form_cd
	UNION ALL
	SELECT * FROM state_e_0_form_cd
	UNION ALL
	SELECT * FROM state_e_ult_form_cd
	UNION ALL
	SELECT * FROM state_prem_change_form_cd
	UNION ALL
	SELECT * FROM cw_e_30
	UNION ALL
	SELECT * FROM cw_e_0
	UNION ALL
	SELECT * FROM cw_e_ult
	UNION ALL
	SELECT * FROM cw_prem_change
	UNION ALL
	SELECT * FROM cw_e_30_form_cd
	UNION ALL
	SELECT * FROM cw_e_0_form_cd
	UNION ALL
	SELECT * FROM cw_e_ult_form_cd
	UNION ALL
	SELECT * FROM cw_prem_change_form_cd
	UNION ALL
	SELECT * FROM region_e_30
	UNION ALL
	SELECT * FROM region_e_0
	UNION ALL
	SELECT * FROM region_e_ult
	UNION ALL
	SELECT * FROM region_prem_change
	UNION ALL
	SELECT * FROM region_e_30_form_cd
	UNION ALL
	SELECT * FROM region_e_0_form_cd
	UNION ALL
	SELECT * FROM region_e_ult_form_cd
	UNION ALL
	SELECT * FROM region_prem_change_form_cd
	UNION ALL
	SELECT * FROM state_inforce
	UNION ALL
	SELECT * FROM region_inforce
	UNION ALL
	SELECT * FROM cw_inforce
	UNION ALL
	SELECT * FROM state_wp
	UNION ALL
	SELECT * FROM cw_wp
	UNION ALL
	SELECT * FROM region_wp
	UNION ALL
	SELECT * FROM state_inforce_form_cd
	UNION ALL
	SELECT * FROM region_inforce_form_cd
	UNION ALL
	SELECT * FROM cw_inforce_form_cd
	UNION ALL
	SELECT * FROM state_wp_form_cd
	UNION ALL
	SELECT * FROM cw_wp_form_cd
	UNION ALL
	SELECT * FROM region_wp_form_cd
)
ORDER BY KEY;