WITH acct_credit AS -- State Segmentation by Account Credit
(
	SELECT CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR,'Account Credit',ACCT_CR_IND,'Total') as Key,
	-- Response
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "12 Response",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "11 Response",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "10 Response",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "09 Response",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "08 Response",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "07 Response",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "06 Response",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "05 Response",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "04 Response",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "03 Response",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "02 Response",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "01 Response",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "00 Response",
	-- Completed Quote
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "12 CQ",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "11 CQ",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "10 CQ",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "09 CQ",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "08 CQ",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "07 CQ",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "06 CQ",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "05 CQ",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "04 CQ",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "03 CQ",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "02 CQ",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "01 CQ",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "00 CQ",
    -- Issue
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "12 Issue",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "11 Issue",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "10 Issue",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "09 Issue",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "08 Issue",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "07 Issue",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "06 Issue",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "05 Issue",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "04 Issue",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "03 Issue",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "02 Issue",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "01 Issue",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "00 Issue",
    -- AQP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AQP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AQP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AQP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AQP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AQP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AQP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AQP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AQP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AQP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AQP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AQP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AQP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AQP",
	-- AIP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AIP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AIP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AIP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AIP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AIP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AIP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AIP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AIP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AIP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AIP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AIP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AIP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AIP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"
	WHERE POL_FORM_CD IS NOT NULL AND BUS_UNIT_ABBR <> 'CDRT'
	AND CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR) NOT IN ('PAAARP','GAAARP','SDAARP','MEAARP','CTAARP','NJAARP','RIAARP','OHAARP','KYAARP','TXAARP','LAAARP','ALAARP','AZAARP',
	'ORAARP','MDAARP','INAARP','IAAARP','KSAARP','VTAARP','NMAARP','CAAARP','DEAARP','WVAARP','FLAARP','ILAARP','COAARP','SCAARP','IDAARP','TNAARP','ARAARP','UTAARP',
	'NEAARP','NHAARP','NDAARP','WIAARP','MNAARP','WYAARP','MOAARP','MSAARP')
	GROUP BY Key
),

prot_class AS -- State Segmentation by Protection Class
(
	SELECT CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR,'Protection Class',(
	CASE WHEN PROTECTION_CLASS_PT1_CD IN ('1','2','3','4','01','02','03','04') THEN '1-4'
		 WHEN PROTECTION_CLASS_PT1_CD IN ('5','05') THEN '5'
		 WHEN PROTECTION_CLASS_PT1_CD IN ('6','06') THEN '6'
		 WHEN PROTECTION_CLASS_PT1_CD IN ('7','07') THEN '7'
		 WHEN PROTECTION_CLASS_PT1_CD IN ('8','9','08','09') THEN '8-9'
		 WHEN PROTECTION_CLASS_PT1_CD IN ('10C','10','10W') THEN '10'
		 WHEN PROTECTION_CLASS_PT1_CD IN ('1/','1X','1Y','2/','26','2X','2Y','3/','3X','3Y','4/','4B','4X','4Y','5/','5X','5Y',
		 '6/','6X','6Y','7/','7X','7Y','8A','8B','9A','9E','9S') THEN 'Split'
		 ELSE 'Other' END),'Total') as Key,
	-- Response
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "12 Response",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "11 Response",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "10 Response",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "09 Response",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "08 Response",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "07 Response",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "06 Response",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "05 Response",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "04 Response",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "03 Response",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "02 Response",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "01 Response",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "00 Response",
	-- Completed Quote
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "12 CQ",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "11 CQ",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "10 CQ",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "09 CQ",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "08 CQ",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "07 CQ",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "06 CQ",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "05 CQ",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "04 CQ",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "03 CQ",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "02 CQ",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "01 CQ",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "00 CQ",
    -- Issue
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "12 Issue",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "11 Issue",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "10 Issue",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "09 Issue",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "08 Issue",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "07 Issue",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "06 Issue",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "05 Issue",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "04 Issue",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "03 Issue",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "02 Issue",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "01 Issue",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "00 Issue",
    -- AQP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AQP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AQP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AQP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AQP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AQP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AQP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AQP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AQP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AQP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AQP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AQP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AQP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AQP",
	-- AIP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AIP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AIP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AIP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AIP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AIP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AIP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AIP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AIP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AIP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AIP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AIP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AIP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AIP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"
	WHERE POL_FORM_CD IS NOT NULL AND BUS_UNIT_ABBR <> 'CDRT'
	AND CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR) NOT IN ('PAAARP','GAAARP','SDAARP','MEAARP','CTAARP','NJAARP','RIAARP','OHAARP','KYAARP','TXAARP','LAAARP','ALAARP','AZAARP',
	'ORAARP','MDAARP','INAARP','IAAARP','KSAARP','VTAARP','NMAARP','CAAARP','DEAARP','WVAARP','FLAARP','ILAARP','COAARP','SCAARP','IDAARP','TNAARP','ARAARP','UTAARP',
	'NEAARP','NHAARP','NDAARP','WIAARP','MNAARP','WYAARP','MOAARP','MSAARP')
	GROUP BY Key
),

ins_score_decile AS -- State Segmentation by Ins Score Decile
(
	SELECT CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR,'Insurance Score Decile',(
	CASE WHEN INS_SCR_DECILE_QUOTE_CW = 'UKWN' THEN 'NH/NS'
		 ELSE INS_SCR_DECILE_QUOTE_CW END),'Total') as Key,
	-- Response
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "12 Response",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "11 Response",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "10 Response",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "09 Response",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "08 Response",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "07 Response",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "06 Response",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "05 Response",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "04 Response",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "03 Response",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "02 Response",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "01 Response",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "00 Response",
	-- Completed Quote
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "12 CQ",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "11 CQ",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "10 CQ",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "09 CQ",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "08 CQ",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "07 CQ",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "06 CQ",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "05 CQ",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "04 CQ",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "03 CQ",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "02 CQ",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "01 CQ",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "00 CQ",
    -- Issue
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "12 Issue",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "11 Issue",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "10 Issue",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "09 Issue",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "08 Issue",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "07 Issue",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "06 Issue",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "05 Issue",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "04 Issue",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "03 Issue",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "02 Issue",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "01 Issue",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "00 Issue",
    -- AQP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AQP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AQP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AQP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AQP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AQP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AQP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AQP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AQP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AQP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AQP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AQP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AQP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AQP",
	-- AIP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AIP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AIP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AIP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AIP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AIP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AIP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AIP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AIP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AIP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AIP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AIP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AIP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AIP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"
	WHERE POL_FORM_CD IS NOT NULL AND BUS_UNIT_ABBR <> 'CDRT'
	AND CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR) NOT IN ('PAAARP','GAAARP','SDAARP','MEAARP','CTAARP','NJAARP','RIAARP','OHAARP','KYAARP','TXAARP','LAAARP','ALAARP','AZAARP',
	'ORAARP','MDAARP','INAARP','IAAARP','KSAARP','VTAARP','NMAARP','CAAARP','DEAARP','WVAARP','FLAARP','ILAARP','COAARP','SCAARP','IDAARP','TNAARP','ARAARP','UTAARP',
	'NEAARP','NHAARP','NDAARP','WIAARP','MNAARP','WYAARP','MOAARP','MSAARP')
	GROUP BY Key
),

ins_age_grp AS -- State Segmentation by Insured Age Group
(
	SELECT CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR,'Insured Age Group',(
	CASE WHEN INSURED_AGE = 'UNK' THEN 'j. null'
		 WHEN INSURED_AGE <= 24 THEN 'a. 0-24' 
		 WHEN INSURED_AGE <= 49 THEN 'b. 25-49' 
		 WHEN INSURED_AGE <= 54 THEN 'c. 50-54' 
		 WHEN INSURED_AGE <= 59 THEN 'd. 55-59' 
		 WHEN INSURED_AGE <= 64 THEN 'e. 60-64' 
		 WHEN INSURED_AGE <= 69 THEN 'f. 65-69' 
		 WHEN INSURED_AGE <= 74 THEN 'g. 70-74' 
		 WHEN INSURED_AGE <= 79 THEN 'h. 75-79' 
		 WHEN INSURED_AGE <= 120 THEN 'i. 80+'
		 ELSE 'j. null' END),'Total') as Key,
	-- Response
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "12 Response",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "11 Response",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "10 Response",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "09 Response",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "08 Response",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "07 Response",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "06 Response",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "05 Response",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "04 Response",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "03 Response",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "02 Response",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "01 Response",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "00 Response",
	-- Completed Quote
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "12 CQ",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "11 CQ",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "10 CQ",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "09 CQ",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "08 CQ",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "07 CQ",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "06 CQ",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "05 CQ",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "04 CQ",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "03 CQ",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "02 CQ",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "01 CQ",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "00 CQ",
    -- Issue
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "12 Issue",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "11 Issue",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "10 Issue",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "09 Issue",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "08 Issue",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "07 Issue",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "06 Issue",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "05 Issue",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "04 Issue",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "03 Issue",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "02 Issue",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "01 Issue",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "00 Issue",
    -- AQP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AQP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AQP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AQP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AQP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AQP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AQP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AQP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AQP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AQP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AQP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AQP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AQP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AQP",
	-- AIP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AIP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AIP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AIP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AIP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AIP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AIP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AIP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AIP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AIP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AIP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AIP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AIP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AIP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"
	WHERE POL_FORM_CD IS NOT NULL AND BUS_UNIT_ABBR <> 'CDRT'
	AND CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR) NOT IN ('PAAARP','GAAARP','SDAARP','MEAARP','CTAARP','NJAARP','RIAARP','OHAARP','KYAARP','TXAARP','LAAARP','ALAARP','AZAARP',
	'ORAARP','MDAARP','INAARP','IAAARP','KSAARP','VTAARP','NMAARP','CAAARP','DEAARP','WVAARP','FLAARP','ILAARP','COAARP','SCAARP','IDAARP','TNAARP','ARAARP','UTAARP',
	'NEAARP','NHAARP','NDAARP','WIAARP','MNAARP','WYAARP','MOAARP','MSAARP')
	GROUP BY Key
),

household_memb_cnt AS -- State Segmentation by Household Member Count
(
	SELECT CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR,'Household Member Count',(
	CASE WHEN HH_MEMBER_CNT = 0 THEN '0'
		 WHEN HH_MEMBER_CNT = '1' THEN '1'
		 WHEN HH_MEMBER_CNT = '2' THEN '2'
		 WHEN HH_MEMBER_CNT = '3' THEN '3'
		 WHEN HH_MEMBER_CNT > 3 and HH_MEMBER_CNT <= 50
		 THEN '4+' ELSE 'other' END),'Total') as Key,
	-- Response
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "12 Response",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "11 Response",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "10 Response",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "09 Response",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "08 Response",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "07 Response",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "06 Response",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "05 Response",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "04 Response",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "03 Response",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "02 Response",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "01 Response",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "00 Response",
	-- Completed Quote
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "12 CQ",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "11 CQ",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "10 CQ",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "09 CQ",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "08 CQ",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "07 CQ",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "06 CQ",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "05 CQ",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "04 CQ",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "03 CQ",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "02 CQ",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "01 CQ",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "00 CQ",
    -- Issue
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "12 Issue",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "11 Issue",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "10 Issue",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "09 Issue",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "08 Issue",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "07 Issue",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "06 Issue",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "05 Issue",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "04 Issue",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "03 Issue",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "02 Issue",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "01 Issue",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "00 Issue",
    -- AQP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AQP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AQP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AQP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AQP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AQP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AQP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AQP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AQP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AQP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AQP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AQP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AQP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AQP",
	-- AIP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AIP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AIP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AIP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AIP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AIP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AIP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AIP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AIP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AIP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AIP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AIP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AIP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AIP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"
	WHERE POL_FORM_CD IS NOT NULL AND BUS_UNIT_ABBR <> 'CDRT'
	AND CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR) NOT IN ('PAAARP','GAAARP','SDAARP','MEAARP','CTAARP','NJAARP','RIAARP','OHAARP','KYAARP','TXAARP','LAAARP','ALAARP','AZAARP',
	'ORAARP','MDAARP','INAARP','IAAARP','KSAARP','VTAARP','NMAARP','CAAARP','DEAARP','WVAARP','FLAARP','ILAARP','COAARP','SCAARP','IDAARP','TNAARP','ARAARP','UTAARP',
	'NEAARP','NHAARP','NDAARP','WIAARP','MNAARP','WYAARP','MOAARP','MSAARP')
	GROUP BY Key
),

aarp_member_status AS -- State Segmentation by AARP member status
(
	SELECT CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR,' AARP Member Status',(
	CASE WHEN AARP_MEMBER_IND = 'Y' THEN 'Member'
		 ELSE 'Non Member' END),'Total') as Key,
	-- Response
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "12 Response",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "11 Response",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "10 Response",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "09 Response",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "08 Response",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "07 Response",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "06 Response",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "05 Response",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "04 Response",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "03 Response",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "02 Response",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "01 Response",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "00 Response",
	-- Completed Quote
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "12 CQ",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "11 CQ",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "10 CQ",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "09 CQ",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "08 CQ",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "07 CQ",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "06 CQ",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "05 CQ",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "04 CQ",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "03 CQ",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "02 CQ",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "01 CQ",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "00 CQ",
    -- Issue
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "12 Issue",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "11 Issue",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "10 Issue",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "09 Issue",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "08 Issue",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "07 Issue",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "06 Issue",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "05 Issue",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "04 Issue",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "03 Issue",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "02 Issue",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "01 Issue",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "00 Issue",
    -- AQP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AQP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AQP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AQP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AQP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AQP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AQP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AQP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AQP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AQP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AQP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AQP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AQP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AQP",
	-- AIP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AIP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AIP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AIP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AIP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AIP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AIP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AIP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AIP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AIP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AIP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AIP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AIP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AIP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"
	WHERE POL_FORM_CD IS NOT NULL AND BUS_UNIT_ABBR <> 'CDRT'
	AND CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR) NOT IN ('PAAARP','GAAARP','SDAARP','MEAARP','CTAARP','NJAARP','RIAARP','OHAARP','KYAARP','TXAARP','LAAARP','ALAARP','AZAARP',
	'ORAARP','MDAARP','INAARP','IAAARP','KSAARP','VTAARP','NMAARP','CAAARP','DEAARP','WVAARP','FLAARP','ILAARP','COAARP','SCAARP','IDAARP','TNAARP','ARAARP','UTAARP',
	'NEAARP','NHAARP','NDAARP','WIAARP','MNAARP','WYAARP','MOAARP','MSAARP')
	GROUP BY Key
),

aarp_member_years AS -- State Segmentation by AARP member years
(
	SELECT CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR,'AARP Member Years',(
	CASE WHEN AARP_MEMBERSHIP_DAY_CNT = '0' THEN 'A. 0 Days'
		 WHEN AARP_MEMBERSHIP_DAY_CNT <= 364 THEN 'B. Less than 1 year'
		 WHEN AARP_MEMBERSHIP_DAY_CNT <= 1824 THEN 'C. 1-4 years'
		 WHEN AARP_MEMBERSHIP_DAY_CNT <= 3649 THEN 'D. 5-9 years'
		 WHEN AARP_MEMBERSHIP_DAY_CNT <= 5474 THEN 'E. 10-14 years'
		 WHEN AARP_MEMBERSHIP_DAY_CNT <= 7299 THEN 'F. 15-19 years'
		 WHEN AARP_MEMBERSHIP_DAY_CNT <= 9124 THEN 'G. 20-24 years'
		 WHEN AARP_MEMBERSHIP_DAY_CNT <= 10949 THEN 'H. 25-29 years'
		 WHEN AARP_MEMBERSHIP_DAY_CNT <= 85000 THEN 'I. 30+ years'
		 ELSE 'A. 0 Days' END),'Total') as Key,
	-- Response
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "12 Response",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "11 Response",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "10 Response",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "09 Response",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "08 Response",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "07 Response",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "06 Response",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "05 Response",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "04 Response",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "03 Response",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "02 Response",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "01 Response",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "00 Response",
	-- Completed Quote
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "12 CQ",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "11 CQ",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "10 CQ",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "09 CQ",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "08 CQ",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "07 CQ",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "06 CQ",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "05 CQ",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "04 CQ",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "03 CQ",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "02 CQ",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "01 CQ",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "00 CQ",
    -- Issue
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "12 Issue",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "11 Issue",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "10 Issue",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "09 Issue",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "08 Issue",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "07 Issue",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "06 Issue",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "05 Issue",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "04 Issue",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "03 Issue",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "02 Issue",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "01 Issue",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "00 Issue",
    -- AQP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AQP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AQP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AQP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AQP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AQP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AQP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AQP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AQP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AQP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AQP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AQP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AQP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AQP",
	-- AIP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AIP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AIP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AIP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AIP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AIP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AIP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AIP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AIP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AIP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AIP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AIP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AIP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AIP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"
	WHERE POL_FORM_CD IS NOT NULL AND BUS_UNIT_ABBR <> 'CDRT'
	AND CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR) NOT IN ('PAAARP','GAAARP','SDAARP','MEAARP','CTAARP','NJAARP','RIAARP','OHAARP','KYAARP','TXAARP','LAAARP','ALAARP','AZAARP',
	'ORAARP','MDAARP','INAARP','IAAARP','KSAARP','VTAARP','NMAARP','CAAARP','DEAARP','WVAARP','FLAARP','ILAARP','COAARP','SCAARP','IDAARP','TNAARP','ARAARP','UTAARP',
	'NEAARP','NHAARP','NDAARP','WIAARP','MNAARP','WYAARP','MOAARP','MSAARP')
	GROUP BY Key
),

mortgage_count AS -- State Segmentation by Mortgagee Count
(
	SELECT CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR,'Mortgage Count',(
	CASE WHEN MORTGAGEE_CNT = '0' THEN '0'
		 WHEN MORTGAGEE_CNT = 1 THEN '1'
		 WHEN MORTGAGEE_CNT >= 2 THEN '2+'
		 ELSE 'Unknown' END),'Total') as Key,
	-- Response
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "12 Response",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "11 Response",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "10 Response",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "09 Response",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "08 Response",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "07 Response",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "06 Response",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "05 Response",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "04 Response",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "03 Response",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "02 Response",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "01 Response",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "00 Response",
	-- Completed Quote
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "12 CQ",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "11 CQ",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "10 CQ",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "09 CQ",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "08 CQ",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "07 CQ",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "06 CQ",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "05 CQ",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "04 CQ",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "03 CQ",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "02 CQ",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "01 CQ",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "00 CQ",
    -- Issue
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "12 Issue",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "11 Issue",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "10 Issue",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "09 Issue",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "08 Issue",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "07 Issue",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "06 Issue",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "05 Issue",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "04 Issue",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "03 Issue",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "02 Issue",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "01 Issue",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "00 Issue",
    -- AQP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AQP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AQP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AQP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AQP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AQP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AQP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AQP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AQP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AQP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AQP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AQP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AQP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AQP",
	-- AIP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AIP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AIP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AIP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AIP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AIP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AIP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AIP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AIP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AIP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AIP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AIP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AIP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AIP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"
	WHERE POL_FORM_CD IS NOT NULL AND BUS_UNIT_ABBR <> 'CDRT'
	AND CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR) NOT IN ('PAAARP','GAAARP','SDAARP','MEAARP','CTAARP','NJAARP','RIAARP','OHAARP','KYAARP','TXAARP','LAAARP','ALAARP','AZAARP',
	'ORAARP','MDAARP','INAARP','IAAARP','KSAARP','VTAARP','NMAARP','CAAARP','DEAARP','WVAARP','FLAARP','ILAARP','COAARP','SCAARP','IDAARP','TNAARP','ARAARP','UTAARP',
	'NEAARP','NHAARP','NDAARP','WIAARP','MNAARP','WYAARP','MOAARP','MSAARP')
	GROUP BY Key
),

prior_cat_clm AS -- State Segmentation by Prior CAT Claim Count
(
	SELECT CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR,'Prior CAT Claim Count',(
	CASE WHEN PRIOR_CAT_CLM_CNT = '0' THEN 'None'
		 WHEN PRIOR_CAT_CLM_CNT = 1 THEN '1'
		 WHEN PRIOR_CAT_CLM_CNT >= 2 THEN '2+'
		 ELSE 'Unknown' END),'Total') as Key,
	-- Response
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "12 Response",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "11 Response",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "10 Response",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "09 Response",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "08 Response",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "07 Response",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "06 Response",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "05 Response",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "04 Response",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "03 Response",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "02 Response",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "01 Response",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "00 Response",
	-- Completed Quote
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "12 CQ",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "11 CQ",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "10 CQ",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "09 CQ",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "08 CQ",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "07 CQ",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "06 CQ",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "05 CQ",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "04 CQ",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "03 CQ",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "02 CQ",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "01 CQ",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "00 CQ",
    -- Issue
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "12 Issue",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "11 Issue",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "10 Issue",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "09 Issue",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "08 Issue",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "07 Issue",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "06 Issue",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "05 Issue",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "04 Issue",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "03 Issue",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "02 Issue",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "01 Issue",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "00 Issue",
    -- AQP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AQP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AQP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AQP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AQP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AQP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AQP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AQP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AQP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AQP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AQP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AQP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AQP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AQP",
	-- AIP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AIP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AIP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AIP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AIP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AIP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AIP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AIP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AIP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AIP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AIP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AIP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AIP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AIP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"
	WHERE POL_FORM_CD IS NOT NULL AND BUS_UNIT_ABBR <> 'CDRT'
	AND CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR) NOT IN ('PAAARP','GAAARP','SDAARP','MEAARP','CTAARP','NJAARP','RIAARP','OHAARP','KYAARP','TXAARP','LAAARP','ALAARP','AZAARP',
	'ORAARP','MDAARP','INAARP','IAAARP','KSAARP','VTAARP','NMAARP','CAAARP','DEAARP','WVAARP','FLAARP','ILAARP','COAARP','SCAARP','IDAARP','TNAARP','ARAARP','UTAARP',
	'NEAARP','NHAARP','NDAARP','WIAARP','MNAARP','WYAARP','MOAARP','MSAARP')
	GROUP BY Key
),

prior_xcat_clm AS -- State Segmentation by Prior xCAT Claim Count
(
	SELECT CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR,'Prior xCAT Claim Count',(
	CASE WHEN PRIOR_LOSS_XCAT_CNT= '0' THEN 'None'
		 WHEN PRIOR_LOSS_XCAT_CNT = 1 THEN '1'
		 WHEN PRIOR_LOSS_XCAT_CNT >= 2  THEN '2+'
		 ELSE 'Unknown' END),'Total') as Key,
	-- Response
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "12 Response",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "11 Response",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "10 Response",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "09 Response",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "08 Response",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "07 Response",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "06 Response",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "05 Response",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "04 Response",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "03 Response",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "02 Response",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "01 Response",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "00 Response",
	-- Completed Quote
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "12 CQ",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "11 CQ",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "10 CQ",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "09 CQ",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "08 CQ",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "07 CQ",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "06 CQ",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "05 CQ",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "04 CQ",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "03 CQ",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "02 CQ",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "01 CQ",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "00 CQ",
    -- Issue
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "12 Issue",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "11 Issue",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "10 Issue",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "09 Issue",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "08 Issue",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "07 Issue",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "06 Issue",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "05 Issue",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "04 Issue",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "03 Issue",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "02 Issue",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "01 Issue",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "00 Issue",
    -- AQP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AQP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AQP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AQP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AQP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AQP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AQP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AQP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AQP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AQP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AQP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AQP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AQP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AQP",
	-- AIP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AIP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AIP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AIP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AIP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AIP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AIP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AIP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AIP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AIP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AIP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AIP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AIP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AIP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"
	WHERE POL_FORM_CD IS NOT NULL AND BUS_UNIT_ABBR <> 'CDRT'
	AND CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR) NOT IN ('PAAARP','GAAARP','SDAARP','MEAARP','CTAARP','NJAARP','RIAARP','OHAARP','KYAARP','TXAARP','LAAARP','ALAARP','AZAARP',
	'ORAARP','MDAARP','INAARP','IAAARP','KSAARP','VTAARP','NMAARP','CAAARP','DEAARP','WVAARP','FLAARP','ILAARP','COAARP','SCAARP','IDAARP','TNAARP','ARAARP','UTAARP',
	'NEAARP','NHAARP','NDAARP','WIAARP','MNAARP','WYAARP','MOAARP','MSAARP')
	GROUP BY Key
),

state_deduc AS -- State Segmentation by Deductible Amount
(
	SELECT CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR,'Deductible',(
	CASE WHEN HOME_BASIC_DEDUC_AMT IN ('500','0') THEN 'a Less than 1000'
		 WHEN HOME_BASIC_DEDUC_AMT IN ('1000','1500') THEN 'b 1000-1500'
		 WHEN HOME_BASIC_DEDUC_AMT IN ('2000','2500') THEN 'c 2000-2500'
		 WHEN HOME_BASIC_DEDUC_AMT IN ('3000','4000','5000','7500','10000') THEN 'd. 3000'
		 WHEN DED_TYPE_CD = '2' THEN 'e. 1.0%'
		 WHEN DED_TYPE_CD IN ('3','4','5','6','7','8') THEN 'f. 1.5%'
		 ELSE 'g. other' END),'Total') as Key,
	-- Response
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "12 Response",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "11 Response",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "10 Response",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "09 Response",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "08 Response",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "07 Response",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "06 Response",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "05 Response",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "04 Response",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "03 Response",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "02 Response",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "01 Response",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "00 Response",
	-- Completed Quote
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "12 CQ",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "11 CQ",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "10 CQ",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "09 CQ",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "08 CQ",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "07 CQ",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "06 CQ",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "05 CQ",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "04 CQ",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "03 CQ",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "02 CQ",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "01 CQ",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "00 CQ",
    -- Issue
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "12 Issue",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "11 Issue",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "10 Issue",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "09 Issue",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "08 Issue",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "07 Issue",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "06 Issue",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "05 Issue",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "04 Issue",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "03 Issue",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "02 Issue",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "01 Issue",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "00 Issue",
    -- AQP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AQP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AQP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AQP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AQP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AQP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AQP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AQP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AQP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AQP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AQP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AQP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AQP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AQP",
	-- AIP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AIP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AIP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AIP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AIP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AIP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AIP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AIP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AIP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AIP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AIP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AIP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AIP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AIP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"
	WHERE POL_FORM_CD IS NOT NULL AND BUS_UNIT_ABBR <> 'CDRT'
	AND CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR) NOT IN ('PAAARP','GAAARP','SDAARP','MEAARP','CTAARP','NJAARP','RIAARP','OHAARP','KYAARP','TXAARP','LAAARP','ALAARP','AZAARP',
	'ORAARP','MDAARP','INAARP','IAAARP','KSAARP','VTAARP','NMAARP','CAAARP','DEAARP','WVAARP','FLAARP','ILAARP','COAARP','SCAARP','IDAARP','TNAARP','ARAARP','UTAARP',
	'NEAARP','NHAARP','NDAARP','WIAARP','MNAARP','WYAARP','MOAARP','MSAARP')
	GROUP BY Key
),

wind_deduc AS -- State Segmentation by Wind Deductible
(
	SELECT CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR,'Wind Deductible',WIND_HAIL_DED_DESC,'Total') as Key,
	-- Response
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "12 Response",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "11 Response",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "10 Response",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "09 Response",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "08 Response",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "07 Response",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "06 Response",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "05 Response",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "04 Response",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "03 Response",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "02 Response",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "01 Response",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "00 Response",
	-- Completed Quote
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "12 CQ",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "11 CQ",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "10 CQ",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "09 CQ",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "08 CQ",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "07 CQ",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "06 CQ",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "05 CQ",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "04 CQ",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "03 CQ",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "02 CQ",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "01 CQ",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "00 CQ",
    -- Issue
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "12 Issue",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "11 Issue",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "10 Issue",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "09 Issue",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "08 Issue",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "07 Issue",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "06 Issue",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "05 Issue",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "04 Issue",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "03 Issue",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "02 Issue",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "01 Issue",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "00 Issue",
    -- AQP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AQP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AQP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AQP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AQP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AQP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AQP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AQP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AQP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AQP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AQP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AQP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AQP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AQP",
	-- AIP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AIP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AIP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AIP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AIP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AIP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AIP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AIP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AIP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AIP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AIP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AIP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AIP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AIP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"
	WHERE POL_FORM_CD IS NOT NULL AND BUS_UNIT_ABBR <> 'CDRT'
	AND CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR) NOT IN ('PAAARP','GAAARP','SDAARP','MEAARP','CTAARP','NJAARP','RIAARP','OHAARP','KYAARP','TXAARP','LAAARP','ALAARP','AZAARP',
	'ORAARP','MDAARP','INAARP','IAAARP','KSAARP','VTAARP','NMAARP','CAAARP','DEAARP','WVAARP','FLAARP','ILAARP','COAARP','SCAARP','IDAARP','TNAARP','ARAARP','UTAARP',
	'NEAARP','NHAARP','NDAARP','WIAARP','MNAARP','WYAARP','MOAARP','MSAARP')
	GROUP BY Key
),

pol_pkg AS -- State Segmentation by Policy Package
(
	SELECT CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR,'Policy Package',(
	CASE WHEN POL_PACKAGE_ENHANCEMENT_CD IN ('11','21') THEN 'Advantage Plus'
		 WHEN POL_PACKAGE_ENHANCEMENT_CD IN ('12','22') THEN 'Advantage'
		 WHEN POL_PACKAGE_ENHANCEMENT_CD IN ('13','23') THEN 'Basic'
		 ELSE 'None' END),'Total') as Key,
	-- Response
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "12 Response",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "11 Response",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "10 Response",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "09 Response",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "08 Response",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "07 Response",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "06 Response",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "05 Response",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "04 Response",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "03 Response",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "02 Response",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "01 Response",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "00 Response",
	-- Completed Quote
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "12 CQ",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "11 CQ",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "10 CQ",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "09 CQ",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "08 CQ",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "07 CQ",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "06 CQ",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "05 CQ",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "04 CQ",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "03 CQ",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "02 CQ",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "01 CQ",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "00 CQ",
    -- Issue
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "12 Issue",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "11 Issue",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "10 Issue",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "09 Issue",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "08 Issue",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "07 Issue",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "06 Issue",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "05 Issue",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "04 Issue",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "03 Issue",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "02 Issue",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "01 Issue",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "00 Issue",
    -- AQP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AQP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AQP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AQP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AQP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AQP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AQP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AQP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AQP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AQP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AQP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AQP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AQP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AQP",
	-- AIP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AIP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AIP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AIP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AIP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AIP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AIP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AIP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AIP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AIP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AIP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AIP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AIP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AIP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"
	WHERE POL_FORM_CD IS NOT NULL AND BUS_UNIT_ABBR <> 'CDRT'
	AND CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR) NOT IN ('PAAARP','GAAARP','SDAARP','MEAARP','CTAARP','NJAARP','RIAARP','OHAARP','KYAARP','TXAARP','LAAARP','ALAARP','AZAARP',
	'ORAARP','MDAARP','INAARP','IAAARP','KSAARP','VTAARP','NMAARP','CAAARP','DEAARP','WVAARP','FLAARP','ILAARP','COAARP','SCAARP','IDAARP','TNAARP','ARAARP','UTAARP',
	'NEAARP','NHAARP','NDAARP','WIAARP','MNAARP','WYAARP','MOAARP','MSAARP')
	GROUP BY Key
),

sq_foot_grp AS -- State Segmentation by Square Foot Group
(
	SELECT CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR,'Square Foot Group',(
	CASE WHEN TOTAL_AREA_SQUARE_FEET_CNT BETWEEN 1 AND 1200 THEN 'a. 1-1200'
		 WHEN TOTAL_AREA_SQUARE_FEET_CNT BETWEEN 1201 AND 1500 THEN 'b. 1201-1500'
		 WHEN TOTAL_AREA_SQUARE_FEET_CNT BETWEEN 1501 AND 2000 THEN 'c. 1501-2000'
		 WHEN TOTAL_AREA_SQUARE_FEET_CNT BETWEEN 2001 AND 2500 THEN 'd. 2001-2500'
		 WHEN TOTAL_AREA_SQUARE_FEET_CNT BETWEEN 2501 AND 3000 THEN 'e. 2501-3000'
		 WHEN TOTAL_AREA_SQUARE_FEET_CNT BETWEEN 3001 AND 9999 THEN 'f. 3001+'
		 ELSE 'Unknown' END),'Total') as Key,
	-- Response
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "12 Response",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "11 Response",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "10 Response",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "09 Response",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "08 Response",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "07 Response",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "06 Response",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "05 Response",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "04 Response",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "03 Response",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "02 Response",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "01 Response",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "00 Response",
	-- Completed Quote
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "12 CQ",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "11 CQ",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "10 CQ",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "09 CQ",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "08 CQ",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "07 CQ",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "06 CQ",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "05 CQ",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "04 CQ",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "03 CQ",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "02 CQ",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "01 CQ",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "00 CQ",
    -- Issue
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "12 Issue",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "11 Issue",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "10 Issue",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "09 Issue",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "08 Issue",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "07 Issue",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "06 Issue",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "05 Issue",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "04 Issue",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "03 Issue",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "02 Issue",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "01 Issue",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "00 Issue",
    -- AQP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AQP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AQP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AQP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AQP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AQP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AQP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AQP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AQP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AQP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AQP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AQP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AQP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AQP",
	-- AIP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AIP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AIP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AIP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AIP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AIP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AIP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AIP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AIP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AIP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AIP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AIP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AIP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AIP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"
	WHERE POL_FORM_CD IS NOT NULL AND BUS_UNIT_ABBR <> 'CDRT'
	AND CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR) NOT IN ('PAAARP','GAAARP','SDAARP','MEAARP','CTAARP','NJAARP','RIAARP','OHAARP','KYAARP','TXAARP','LAAARP','ALAARP','AZAARP',
	'ORAARP','MDAARP','INAARP','IAAARP','KSAARP','VTAARP','NMAARP','CAAARP','DEAARP','WVAARP','FLAARP','ILAARP','COAARP','SCAARP','IDAARP','TNAARP','ARAARP','UTAARP',
	'NEAARP','NHAARP','NDAARP','WIAARP','MNAARP','WYAARP','MOAARP','MSAARP')
	GROUP BY Key
),

cov_a_sq_ft AS -- State Segmentation by Cov A Per SqFt
(
	SELECT CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR,'Cov A Per SqFt',(
	CASE WHEN ROUND(DIV0NULL(COV_A_AMT, TOTAL_AREA_SQUARE_FEET_CNT),0) BETWEEN 0 AND 169 THEN 'a. Less than 170'
		 WHEN ROUND(DIV0NULL(COV_A_AMT, TOTAL_AREA_SQUARE_FEET_CNT),0) BETWEEN 170 AND 189 THEN 'b. 170-189'
		 WHEN ROUND(DIV0NULL(COV_A_AMT, TOTAL_AREA_SQUARE_FEET_CNT),0) BETWEEN 190 AND 209 THEN 'c. 190-209'
		 WHEN ROUND(DIV0NULL(COV_A_AMT, TOTAL_AREA_SQUARE_FEET_CNT),0) BETWEEN 210 AND 239 THEN 'd. 210-239'
		 WHEN ROUND(DIV0NULL(COV_A_AMT,TOTAL_AREA_SQUARE_FEET_CNT),0) >= 240 THEN 'e. 240+'
		 ELSE 'Unknown' END),'Total') as Key,
	-- Response
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "12 Response",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "11 Response",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "10 Response",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "09 Response",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "08 Response",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "07 Response",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "06 Response",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "05 Response",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "04 Response",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "03 Response",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "02 Response",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "01 Response",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "00 Response",
	-- Completed Quote
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "12 CQ",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "11 CQ",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "10 CQ",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "09 CQ",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "08 CQ",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "07 CQ",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "06 CQ",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "05 CQ",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "04 CQ",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "03 CQ",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "02 CQ",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "01 CQ",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "00 CQ",
    -- Issue
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "12 Issue",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "11 Issue",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "10 Issue",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "09 Issue",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "08 Issue",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "07 Issue",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "06 Issue",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "05 Issue",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "04 Issue",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "03 Issue",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "02 Issue",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "01 Issue",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "00 Issue",
    -- AQP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AQP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AQP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AQP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AQP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AQP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AQP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AQP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AQP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AQP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AQP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AQP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AQP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AQP",
	-- AIP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AIP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AIP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AIP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AIP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AIP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AIP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AIP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AIP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AIP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AIP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AIP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AIP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AIP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"
	WHERE POL_FORM_CD IS NOT NULL AND BUS_UNIT_ABBR <> 'CDRT'
	AND CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR) NOT IN ('PAAARP','GAAARP','SDAARP','MEAARP','CTAARP','NJAARP','RIAARP','OHAARP','KYAARP','TXAARP','LAAARP','ALAARP','AZAARP',
	'ORAARP','MDAARP','INAARP','IAAARP','KSAARP','VTAARP','NMAARP','CAAARP','DEAARP','WVAARP','FLAARP','ILAARP','COAARP','SCAARP','IDAARP','TNAARP','ARAARP','UTAARP',
	'NEAARP','NHAARP','NDAARP','WIAARP','MNAARP','WYAARP','MOAARP','MSAARP')
	GROUP BY Key
),

coverage_a AS -- State Segmentation by Coverage A
(
	SELECT CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR,'Coverage A',(
	CASE WHEN COV_A_AMT < 150000 THEN 'A. <150k'
		 WHEN COV_A_AMT < 300000 THEN 'B. 150-299k'
		 WHEN COV_A_AMT < 375000 THEN 'C 300-374'
		 WHEN COV_A_AMT < 450000 THEN 'D. 375-449k'
		 WHEN COV_A_AMT < 650000 THEN 'E. 450-649k'
		 WHEN COV_A_AMT < 1000000 THEN 'F. 650-1m'
		 WHEN COV_A_AMT < 12000000 THEN 'G. 1m+'
		 ELSE 'Unknown' END),'Total') as Key,
	-- Response
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "12 Response",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "11 Response",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "10 Response",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "09 Response",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "08 Response",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "07 Response",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "06 Response",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "05 Response",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "04 Response",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "03 Response",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "02 Response",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "01 Response",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "00 Response",
	-- Completed Quote
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "12 CQ",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "11 CQ",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "10 CQ",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "09 CQ",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "08 CQ",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "07 CQ",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "06 CQ",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "05 CQ",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "04 CQ",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "03 CQ",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "02 CQ",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "01 CQ",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "00 CQ",
    -- Issue
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "12 Issue",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "11 Issue",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "10 Issue",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "09 Issue",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "08 Issue",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "07 Issue",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "06 Issue",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "05 Issue",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "04 Issue",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "03 Issue",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "02 Issue",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "01 Issue",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "00 Issue",
    -- AQP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AQP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AQP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AQP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AQP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AQP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AQP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AQP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AQP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AQP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AQP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AQP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AQP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AQP",
	-- AIP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AIP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AIP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AIP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AIP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AIP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AIP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AIP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AIP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AIP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AIP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AIP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AIP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AIP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"
	WHERE POL_FORM_CD IS NOT NULL AND BUS_UNIT_ABBR <> 'CDRT'
	AND CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR) NOT IN ('PAAARP','GAAARP','SDAARP','MEAARP','CTAARP','NJAARP','RIAARP','OHAARP','KYAARP','TXAARP','LAAARP','ALAARP','AZAARP',
	'ORAARP','MDAARP','INAARP','IAAARP','KSAARP','VTAARP','NMAARP','CAAARP','DEAARP','WVAARP','FLAARP','ILAARP','COAARP','SCAARP','IDAARP','TNAARP','ARAARP','UTAARP',
	'NEAARP','NHAARP','NDAARP','WIAARP','MNAARP','WYAARP','MOAARP','MSAARP')
	GROUP BY Key
),

dwelling_age AS -- State Segmentation by Dwelling Age Group
(
	SELECT CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR,'Dwelling Age Group',(
    CASE WHEN DWELLING_AGE = 'UKWN' THEN 'Unknown'
		 WHEN DWELLING_AGE <= 5 THEN 'A. 0-5'
		 WHEN DWELLING_AGE <= 10 THEN 'B. 6-10'
		 WHEN DWELLING_AGE <= 20 THEN 'C 11-20'
		 WHEN DWELLING_AGE <= 30 THEN 'D. 21-30'
		 WHEN DWELLING_AGE <= 40 THEN 'E. 31-40'
		 WHEN DWELLING_AGE <= 50 THEN 'F. 41-50'
		 WHEN DWELLING_AGE <= 60 THEN 'G. 51-60'
		 WHEN DWELLING_AGE <= 70 THEN 'H. 61-70'
		 WHEN DWELLING_AGE <= 200 THEN 'I. 71+'
		 ELSE 'Unknown' END),'Total') as Key,
	-- Response
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "12 Response",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "11 Response",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "10 Response",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "09 Response",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "08 Response",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "07 Response",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "06 Response",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "05 Response",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "04 Response",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "03 Response",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "02 Response",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "01 Response",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "00 Response",
	-- Completed Quote
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "12 CQ",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "11 CQ",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "10 CQ",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "09 CQ",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "08 CQ",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "07 CQ",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "06 CQ",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "05 CQ",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "04 CQ",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "03 CQ",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "02 CQ",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "01 CQ",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "00 CQ",
    -- Issue
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "12 Issue",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "11 Issue",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "10 Issue",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "09 Issue",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "08 Issue",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "07 Issue",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "06 Issue",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "05 Issue",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "04 Issue",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "03 Issue",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "02 Issue",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "01 Issue",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "00 Issue",
    -- AQP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AQP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AQP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AQP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AQP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AQP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AQP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AQP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AQP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AQP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AQP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AQP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AQP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AQP",
	-- AIP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AIP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AIP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AIP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AIP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AIP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AIP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AIP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AIP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AIP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AIP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AIP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AIP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AIP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"
	WHERE POL_FORM_CD IS NOT NULL AND BUS_UNIT_ABBR <> 'CDRT'
	AND CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR) NOT IN ('PAAARP','GAAARP','SDAARP','MEAARP','CTAARP','NJAARP','RIAARP','OHAARP','KYAARP','TXAARP','LAAARP','ALAARP','AZAARP',
	'ORAARP','MDAARP','INAARP','IAAARP','KSAARP','VTAARP','NMAARP','CAAARP','DEAARP','WVAARP','FLAARP','ILAARP','COAARP','SCAARP','IDAARP','TNAARP','ARAARP','UTAARP',
	'NEAARP','NHAARP','NDAARP','WIAARP','MNAARP','WYAARP','MOAARP','MSAARP')
	GROUP BY Key
),

wind_deduc_2 AS -- State Segmentation by Wind Deductible again?
(
	SELECT CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR,'Wind Deductible',(
    CASE WHEN WIND_HAIL_DED_DESC IN ('1% Deductible','2% Deductible','5% Deductible','Flat $1000 Deductible','Flat $2000 Deductible','Flat $5000 Deductible') THEN WIND_HAIL_DED_DESC
		 ELSE 'None' END),'Total') as Key,
	-- Response
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "12 Response",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "11 Response",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "10 Response",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "09 Response",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "08 Response",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "07 Response",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "06 Response",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "05 Response",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "04 Response",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "03 Response",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "02 Response",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "01 Response",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "00 Response",
	-- Completed Quote
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "12 CQ",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "11 CQ",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "10 CQ",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "09 CQ",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "08 CQ",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "07 CQ",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "06 CQ",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "05 CQ",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "04 CQ",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "03 CQ",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "02 CQ",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "01 CQ",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "00 CQ",
    -- Issue
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "12 Issue",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "11 Issue",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "10 Issue",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "09 Issue",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "08 Issue",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "07 Issue",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "06 Issue",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "05 Issue",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "04 Issue",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "03 Issue",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "02 Issue",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "01 Issue",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "00 Issue",
    -- AQP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AQP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AQP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AQP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AQP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AQP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AQP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AQP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AQP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AQP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AQP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AQP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AQP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AQP",
	-- AIP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AIP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AIP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AIP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AIP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AIP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AIP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AIP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AIP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AIP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AIP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AIP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AIP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AIP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"
	WHERE POL_FORM_CD IS NOT NULL AND BUS_UNIT_ABBR <> 'CDRT'
	AND CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR) NOT IN ('PAAARP','GAAARP','SDAARP','MEAARP','CTAARP','NJAARP','RIAARP','OHAARP','KYAARP','TXAARP','LAAARP','ALAARP','AZAARP',
	'ORAARP','MDAARP','INAARP','IAAARP','KSAARP','VTAARP','NMAARP','CAAARP','DEAARP','WVAARP','FLAARP','ILAARP','COAARP','SCAARP','IDAARP','TNAARP','ARAARP','UTAARP',
	'NEAARP','NHAARP','NDAARP','WIAARP','MNAARP','WYAARP','MOAARP','MSAARP')
	GROUP BY Key
),

roof_age_grp AS -- State Segmentation by Roof Age Group
(
	SELECT CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR,'Roof Age Group',(
    CASE WHEN ROOF_AGE IN ('0','1','2','3','4','5') THEN 'a 0-5'
		 WHEN ROOF_AGE IN ('6','7','8','9','10') THEN 'b 6-10'
		 WHEN ROOF_AGE in ('11','12','13','14','15','16','17','18','19','20') THEN 'c 11-20'
		 WHEN ROOF_AGE = 'UKWN' THEN 'Unk'
		 ELSE '21+' END),'Total') as Key,
	-- Response
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "12 Response",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "11 Response",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "10 Response",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "09 Response",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "08 Response",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "07 Response",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "06 Response",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "05 Response",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "04 Response",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "03 Response",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "02 Response",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "01 Response",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "00 Response",
	-- Completed Quote
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "12 CQ",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "11 CQ",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "10 CQ",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "09 CQ",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "08 CQ",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "07 CQ",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "06 CQ",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "05 CQ",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "04 CQ",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "03 CQ",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "02 CQ",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "01 CQ",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "00 CQ",
    -- Issue
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "12 Issue",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "11 Issue",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "10 Issue",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "09 Issue",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "08 Issue",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "07 Issue",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "06 Issue",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "05 Issue",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "04 Issue",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "03 Issue",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "02 Issue",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "01 Issue",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "00 Issue",
    -- AQP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AQP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AQP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AQP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AQP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AQP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AQP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AQP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AQP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AQP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AQP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AQP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AQP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AQP",
	-- AIP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AIP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AIP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AIP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AIP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AIP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AIP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AIP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AIP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AIP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AIP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AIP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AIP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AIP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"
	WHERE POL_FORM_CD IS NOT NULL AND BUS_UNIT_ABBR <> 'CDRT'
	AND CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR) NOT IN ('PAAARP','GAAARP','SDAARP','MEAARP','CTAARP','NJAARP','RIAARP','OHAARP','KYAARP','TXAARP','LAAARP','ALAARP','AZAARP',
	'ORAARP','MDAARP','INAARP','IAAARP','KSAARP','VTAARP','NMAARP','CAAARP','DEAARP','WVAARP','FLAARP','ILAARP','COAARP','SCAARP','IDAARP','TNAARP','ARAARP','UTAARP',
	'NEAARP','NHAARP','NDAARP','WIAARP','MNAARP','WYAARP','MOAARP','MSAARP')
	GROUP BY Key
),

roof_shape AS -- State Segmentation by Roof Shape
(
	SELECT CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR,'Roof Shape',(
    CASE WHEN ROOF_ARCH_GEOMETRY_DESC IN ('Gable','Hip','Flat','Complex/Custom') THEN ROOF_ARCH_GEOMETRY_DESC
		 WHEN ROOF_ARCH_GEOMETRY_DESC IS NULL THEN 'Unknown'
		 ELSE 'other' END),'Total') as Key,
	-- Response
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "12 Response",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "11 Response",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "10 Response",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "09 Response",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "08 Response",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "07 Response",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "06 Response",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "05 Response",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "04 Response",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "03 Response",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "02 Response",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "01 Response",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "00 Response",
	-- Completed Quote
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "12 CQ",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "11 CQ",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "10 CQ",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "09 CQ",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "08 CQ",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "07 CQ",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "06 CQ",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "05 CQ",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "04 CQ",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "03 CQ",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "02 CQ",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "01 CQ",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "00 CQ",
    -- Issue
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "12 Issue",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "11 Issue",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "10 Issue",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "09 Issue",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "08 Issue",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "07 Issue",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "06 Issue",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "05 Issue",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "04 Issue",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "03 Issue",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "02 Issue",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "01 Issue",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "00 Issue",
    -- AQP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AQP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AQP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AQP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AQP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AQP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AQP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AQP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AQP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AQP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AQP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AQP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AQP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AQP",
	-- AIP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AIP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AIP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AIP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AIP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AIP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AIP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AIP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AIP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AIP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AIP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AIP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AIP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AIP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"
	WHERE POL_FORM_CD IS NOT NULL AND BUS_UNIT_ABBR <> 'CDRT'
	AND CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR) NOT IN ('PAAARP','GAAARP','SDAARP','MEAARP','CTAARP','NJAARP','RIAARP','OHAARP','KYAARP','TXAARP','LAAARP','ALAARP','AZAARP',
	'ORAARP','MDAARP','INAARP','IAAARP','KSAARP','VTAARP','NMAARP','CAAARP','DEAARP','WVAARP','FLAARP','ILAARP','COAARP','SCAARP','IDAARP','TNAARP','ARAARP','UTAARP',
	'NEAARP','NHAARP','NDAARP','WIAARP','MNAARP','WYAARP','MOAARP','MSAARP')
	GROUP BY Key
),

dist_to_coast AS -- State Segmentation by Distance to Coast
(
	SELECT CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR,'Distance to Coast',(
    CASE WHEN RISK_ST_ABBR in('AK','AR','IA','ID','IL','MN','MO','IN','KS','KY','NM','OH','OK','UT','WI','WV',
	'VT','SD','TN','WY','ND','NE','OR','PA','MI','AZ','CO','MT') THEN 'A. Non DTC State'
		 WHEN DIST_TO_COAST_FEET_CNT <= 2000 THEN 'b. 0-2000'
		 WHEN DIST_TO_COAST_FEET_CNT > 2000 AND DIST_TO_COAST_FEET_CNT <= 5280 THEN 'c. 2001-5280'
		 WHEN DIST_TO_COAST_FEET_CNT > 5280 AND DIST_TO_COAST_FEET_CNT <= 26399 THEN 'd. 1-4 miles'
		 WHEN DIST_TO_COAST_FEET_CNT > 26400 AND DIST_TO_COAST_FEET_CNT <= 52799 THEN 'e. 5-9 miles'
		 WHEN DIST_TO_COAST_FEET_CNT > 52800 AND DIST_TO_COAST_FEET_CNT <= 105599 THEN 'f. 10-19 miles'
		 WHEN DIST_TO_COAST_FEET_CNT > 105600 AND DIST_TO_COAST_FEET_CNT <= 263999 THEN 'g. 20-49 miles'
		 WHEN DIST_TO_COAST_FEET_CNT > 264000 AND DIST_TO_COAST_FEET_CNT <= 395999 THEN 'h. 50-74 miles'
		 WHEN DIST_TO_COAST_FEET_CNT > 396000 AND DIST_TO_COAST_FEET_CNT <= 527999 THEN 'i. 75-99 miles'
		 WHEN DIST_TO_COAST_FEET_CNT > 528000 AND DIST_TO_COAST_FEET_CNT <= 791999 THEN 'j. 100-149 miles'
		 WHEN DIST_TO_COAST_FEET_CNT > 792000 AND DIST_TO_COAST_FEET_CNT <= 9999998 THEN 'k. 150+ miles'
		 WHEN DIST_TO_COAST_FEET_CNT = 9999999 THEN 'l 9999999 feet'
		 ELSE 'other' END),'Total') as Key,
	-- Response
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "12 Response",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "11 Response",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "10 Response",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "09 Response",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "08 Response",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "07 Response",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "06 Response",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "05 Response",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "04 Response",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "03 Response",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "02 Response",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "01 Response",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "00 Response",
	-- Completed Quote
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "12 CQ",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "11 CQ",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "10 CQ",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "09 CQ",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "08 CQ",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "07 CQ",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "06 CQ",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "05 CQ",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "04 CQ",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "03 CQ",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "02 CQ",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "01 CQ",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "00 CQ",
    -- Issue
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "12 Issue",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "11 Issue",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "10 Issue",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "09 Issue",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "08 Issue",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "07 Issue",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "06 Issue",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "05 Issue",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "04 Issue",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "03 Issue",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "02 Issue",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "01 Issue",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "00 Issue",
    -- AQP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AQP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AQP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AQP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AQP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AQP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AQP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AQP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AQP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AQP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AQP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AQP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AQP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AQP",
	-- AIP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AIP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AIP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AIP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AIP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AIP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AIP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AIP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AIP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AIP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AIP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AIP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AIP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AIP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"
	WHERE POL_FORM_CD IS NOT NULL AND BUS_UNIT_ABBR <> 'CDRT'
	AND CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR) NOT IN ('PAAARP','GAAARP','SDAARP','MEAARP','CTAARP','NJAARP','RIAARP','OHAARP','KYAARP','TXAARP','LAAARP','ALAARP','AZAARP',
	'ORAARP','MDAARP','INAARP','IAAARP','KSAARP','VTAARP','NMAARP','CAAARP','DEAARP','WVAARP','FLAARP','ILAARP','COAARP','SCAARP','IDAARP','TNAARP','ARAARP','UTAARP',
	'NEAARP','NHAARP','NDAARP','WIAARP','MNAARP','WYAARP','MOAARP','MSAARP')
	GROUP BY Key
),

fireline_score AS -- State Segmentation by Fireline Score Code
(
	SELECT CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR,'Fireline Score',(
	CASE WHEN FIRELINE_SCORE_CD = '00' THEN '0'
		 WHEN FIRELINE_SCORE_CD = '01' THEN '1'
		 WHEN FIRELINE_SCORE_CD = '02' THEN '2'
		 WHEN FIRELINE_SCORE_CD = '03' THEN '3'
		 WHEN FIRELINE_SCORE_CD = '04' THEN '4'
		 WHEN FIRELINE_SCORE_CD = '05' THEN '5'
		 WHEN FIRELINE_SCORE_CD = '06' THEN '6'
		 WHEN FIRELINE_SCORE_CD IN ('07','08','09','10','11','12','13','14','15','16','17','18','19','20','21',
		 '22','23','24','25','26','27','28','29','30','31') THEN '7+'
		 WHEN FIRELINE_SCORE_CD = '99' THEN '99'
		 WHEN FIRELINE_SCORE_CD IS NULL THEN 'N/A'
		 ELSE 'Unknown' END),'Total') as Key,
	-- Response
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "12 Response",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "11 Response",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "10 Response",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "09 Response",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "08 Response",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "07 Response",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "06 Response",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "05 Response",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "04 Response",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "03 Response",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "02 Response",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "01 Response",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "00 Response",
	-- Completed Quote
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "12 CQ",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "11 CQ",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "10 CQ",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "09 CQ",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "08 CQ",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "07 CQ",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "06 CQ",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "05 CQ",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "04 CQ",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "03 CQ",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "02 CQ",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "01 CQ",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "00 CQ",
    -- Issue
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "12 Issue",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "11 Issue",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "10 Issue",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "09 Issue",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "08 Issue",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "07 Issue",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "06 Issue",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "05 Issue",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "04 Issue",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "03 Issue",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "02 Issue",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "01 Issue",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "00 Issue",
    -- AQP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AQP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AQP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AQP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AQP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AQP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AQP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AQP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AQP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AQP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AQP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AQP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AQP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AQP",
	-- AIP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AIP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AIP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AIP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AIP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AIP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AIP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AIP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AIP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AIP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AIP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AIP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AIP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AIP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"
	WHERE POL_FORM_CD IS NOT NULL AND BUS_UNIT_ABBR <> 'CDRT'
	AND CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR) NOT IN ('PAAARP','GAAARP','SDAARP','MEAARP','CTAARP','NJAARP','RIAARP','OHAARP','KYAARP','TXAARP','LAAARP','ALAARP','AZAARP',
	'ORAARP','MDAARP','INAARP','IAAARP','KSAARP','VTAARP','NMAARP','CAAARP','DEAARP','WVAARP','FLAARP','ILAARP','COAARP','SCAARP','IDAARP','TNAARP','ARAARP','UTAARP',
	'NEAARP','NHAARP','NDAARP','WIAARP','MNAARP','WYAARP','MOAARP','MSAARP')
	GROUP BY Key
),

dwell_substate AS -- State Segmentation by Dwelling Substate
(
	SELECT CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR,'Dwelling Substate',(
	CASE WHEN RISK_ST_ABBR = 'IA' AND GARAGE_SUBSTATE IN ('Cedar Rapids/Iowa City metro', 'Central Iowa', 'Des Moines/Ames Metro', 'East Iowa', 'West Iowa/KS border') THEN GARAGE_SUBSTATE
		 WHEN RISK_ST_ABBR <> 'IA' AND LEFT(RISK_ST_ABBR,2) = LEFT(GARAGE_SUBSTATE,2) THEN GARAGE_SUBSTATE
		 ELSE 'Out of State Mail' END),'Total') as Key,
	-- Response
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "12 Response",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "11 Response",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "10 Response",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "09 Response",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "08 Response",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "07 Response",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "06 Response",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "05 Response",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "04 Response",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "03 Response",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "02 Response",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "01 Response",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), RESP_IND_CNT) AS "00 Response",
	-- Completed Quote
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "12 CQ",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "11 CQ",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "10 CQ",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "09 CQ",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "08 CQ",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "07 CQ",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "06 CQ",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "05 CQ",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "04 CQ",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "03 CQ",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "02 CQ",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "01 CQ",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT) AS "00 CQ",
    -- Issue
	zero_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "12 Issue",
	zero_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "11 Issue",
	zero_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "10 Issue",
	zero_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "09 Issue",
	zero_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "08 Issue",
	zero_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "07 Issue",
	zero_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "06 Issue",
	zero_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "05 Issue",
	zero_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "04 Issue",
	zero_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "03 Issue",
	zero_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "02 Issue",
	zero_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "01 Issue",
	zero_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT) AS "00 Issue",
    -- AQP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AQP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AQP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AQP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AQP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AQP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AQP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AQP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AQP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AQP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AQP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AQP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AQP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), COMP_QTE_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AQP",
	-- AIP
	one_cond_scorecard(12, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "12 AIP",
	one_cond_scorecard(11, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "11 AIP",
	one_cond_scorecard(10, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "10 AIP",
	one_cond_scorecard(9, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "09 AIP",
	one_cond_scorecard(8, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "08 AIP",
	one_cond_scorecard(7, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "07 AIP",
	one_cond_scorecard(6, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "06 AIP",
	one_cond_scorecard(5, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "05 AIP",
	one_cond_scorecard(4, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "04 AIP",
	one_cond_scorecard(3, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "03 AIP",
	one_cond_scorecard(2, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "02 AIP",
	one_cond_scorecard(1, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "01 AIP",
	one_cond_scorecard(0, TO_DATE(TO_CHAR(LAST_TRANS_DT_PK_ID), 'YYYYMMDD'), ISS_IND_CNT, 1, TERM_WRIT_PREM, TRUE) AS "00 AIP",
	TO_CHAR(SYSDATE(),'MM-DD-YYYY') as AS_OF
	FROM "DSC_PLBI_DB"."APP_HOME_PRD"."PLBI_HOME_QUOTE_FLOW_VW"
	LEFT JOIN (SELECT ZIP_CODE, STATE_ABBR, GARAGE_SUBSTATE FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."STATE_PRODUCT_SUBSTATE") t2
	ON t2.ZIP_CODE = LEFT(DWELLING_LOC_ZIP_CD,5)
	WHERE POL_FORM_CD IS NOT NULL AND BUS_UNIT_ABBR <> 'CDRT'
	AND CONCAT(RISK_ST_ABBR,BUS_UNIT_ABBR) NOT IN ('PAAARP','GAAARP','SDAARP','MEAARP','CTAARP','NJAARP','RIAARP','OHAARP','KYAARP','TXAARP','LAAARP','ALAARP','AZAARP',
	'ORAARP','MDAARP','INAARP','IAAARP','KSAARP','VTAARP','NMAARP','CAAARP','DEAARP','WVAARP','FLAARP','ILAARP','COAARP','SCAARP','IDAARP','TNAARP','ARAARP','UTAARP',
	'NEAARP','NHAARP','NDAARP','WIAARP','MNAARP','WYAARP','MOAARP','MSAARP')
	GROUP BY Key
)

SELECT * FROM
(
	SELECT * FROM acct_credit
	UNION ALL
	SELECT * FROM prot_class
	UNION ALL
	SELECT * FROM ins_score_decile
	UNION ALL
	SELECT * FROM ins_age_grp
	UNION ALL
	SELECT * FROM household_memb_cnt
	UNION ALL
	SELECT * FROM aarp_member_status
	UNION ALL
	SELECT * FROM aarp_member_years
	UNION ALL
	SELECT * FROM mortgage_count
	UNION ALL
	SELECT * FROM prior_cat_clm
	UNION ALL
	SELECT * FROM prior_xcat_clm
	UNION ALL
	SELECT * FROM state_deduc
	UNION ALL
	SELECT * FROM wind_deduc
	UNION ALL
	SELECT * FROM pol_pkg
	UNION ALL
	SELECT * FROM sq_foot_grp
	UNION ALL
	SELECT * FROM cov_a_sq_ft
	UNION ALL
	SELECT * FROM coverage_a
	UNION ALL
	SELECT * FROM dwelling_age
	UNION ALL
	SELECT * FROM wind_deduc_2
	UNION ALL
	SELECT * FROM roof_age_grp
	UNION ALL
	SELECT * FROM roof_shape
	UNION ALL
	SELECT * FROM dist_to_coast
	UNION ALL
	SELECT * FROM fireline_score
	UNION ALL
	SELECT * FROM dwell_substate
)
ORDER BY KEY

