(Select 
concat(RISK_ST_ABBR,LOB) as Key,
sum(case when Datediff(month,QUOTE_DT,sysdate())= 1 THEN RESPONSE_IND ELSE 0 END) AS "01 RESPONSE",             sum(case when Datediff(month,QUOTE_DT,sysdate())= 2 THEN RESPONSE_IND ELSE 0 END) AS "02 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 3 THEN RESPONSE_IND ELSE 0 END) AS "03 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 4 THEN RESPONSE_IND ELSE 0 END) AS "04 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 5 THEN RESPONSE_IND ELSE 0 END) AS "05 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 6 THEN RESPONSE_IND ELSE 0 END) AS "06 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 7 THEN RESPONSE_IND ELSE 0 END) AS "07 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 8 THEN RESPONSE_IND ELSE 0 END) AS "08 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 9 THEN RESPONSE_IND ELSE 0 END) AS "09 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 10 THEN RESPONSE_IND ELSE 0 END) AS "10 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 11 THEN RESPONSE_IND ELSE 0 END) AS "11 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 12 THEN RESPONSE_IND ELSE 0 END) AS "12 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 13 THEN RESPONSE_IND ELSE 0 END) AS "13 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 14 THEN RESPONSE_IND ELSE 0 END) AS "14 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 15 THEN RESPONSE_IND ELSE 0 END) AS "15 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 16 THEN RESPONSE_IND ELSE 0 END) AS "16 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 17 THEN RESPONSE_IND ELSE 0 END) AS "17 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 18 THEN RESPONSE_IND ELSE 0 END) AS "18 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 19 THEN RESPONSE_IND ELSE 0 END) AS "19 RESPONSE",
sum(case when Datediff(month,QUOTE_DT,sysdate())= 1 THEN SUCCESS_IND ELSE 0 END) AS "01 SUCCESS",               sum(case when Datediff(month,QUOTE_DT,sysdate())= 2 THEN SUCCESS_IND ELSE 0 END) AS "02 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 3 THEN SUCCESS_IND ELSE 0 END) AS "03 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 4 THEN SUCCESS_IND ELSE 0 END) AS "04 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 5 THEN SUCCESS_IND ELSE 0 END) AS "05 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 6 THEN SUCCESS_IND ELSE 0 END) AS "06 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 7 THEN SUCCESS_IND ELSE 0 END) AS "07 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 8 THEN SUCCESS_IND ELSE 0 END) AS "08 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 9 THEN SUCCESS_IND ELSE 0 END) AS "09 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 10 THEN SUCCESS_IND ELSE 0 END) AS "10 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 11 THEN SUCCESS_IND ELSE 0 END) AS "11 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 12 THEN SUCCESS_IND ELSE 0 END) AS "12 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 13 THEN SUCCESS_IND ELSE 0 END) AS "13 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 14 THEN SUCCESS_IND ELSE 0 END) AS "14 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 15 THEN SUCCESS_IND ELSE 0 END) AS "15 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 16 THEN SUCCESS_IND ELSE 0 END) AS "16 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 17 THEN SUCCESS_IND ELSE 0 END) AS "17 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 18 THEN SUCCESS_IND ELSE 0 END) AS "18 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 19 THEN SUCCESS_IND ELSE 0 END) AS "19 SUCCESS",
sum(case when Datediff(month,QUOTE_DT,sysdate())= 1 THEN COMPETITIVE_IND ELSE 0 END) AS "01 COMPETITIVE",       sum(case when Datediff(month,QUOTE_DT,sysdate())= 2 THEN COMPETITIVE_IND ELSE 0 END) AS "02 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 3 THEN COMPETITIVE_IND ELSE 0 END) AS "03 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 4 THEN COMPETITIVE_IND ELSE 0 END) AS "04 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 5 THEN COMPETITIVE_IND ELSE 0 END) AS "05 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 6 THEN COMPETITIVE_IND ELSE 0 END) AS "06 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 7 THEN COMPETITIVE_IND ELSE 0 END) AS "07 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 8 THEN COMPETITIVE_IND ELSE 0 END) AS "08 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 9 THEN COMPETITIVE_IND ELSE 0 END) AS "09 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 10 THEN COMPETITIVE_IND ELSE 0 END) AS "10 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 11 THEN COMPETITIVE_IND ELSE 0 END) AS "11 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 12 THEN COMPETITIVE_IND ELSE 0 END) AS "12 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 13 THEN COMPETITIVE_IND ELSE 0 END) AS "13 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 14 THEN COMPETITIVE_IND ELSE 0 END) AS "14 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 15 THEN COMPETITIVE_IND ELSE 0 END) AS "15 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 16 THEN COMPETITIVE_IND ELSE 0 END) AS "16 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 17 THEN COMPETITIVE_IND ELSE 0 END) AS "17 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 18 THEN COMPETITIVE_IND ELSE 0 END) AS "18 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 19 THEN COMPETITIVE_IND ELSE 0 END) AS "19 COMPETITIVE",
sum(case when Datediff(month,QUOTE_DT,sysdate())= 1 THEN WIN_IND ELSE 0 END) AS "01 WIN",                       sum(case when Datediff(month,QUOTE_DT,sysdate())= 2 THEN WIN_IND ELSE 0 END) AS "02 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 3 THEN WIN_IND ELSE 0 END) AS "03 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 4 THEN WIN_IND ELSE 0 END) AS "04 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 5 THEN WIN_IND ELSE 0 END) AS "05 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 6 THEN WIN_IND ELSE 0 END) AS "06 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 7 THEN WIN_IND ELSE 0 END) AS "07 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 8 THEN WIN_IND ELSE 0 END) AS "08 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 9 THEN WIN_IND ELSE 0 END) AS "09 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 10 THEN WIN_IND ELSE 0 END) AS "10 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 11 THEN WIN_IND ELSE 0 END) AS "11 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 12 THEN WIN_IND ELSE 0 END) AS "12 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 13 THEN WIN_IND ELSE 0 END) AS "13 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 14 THEN WIN_IND ELSE 0 END) AS "14 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 15 THEN WIN_IND ELSE 0 END) AS "15 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 16 THEN WIN_IND ELSE 0 END) AS "16 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 17 THEN WIN_IND ELSE 0 END) AS "17 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 18 THEN WIN_IND ELSE 0 END) AS "18 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 19 THEN WIN_IND ELSE 0 END) AS "19 WIN",
sum(case when Datediff(month,QUOTE_DT,sysdate())= 1 THEN BRIDGED_IND ELSE 0 END) AS "01 BRIDGED",               sum(case when Datediff(month,QUOTE_DT,sysdate())= 2 THEN BRIDGED_IND ELSE 0 END) AS "02 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 3 THEN BRIDGED_IND ELSE 0 END) AS "03 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 4 THEN BRIDGED_IND ELSE 0 END) AS "04 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 5 THEN BRIDGED_IND ELSE 0 END) AS "05 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 6 THEN BRIDGED_IND ELSE 0 END) AS "06 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 7 THEN BRIDGED_IND ELSE 0 END) AS "07 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 8 THEN BRIDGED_IND ELSE 0 END) AS "08 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 9 THEN BRIDGED_IND ELSE 0 END) AS "09 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 10 THEN BRIDGED_IND ELSE 0 END) AS "10 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 11 THEN BRIDGED_IND ELSE 0 END) AS "11 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 12 THEN BRIDGED_IND ELSE 0 END) AS "12 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 13 THEN BRIDGED_IND ELSE 0 END) AS "13 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 14 THEN BRIDGED_IND ELSE 0 END) AS "14 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 15 THEN BRIDGED_IND ELSE 0 END) AS "15 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 16 THEN BRIDGED_IND ELSE 0 END) AS "16 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 17 THEN BRIDGED_IND ELSE 0 END) AS "17 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 18 THEN BRIDGED_IND ELSE 0 END) AS "18 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 19 THEN BRIDGED_IND ELSE 0 END) AS "19 BRIDGED",
sum(case when Datediff(month,QUOTE_DT,sysdate())= 1 THEN COMPL_QUOTE_IND ELSE 0 END) AS "01 COMPL_QUOTE",       sum(case when Datediff(month,QUOTE_DT,sysdate())= 2 THEN COMPL_QUOTE_IND ELSE 0 END) AS "02 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 3 THEN COMPL_QUOTE_IND ELSE 0 END) AS "03 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 4 THEN COMPL_QUOTE_IND ELSE 0 END) AS "04 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 5 THEN COMPL_QUOTE_IND ELSE 0 END) AS "05 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 6 THEN COMPL_QUOTE_IND ELSE 0 END) AS "06 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 7 THEN COMPL_QUOTE_IND ELSE 0 END) AS "07 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 8 THEN COMPL_QUOTE_IND ELSE 0 END) AS "08 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 9 THEN COMPL_QUOTE_IND ELSE 0 END) AS "09 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 10 THEN COMPL_QUOTE_IND ELSE 0 END) AS "10 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 11 THEN COMPL_QUOTE_IND ELSE 0 END) AS "11 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 12 THEN COMPL_QUOTE_IND ELSE 0 END) AS "12 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 13 THEN COMPL_QUOTE_IND ELSE 0 END) AS "13 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 14 THEN COMPL_QUOTE_IND ELSE 0 END) AS "14 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 15 THEN COMPL_QUOTE_IND ELSE 0 END) AS "15 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 16 THEN COMPL_QUOTE_IND ELSE 0 END) AS "16 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 17 THEN COMPL_QUOTE_IND ELSE 0 END) AS "17 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 18 THEN COMPL_QUOTE_IND ELSE 0 END) AS "18 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 19 THEN COMPL_QUOTE_IND ELSE 0 END) AS "19 COMPL_QUOTE",
sum(case when Datediff(month,QUOTE_DT,sysdate())= 1 THEN ISSUE_IND ELSE 0 END) AS "01 ISSUE",                   sum(case when Datediff(month,QUOTE_DT,sysdate())= 2 THEN ISSUE_IND ELSE 0 END) AS "02 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 3 THEN ISSUE_IND ELSE 0 END) AS "03 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 4 THEN ISSUE_IND ELSE 0 END) AS "04 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 5 THEN ISSUE_IND ELSE 0 END) AS "05 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 6 THEN ISSUE_IND ELSE 0 END) AS "06 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 7 THEN ISSUE_IND ELSE 0 END) AS "07 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 8 THEN ISSUE_IND ELSE 0 END) AS "08 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 9 THEN ISSUE_IND ELSE 0 END) AS "09 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 10 THEN ISSUE_IND ELSE 0 END) AS "10 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 11 THEN ISSUE_IND ELSE 0 END) AS "11 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 12 THEN ISSUE_IND ELSE 0 END) AS "12 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 13 THEN ISSUE_IND ELSE 0 END) AS "13 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 14 THEN ISSUE_IND ELSE 0 END) AS "14 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 15 THEN ISSUE_IND ELSE 0 END) AS "15 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 16 THEN ISSUE_IND ELSE 0 END) AS "16 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 17 THEN ISSUE_IND ELSE 0 END) AS "17 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 18 THEN ISSUE_IND ELSE 0 END) AS "18 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 19 THEN ISSUE_IND ELSE 0 END) AS "19 ISSUE",
nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 1 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG > 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "01 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 2 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG > 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "02 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 3 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "03 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 4 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "04 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 5 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "05 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 6 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "06 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 7 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "07 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 8 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "08 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 9 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "09 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 10 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "10 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 11 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "11 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 12 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "12 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 13 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "13 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 14 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "14 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 15 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "15 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 16 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "16 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 17 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "17 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 18 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "18 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 19 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "19 HIGAVG"
 ,TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM "DSC_PLBI_DB"."APP_AGCY_PRD"."AGCY_COMP_RATER_FUNNEL_VW"  group by Key order by Key)

Union all 

(Select 
concat('CW',LOB) as Key,
sum(case when Datediff(month,QUOTE_DT,sysdate())= 1 THEN RESPONSE_IND ELSE 0 END) AS "01 RESPONSE",             sum(case when Datediff(month,QUOTE_DT,sysdate())= 2 THEN RESPONSE_IND ELSE 0 END) AS "02 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 3 THEN RESPONSE_IND ELSE 0 END) AS "03 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 4 THEN RESPONSE_IND ELSE 0 END) AS "04 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 5 THEN RESPONSE_IND ELSE 0 END) AS "05 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 6 THEN RESPONSE_IND ELSE 0 END) AS "06 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 7 THEN RESPONSE_IND ELSE 0 END) AS "07 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 8 THEN RESPONSE_IND ELSE 0 END) AS "08 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 9 THEN RESPONSE_IND ELSE 0 END) AS "09 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 10 THEN RESPONSE_IND ELSE 0 END) AS "10 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 11 THEN RESPONSE_IND ELSE 0 END) AS "11 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 12 THEN RESPONSE_IND ELSE 0 END) AS "12 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 13 THEN RESPONSE_IND ELSE 0 END) AS "13 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 14 THEN RESPONSE_IND ELSE 0 END) AS "14 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 15 THEN RESPONSE_IND ELSE 0 END) AS "15 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 16 THEN RESPONSE_IND ELSE 0 END) AS "16 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 17 THEN RESPONSE_IND ELSE 0 END) AS "17 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 18 THEN RESPONSE_IND ELSE 0 END) AS "18 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 19 THEN RESPONSE_IND ELSE 0 END) AS "19 RESPONSE",
sum(case when Datediff(month,QUOTE_DT,sysdate())= 1 THEN SUCCESS_IND ELSE 0 END) AS "01 SUCCESS",               sum(case when Datediff(month,QUOTE_DT,sysdate())= 2 THEN SUCCESS_IND ELSE 0 END) AS "02 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 3 THEN SUCCESS_IND ELSE 0 END) AS "03 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 4 THEN SUCCESS_IND ELSE 0 END) AS "04 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 5 THEN SUCCESS_IND ELSE 0 END) AS "05 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 6 THEN SUCCESS_IND ELSE 0 END) AS "06 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 7 THEN SUCCESS_IND ELSE 0 END) AS "07 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 8 THEN SUCCESS_IND ELSE 0 END) AS "08 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 9 THEN SUCCESS_IND ELSE 0 END) AS "09 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 10 THEN SUCCESS_IND ELSE 0 END) AS "10 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 11 THEN SUCCESS_IND ELSE 0 END) AS "11 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 12 THEN SUCCESS_IND ELSE 0 END) AS "12 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 13 THEN SUCCESS_IND ELSE 0 END) AS "13 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 14 THEN SUCCESS_IND ELSE 0 END) AS "14 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 15 THEN SUCCESS_IND ELSE 0 END) AS "15 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 16 THEN SUCCESS_IND ELSE 0 END) AS "16 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 17 THEN SUCCESS_IND ELSE 0 END) AS "17 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 18 THEN SUCCESS_IND ELSE 0 END) AS "18 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 19 THEN SUCCESS_IND ELSE 0 END) AS "19 SUCCESS",
sum(case when Datediff(month,QUOTE_DT,sysdate())= 1 THEN COMPETITIVE_IND ELSE 0 END) AS "01 COMPETITIVE",       sum(case when Datediff(month,QUOTE_DT,sysdate())= 2 THEN COMPETITIVE_IND ELSE 0 END) AS "02 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 3 THEN COMPETITIVE_IND ELSE 0 END) AS "03 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 4 THEN COMPETITIVE_IND ELSE 0 END) AS "04 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 5 THEN COMPETITIVE_IND ELSE 0 END) AS "05 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 6 THEN COMPETITIVE_IND ELSE 0 END) AS "06 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 7 THEN COMPETITIVE_IND ELSE 0 END) AS "07 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 8 THEN COMPETITIVE_IND ELSE 0 END) AS "08 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 9 THEN COMPETITIVE_IND ELSE 0 END) AS "09 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 10 THEN COMPETITIVE_IND ELSE 0 END) AS "10 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 11 THEN COMPETITIVE_IND ELSE 0 END) AS "11 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 12 THEN COMPETITIVE_IND ELSE 0 END) AS "12 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 13 THEN COMPETITIVE_IND ELSE 0 END) AS "13 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 14 THEN COMPETITIVE_IND ELSE 0 END) AS "14 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 15 THEN COMPETITIVE_IND ELSE 0 END) AS "15 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 16 THEN COMPETITIVE_IND ELSE 0 END) AS "16 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 17 THEN COMPETITIVE_IND ELSE 0 END) AS "17 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 18 THEN COMPETITIVE_IND ELSE 0 END) AS "18 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 19 THEN COMPETITIVE_IND ELSE 0 END) AS "19 COMPETITIVE",
sum(case when Datediff(month,QUOTE_DT,sysdate())= 1 THEN WIN_IND ELSE 0 END) AS "01 WIN",                       sum(case when Datediff(month,QUOTE_DT,sysdate())= 2 THEN WIN_IND ELSE 0 END) AS "02 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 3 THEN WIN_IND ELSE 0 END) AS "03 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 4 THEN WIN_IND ELSE 0 END) AS "04 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 5 THEN WIN_IND ELSE 0 END) AS "05 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 6 THEN WIN_IND ELSE 0 END) AS "06 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 7 THEN WIN_IND ELSE 0 END) AS "07 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 8 THEN WIN_IND ELSE 0 END) AS "08 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 9 THEN WIN_IND ELSE 0 END) AS "09 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 10 THEN WIN_IND ELSE 0 END) AS "10 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 11 THEN WIN_IND ELSE 0 END) AS "11 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 12 THEN WIN_IND ELSE 0 END) AS "12 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 13 THEN WIN_IND ELSE 0 END) AS "13 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 14 THEN WIN_IND ELSE 0 END) AS "14 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 15 THEN WIN_IND ELSE 0 END) AS "15 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 16 THEN WIN_IND ELSE 0 END) AS "16 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 17 THEN WIN_IND ELSE 0 END) AS "17 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 18 THEN WIN_IND ELSE 0 END) AS "18 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 19 THEN WIN_IND ELSE 0 END) AS "19 WIN",
sum(case when Datediff(month,QUOTE_DT,sysdate())= 1 THEN BRIDGED_IND ELSE 0 END) AS "01 BRIDGED",               sum(case when Datediff(month,QUOTE_DT,sysdate())= 2 THEN BRIDGED_IND ELSE 0 END) AS "02 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 3 THEN BRIDGED_IND ELSE 0 END) AS "03 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 4 THEN BRIDGED_IND ELSE 0 END) AS "04 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 5 THEN BRIDGED_IND ELSE 0 END) AS "05 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 6 THEN BRIDGED_IND ELSE 0 END) AS "06 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 7 THEN BRIDGED_IND ELSE 0 END) AS "07 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 8 THEN BRIDGED_IND ELSE 0 END) AS "08 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 9 THEN BRIDGED_IND ELSE 0 END) AS "09 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 10 THEN BRIDGED_IND ELSE 0 END) AS "10 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 11 THEN BRIDGED_IND ELSE 0 END) AS "11 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 12 THEN BRIDGED_IND ELSE 0 END) AS "12 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 13 THEN BRIDGED_IND ELSE 0 END) AS "13 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 14 THEN BRIDGED_IND ELSE 0 END) AS "14 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 15 THEN BRIDGED_IND ELSE 0 END) AS "15 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 16 THEN BRIDGED_IND ELSE 0 END) AS "16 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 17 THEN BRIDGED_IND ELSE 0 END) AS "17 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 18 THEN BRIDGED_IND ELSE 0 END) AS "18 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 19 THEN BRIDGED_IND ELSE 0 END) AS "19 BRIDGED",
sum(case when Datediff(month,QUOTE_DT,sysdate())= 1 THEN COMPL_QUOTE_IND ELSE 0 END) AS "01 COMPL_QUOTE",       sum(case when Datediff(month,QUOTE_DT,sysdate())= 2 THEN COMPL_QUOTE_IND ELSE 0 END) AS "02 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 3 THEN COMPL_QUOTE_IND ELSE 0 END) AS "03 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 4 THEN COMPL_QUOTE_IND ELSE 0 END) AS "04 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 5 THEN COMPL_QUOTE_IND ELSE 0 END) AS "05 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 6 THEN COMPL_QUOTE_IND ELSE 0 END) AS "06 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 7 THEN COMPL_QUOTE_IND ELSE 0 END) AS "07 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 8 THEN COMPL_QUOTE_IND ELSE 0 END) AS "08 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 9 THEN COMPL_QUOTE_IND ELSE 0 END) AS "09 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 10 THEN COMPL_QUOTE_IND ELSE 0 END) AS "10 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 11 THEN COMPL_QUOTE_IND ELSE 0 END) AS "11 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 12 THEN COMPL_QUOTE_IND ELSE 0 END) AS "12 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 13 THEN COMPL_QUOTE_IND ELSE 0 END) AS "13 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 14 THEN COMPL_QUOTE_IND ELSE 0 END) AS "14 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 15 THEN COMPL_QUOTE_IND ELSE 0 END) AS "15 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 16 THEN COMPL_QUOTE_IND ELSE 0 END) AS "16 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 17 THEN COMPL_QUOTE_IND ELSE 0 END) AS "17 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 18 THEN COMPL_QUOTE_IND ELSE 0 END) AS "18 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 19 THEN COMPL_QUOTE_IND ELSE 0 END) AS "19 COMPL_QUOTE",
sum(case when Datediff(month,QUOTE_DT,sysdate())= 1 THEN ISSUE_IND ELSE 0 END) AS "01 ISSUE",                   sum(case when Datediff(month,QUOTE_DT,sysdate())= 2 THEN ISSUE_IND ELSE 0 END) AS "02 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 3 THEN ISSUE_IND ELSE 0 END) AS "03 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 4 THEN ISSUE_IND ELSE 0 END) AS "04 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 5 THEN ISSUE_IND ELSE 0 END) AS "05 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 6 THEN ISSUE_IND ELSE 0 END) AS "06 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 7 THEN ISSUE_IND ELSE 0 END) AS "07 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 8 THEN ISSUE_IND ELSE 0 END) AS "08 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 9 THEN ISSUE_IND ELSE 0 END) AS "09 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 10 THEN ISSUE_IND ELSE 0 END) AS "10 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 11 THEN ISSUE_IND ELSE 0 END) AS "11 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 12 THEN ISSUE_IND ELSE 0 END) AS "12 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 13 THEN ISSUE_IND ELSE 0 END) AS "13 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 14 THEN ISSUE_IND ELSE 0 END) AS "14 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 15 THEN ISSUE_IND ELSE 0 END) AS "15 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 16 THEN ISSUE_IND ELSE 0 END) AS "16 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 17 THEN ISSUE_IND ELSE 0 END) AS "17 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 18 THEN ISSUE_IND ELSE 0 END) AS "18 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 19 THEN ISSUE_IND ELSE 0 END) AS "19 ISSUE",
nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 1 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG > 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "01 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 2 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG > 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "02 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 3 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "03 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 4 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "04 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 5 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "05 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 6 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "06 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 7 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "07 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 8 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "08 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 9 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "09 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 10 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "10 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 11 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "11 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 12 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "12 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 13 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "13 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 14 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "14 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 15 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "15 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 16 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "16 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 17 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "17 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 18 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "18 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 19 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "19 HIGAVG"
 ,TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
FROM "DSC_PLBI_DB"."APP_AGCY_PRD"."AGCY_COMP_RATER_FUNNEL_VW"  group by Key order by Key)

Union all 

(Select 
concat((case when RISK_ST_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_ST_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_ST_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_ST_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),LOB) as Key,
sum(case when Datediff(month,QUOTE_DT,sysdate())= 1 THEN RESPONSE_IND ELSE 0 END) AS "01 RESPONSE",             sum(case when Datediff(month,QUOTE_DT,sysdate())= 2 THEN RESPONSE_IND ELSE 0 END) AS "02 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 3 THEN RESPONSE_IND ELSE 0 END) AS "03 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 4 THEN RESPONSE_IND ELSE 0 END) AS "04 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 5 THEN RESPONSE_IND ELSE 0 END) AS "05 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 6 THEN RESPONSE_IND ELSE 0 END) AS "06 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 7 THEN RESPONSE_IND ELSE 0 END) AS "07 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 8 THEN RESPONSE_IND ELSE 0 END) AS "08 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 9 THEN RESPONSE_IND ELSE 0 END) AS "09 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 10 THEN RESPONSE_IND ELSE 0 END) AS "10 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 11 THEN RESPONSE_IND ELSE 0 END) AS "11 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 12 THEN RESPONSE_IND ELSE 0 END) AS "12 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 13 THEN RESPONSE_IND ELSE 0 END) AS "13 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 14 THEN RESPONSE_IND ELSE 0 END) AS "14 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 15 THEN RESPONSE_IND ELSE 0 END) AS "15 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 16 THEN RESPONSE_IND ELSE 0 END) AS "16 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 17 THEN RESPONSE_IND ELSE 0 END) AS "17 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 18 THEN RESPONSE_IND ELSE 0 END) AS "18 RESPONSE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 19 THEN RESPONSE_IND ELSE 0 END) AS "19 RESPONSE",
sum(case when Datediff(month,QUOTE_DT,sysdate())= 1 THEN SUCCESS_IND ELSE 0 END) AS "01 SUCCESS",               sum(case when Datediff(month,QUOTE_DT,sysdate())= 2 THEN SUCCESS_IND ELSE 0 END) AS "02 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 3 THEN SUCCESS_IND ELSE 0 END) AS "03 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 4 THEN SUCCESS_IND ELSE 0 END) AS "04 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 5 THEN SUCCESS_IND ELSE 0 END) AS "05 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 6 THEN SUCCESS_IND ELSE 0 END) AS "06 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 7 THEN SUCCESS_IND ELSE 0 END) AS "07 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 8 THEN SUCCESS_IND ELSE 0 END) AS "08 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 9 THEN SUCCESS_IND ELSE 0 END) AS "09 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 10 THEN SUCCESS_IND ELSE 0 END) AS "10 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 11 THEN SUCCESS_IND ELSE 0 END) AS "11 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 12 THEN SUCCESS_IND ELSE 0 END) AS "12 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 13 THEN SUCCESS_IND ELSE 0 END) AS "13 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 14 THEN SUCCESS_IND ELSE 0 END) AS "14 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 15 THEN SUCCESS_IND ELSE 0 END) AS "15 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 16 THEN SUCCESS_IND ELSE 0 END) AS "16 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 17 THEN SUCCESS_IND ELSE 0 END) AS "17 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 18 THEN SUCCESS_IND ELSE 0 END) AS "18 SUCCESS",sum(case when Datediff(month,QUOTE_DT,sysdate())= 19 THEN SUCCESS_IND ELSE 0 END) AS "19 SUCCESS",
sum(case when Datediff(month,QUOTE_DT,sysdate())= 1 THEN COMPETITIVE_IND ELSE 0 END) AS "01 COMPETITIVE",       sum(case when Datediff(month,QUOTE_DT,sysdate())= 2 THEN COMPETITIVE_IND ELSE 0 END) AS "02 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 3 THEN COMPETITIVE_IND ELSE 0 END) AS "03 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 4 THEN COMPETITIVE_IND ELSE 0 END) AS "04 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 5 THEN COMPETITIVE_IND ELSE 0 END) AS "05 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 6 THEN COMPETITIVE_IND ELSE 0 END) AS "06 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 7 THEN COMPETITIVE_IND ELSE 0 END) AS "07 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 8 THEN COMPETITIVE_IND ELSE 0 END) AS "08 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 9 THEN COMPETITIVE_IND ELSE 0 END) AS "09 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 10 THEN COMPETITIVE_IND ELSE 0 END) AS "10 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 11 THEN COMPETITIVE_IND ELSE 0 END) AS "11 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 12 THEN COMPETITIVE_IND ELSE 0 END) AS "12 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 13 THEN COMPETITIVE_IND ELSE 0 END) AS "13 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 14 THEN COMPETITIVE_IND ELSE 0 END) AS "14 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 15 THEN COMPETITIVE_IND ELSE 0 END) AS "15 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 16 THEN COMPETITIVE_IND ELSE 0 END) AS "16 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 17 THEN COMPETITIVE_IND ELSE 0 END) AS "17 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 18 THEN COMPETITIVE_IND ELSE 0 END) AS "18 COMPETITIVE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 19 THEN COMPETITIVE_IND ELSE 0 END) AS "19 COMPETITIVE",
sum(case when Datediff(month,QUOTE_DT,sysdate())= 1 THEN WIN_IND ELSE 0 END) AS "01 WIN",                       sum(case when Datediff(month,QUOTE_DT,sysdate())= 2 THEN WIN_IND ELSE 0 END) AS "02 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 3 THEN WIN_IND ELSE 0 END) AS "03 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 4 THEN WIN_IND ELSE 0 END) AS "04 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 5 THEN WIN_IND ELSE 0 END) AS "05 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 6 THEN WIN_IND ELSE 0 END) AS "06 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 7 THEN WIN_IND ELSE 0 END) AS "07 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 8 THEN WIN_IND ELSE 0 END) AS "08 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 9 THEN WIN_IND ELSE 0 END) AS "09 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 10 THEN WIN_IND ELSE 0 END) AS "10 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 11 THEN WIN_IND ELSE 0 END) AS "11 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 12 THEN WIN_IND ELSE 0 END) AS "12 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 13 THEN WIN_IND ELSE 0 END) AS "13 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 14 THEN WIN_IND ELSE 0 END) AS "14 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 15 THEN WIN_IND ELSE 0 END) AS "15 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 16 THEN WIN_IND ELSE 0 END) AS "16 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 17 THEN WIN_IND ELSE 0 END) AS "17 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 18 THEN WIN_IND ELSE 0 END) AS "18 WIN",sum(case when Datediff(month,QUOTE_DT,sysdate())= 19 THEN WIN_IND ELSE 0 END) AS "19 WIN",
sum(case when Datediff(month,QUOTE_DT,sysdate())= 1 THEN BRIDGED_IND ELSE 0 END) AS "01 BRIDGED",               sum(case when Datediff(month,QUOTE_DT,sysdate())= 2 THEN BRIDGED_IND ELSE 0 END) AS "02 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 3 THEN BRIDGED_IND ELSE 0 END) AS "03 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 4 THEN BRIDGED_IND ELSE 0 END) AS "04 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 5 THEN BRIDGED_IND ELSE 0 END) AS "05 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 6 THEN BRIDGED_IND ELSE 0 END) AS "06 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 7 THEN BRIDGED_IND ELSE 0 END) AS "07 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 8 THEN BRIDGED_IND ELSE 0 END) AS "08 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 9 THEN BRIDGED_IND ELSE 0 END) AS "09 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 10 THEN BRIDGED_IND ELSE 0 END) AS "10 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 11 THEN BRIDGED_IND ELSE 0 END) AS "11 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 12 THEN BRIDGED_IND ELSE 0 END) AS "12 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 13 THEN BRIDGED_IND ELSE 0 END) AS "13 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 14 THEN BRIDGED_IND ELSE 0 END) AS "14 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 15 THEN BRIDGED_IND ELSE 0 END) AS "15 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 16 THEN BRIDGED_IND ELSE 0 END) AS "16 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 17 THEN BRIDGED_IND ELSE 0 END) AS "17 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 18 THEN BRIDGED_IND ELSE 0 END) AS "18 BRIDGED",sum(case when Datediff(month,QUOTE_DT,sysdate())= 19 THEN BRIDGED_IND ELSE 0 END) AS "19 BRIDGED",
sum(case when Datediff(month,QUOTE_DT,sysdate())= 1 THEN COMPL_QUOTE_IND ELSE 0 END) AS "01 COMPL_QUOTE",       sum(case when Datediff(month,QUOTE_DT,sysdate())= 2 THEN COMPL_QUOTE_IND ELSE 0 END) AS "02 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 3 THEN COMPL_QUOTE_IND ELSE 0 END) AS "03 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 4 THEN COMPL_QUOTE_IND ELSE 0 END) AS "04 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 5 THEN COMPL_QUOTE_IND ELSE 0 END) AS "05 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 6 THEN COMPL_QUOTE_IND ELSE 0 END) AS "06 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 7 THEN COMPL_QUOTE_IND ELSE 0 END) AS "07 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 8 THEN COMPL_QUOTE_IND ELSE 0 END) AS "08 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 9 THEN COMPL_QUOTE_IND ELSE 0 END) AS "09 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 10 THEN COMPL_QUOTE_IND ELSE 0 END) AS "10 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 11 THEN COMPL_QUOTE_IND ELSE 0 END) AS "11 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 12 THEN COMPL_QUOTE_IND ELSE 0 END) AS "12 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 13 THEN COMPL_QUOTE_IND ELSE 0 END) AS "13 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 14 THEN COMPL_QUOTE_IND ELSE 0 END) AS "14 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 15 THEN COMPL_QUOTE_IND ELSE 0 END) AS "15 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 16 THEN COMPL_QUOTE_IND ELSE 0 END) AS "16 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 17 THEN COMPL_QUOTE_IND ELSE 0 END) AS "17 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 18 THEN COMPL_QUOTE_IND ELSE 0 END) AS "18 COMPL_QUOTE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 19 THEN COMPL_QUOTE_IND ELSE 0 END) AS "19 COMPL_QUOTE",
sum(case when Datediff(month,QUOTE_DT,sysdate())= 1 THEN ISSUE_IND ELSE 0 END) AS "01 ISSUE",                   sum(case when Datediff(month,QUOTE_DT,sysdate())= 2 THEN ISSUE_IND ELSE 0 END) AS "02 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 3 THEN ISSUE_IND ELSE 0 END) AS "03 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 4 THEN ISSUE_IND ELSE 0 END) AS "04 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 5 THEN ISSUE_IND ELSE 0 END) AS "05 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 6 THEN ISSUE_IND ELSE 0 END) AS "06 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 7 THEN ISSUE_IND ELSE 0 END) AS "07 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 8 THEN ISSUE_IND ELSE 0 END) AS "08 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 9 THEN ISSUE_IND ELSE 0 END) AS "09 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 10 THEN ISSUE_IND ELSE 0 END) AS "10 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 11 THEN ISSUE_IND ELSE 0 END) AS "11 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 12 THEN ISSUE_IND ELSE 0 END) AS "12 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 13 THEN ISSUE_IND ELSE 0 END) AS "13 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 14 THEN ISSUE_IND ELSE 0 END) AS "14 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 15 THEN ISSUE_IND ELSE 0 END) AS "15 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 16 THEN ISSUE_IND ELSE 0 END) AS "16 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 17 THEN ISSUE_IND ELSE 0 END) AS "17 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 18 THEN ISSUE_IND ELSE 0 END) AS "18 ISSUE",sum(case when Datediff(month,QUOTE_DT,sysdate())= 19 THEN ISSUE_IND ELSE 0 END) AS "19 ISSUE",
nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 1 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG > 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "01 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 2 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG > 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "02 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 3 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "03 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 4 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "04 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 5 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "05 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 6 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "06 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 7 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "07 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 8 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "08 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 9 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "09 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 10 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "10 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 11 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "11 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 12 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "12 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 13 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "13 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 14 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "14 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 15 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "15 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 16 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "16 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 17 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "17 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 18 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "18 HIGAVG",nullifzero(AVG((case when Datediff(month,QUOTE_DT,sysdate())= 19 and SUCCESS_IND = 1 AND CARRIERSQUOTED > 2 and AVG_PREMIUM_XHIG> 0 THEN (ANNUALIZEDPREMIUM/AVG_PREMIUM_XHIG) else null end))) as "19 HIGAVG"

 ,TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF FROM "DSC_PLBI_DB"."APP_AGCY_PRD"."AGCY_COMP_RATER_FUNNEL_VW"  group by Key order by Key);