WITH ins_score AS -- Segmenting indicator counts by CW insurance score
(
	SELECT CONCAT('CW',BU_ABBR,'Ins Score Decile',(																								
    CASE WHEN INS_SCR_CD in (000,0,999)  then 'NHNS'																								
         WHEN INS_SCR_CD <= 386 then 'Decile 10 Worst'																								
         WHEN INS_SCR_CD <= 460 then 'Decile 09'																								
         WHEN INS_SCR_CD <= 539 then 'Decile 08'																								
         WHEN INS_SCR_CD <= 617 then 'Decile 07'																								
         WHEN INS_SCR_CD <= 679 then 'Decile 06'																								
         WHEN INS_SCR_CD <= 724 then 'Decile 05'																								
         WHEN INS_SCR_CD <= 756 then 'Decile 04'																								
         WHEN INS_SCR_CD <= 782 then 'Decile 03'																								
         WHEN INS_SCR_CD <= 809 then 'Decile 02'																								
         WHEN INS_SCR_CD <= 980 then 'Decile 01 Best' else 'NHNS' end)) AS Key,
    -- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

household_comp AS -- Segmenting indicator counts by CW household comp
(
	SELECT CONCAT('CW',BU_ABBR,'HH Comp',(																								
	CASE WHEN HH_COMPOS_PPV_CD IN ('SC1D') THEN 'a. single vehicle, 1 driver'																								
		 WHEN  HH_COMPOS_PPV_CD IN ('MC C=D') THEN 'd. multi vehicle, vehicle = driver'																								
		 WHEN  HH_COMPOS_PPV_CD IN ('SCMT1D') THEN 'b. single vehicle, more than 1 driver' 																								
		 WHEN  HH_COMPOS_PPV_CD IN ('MCMCTD') THEN 'c. multi vehicle, vehicle > drivers' 																								
		 WHEN  HH_COMPOS_PPV_CD IN ('MCMDTC') THEN 'e. multi vehicle, vehicle < drivers' 																								
		 WHEN  HH_COMPOS_PPV_CD IN ('0 CARS') THEN 'f. 0 vehicle'																								
		 ELSE 'g. other' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

clean_dirty AS -- Segmenting indicator counts by CW Clean/Dirty
(
	SELECT CONCAT('CW',BU_ABBR,'CLEAN DIRTY DESC',CLEAN_DIRTY_DESC) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

max_age_group AS -- Segmenting indicator counts by CW max age
(
	SELECT CONCAT('CW',BU_ABBR,'Max Age Group',(																								
	CASE WHEN POL_RATE_DRVR_MAX_AGE < 50 THEN '50'																								
		 WHEN POL_RATE_DRVR_MAX_AGE <= 59 THEN '50-59' 																								
		 WHEN POL_RATE_DRVR_MAX_AGE <= 69 THEN '50-69' 																								
		 WHEN POL_RATE_DRVR_MAX_AGE <= 79 THEN '70-79' 																								
		 WHEN POL_RATE_DRVR_MAX_AGE <= 130 THEN '80+'
		 ELSE 'Unknown' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

min_age_group AS -- Segmenting indicator counts by CW min age
(
	SELECT CONCAT('CW',BU_ABBR,'Min Age Group',(																								
	CASE WHEN POL_RATE_DRVR_MIN_AGE < 50 THEN '50'																								
		 WHEN POL_RATE_DRVR_MIN_AGE <= 59 THEN '50-59' 																								
		 WHEN POL_RATE_DRVR_MIN_AGE <= 69 THEN '50-69' 																								
		 WHEN POL_RATE_DRVR_MIN_AGE <= 79 THEN '70-79' 																								
		 WHEN POL_RATE_DRVR_MIN_AGE <= 130 THEN '80+'
		 ELSE 'Unknown' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

max_minus_min AS -- Segmenting indicator counts by CW max-min age
(
	SELECT CONCAT('CW',BU_ABBR,'Max Minus Min Age Group',(																								
	CASE WHEN POL_RATE_DRVR_MAX_AGE - POL_RATE_DRVR_MIN_AGE = 0 THEN 'a. 0'
		 WHEN POL_RATE_DRVR_MAX_AGE - POL_RATE_DRVR_MIN_AGE BETWEEN 1 AND 2 THEN 'b. 1-2'
		 WHEN POL_RATE_DRVR_MAX_AGE - POL_RATE_DRVR_MIN_AGE BETWEEN 3 AND 6 THEN 'c. 3-6'
		 WHEN POL_RATE_DRVR_MAX_AGE - POL_RATE_DRVR_MIN_AGE BETWEEN 7 AND 20 THEN 'd. 7-20'
		 WHEN POL_RATE_DRVR_MAX_AGE - POL_RATE_DRVR_MIN_AGE >= 21 THEN 'e. 21+'																							
		 ELSE 'f. n/a' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key	 
),

pcarr_yr_cnt AS -- Segmenting indicator counts by CW pcarr year count
(
	SELECT CONCAT('CW',BU_ABBR,'PCARR YR CNT',(																								
	CASE WHEN PCARR_YR_CNT = 0.5 THEN 'a 0.5'																								
		 WHEN PCARR_YR_CNT = 1.0 THEN 'b 1' 																								
		 WHEN PCARR_YR_CNT = 2.0 THEN 'c 2' 																								
		 WHEN PCARR_YR_CNT = 3.0 THEN 'd 3' 																								
		 WHEN PCARR_YR_CNT = 4.0 THEN 'e 4' 																								
		 WHEN PCARR_YR_CNT = 5.0 THEN 'f 5+' 																								
		 ELSE 'g Unknown' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

account_credit AS -- Segmenting indicator counts by CW account credit
(
	SELECT CONCAT('CW',BU_ABBR,'POL ACCT CR IND', POL_ACCT_CR_IND) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

pol_coverage_pkg AS -- Segmenting indicator counts by CW policy coverage package
(
	SELECT CONCAT('CW',BU_ABBR,'POL COV PKG CD',(																								
	CASE WHEN POL_COV_PKG_CD IS NULL OR POL_COV_PKG_CD = 'NO COV' THEN 'Unknown'
		 ELSE POL_COV_PKG_CD END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

pcarr AS -- Segmenting indicator counts by CW prior carrier
(
	SELECT CONCAT('CW',BU_ABBR,'Prior Carrier',(																								
    CASE WHEN PCARR_DESC IN ('STATE FARM INSURANCE') THEN 'STATE FARM'
		 WHEN PCARR_DESC IN ('IMPERIAL FIRE AND CA','SAFE AUTO INS CO','ALLSTATE CTY MUTUAL','ALLSTATE FIRE CAS IN','ALLSTATE INDEMNITY C','ALLSTATE INSURANCE C','ALLSTATE OF NEW JERS','ALLSTATE PROPERTY',
		 'ANJP C INS CO','CENTURY NATIONAL INS','CENTURY-NATIONAL INS','DIRECT GENERAL INS','DIRECT GENERAL INSUR','DIRECT INSURANCE CO','DIRECT INSURANCE COM','DIRECT NATIONAL INSU','ENCOM H A INS COMP',
		 'ENCOM INDEPENDENT IN','ENCOM INS CO OF NJ','ENCOM P C COMP','ENCOMPASS INDEMNITY','ENCOMPASS INS OF AM','ENCOMPASS INSURANCE','ENCOMPASS P C OF NJ','ESURANCE INS CO','ESURANCE INS CO NJ','ESURANCE PROP CAS',
		 'IMPERIAL FIRE CASU','INTEGON CASUALTY INS','INTEGON GENERAL INSU','INTEGON INDEMNITY CO','INTEGON NATIONAL','INTEGON NATIONAL INS','INTEGON PREFERRED IN','MIC GENERAL INSURANC','MS-DIRECT GENERAL IN',
		 'NATIONAL FARMERS UNI','NATIONAL GENERAL ASS','NATIONAL GENERAL INS','NATIONAL GENERAL PRE','NEW SOUTH INSURANCE','NORTHBROOK INSURANCE','STANDARD PROPERTY AN') THEN 'ALLSTATE'
		 WHEN PCARR_DESC IN ('GEICO ADVANTAGE INS','GEICO CASUALTY COMP','GEICO CHOICE INS CO','GEICO COUNTY MTL','GEICO GENERAL INS CO','GEICO INDEMNITY COMP','GEICO SECURE INS CO','GEICOTXCOUNTYMUTUAL',
		 'GOVERNMENT EMP INSCO','SOUTHERN COUNTY') THEN 'GEICO'
		 WHEN PCARR_DESC IN ('PROGRESSIVE GROUPS') THEN 'PROGRESSIVE'
		 WHEN PCARR_DESC IN ('EMPLOYERS INSURANCE','FIRST NAT INS CO AME','GENERAL INS CO AMER','LIB MUTUAL PERSONAL','LIBERTY COUNTY MUTUA','LIBERTY INSURANCE CO','LIBERTY MUTUAL FIRE','LIBERTY MUTUAL INSUR',
		 'LIBERTY MUTUAL MID A','LIBERTY PERSONAL INS','LM GENERAL INSURANCE','LM INSURANCE CORPORA','MERIDIAN SECURITY','MERIDIAN SECURITY IN','MILBANK INSURANCE CO','MONTGOMERY MUTUAL IN','PATRONS MUTUAL INS C',
		 'PEERLESS INDEMNITY I','SAFECO INS CO AMER','SAFECO INSUR CO ILL','SAFECO INSUR CO IND','SAFECO INSUR CO ORE','SAFECO LLOYDS INS CO','SAFECO NAT INSUR CO','SAIC OF OHIO','SAIC OF WISCONSIN','STATE AUTO MUTUAL',
		 'STATE AUTO P C INS','STATE AUTO PROP C','STATE AUTOMOBILE MUT','THE FIRST LIBERTY IN','THE NETHERLANDS INSU','WAUSAU UNDERWRITERS','AMER ECONOMY INS CO','AMER STATES INSUR CO','AMER STATES PREF INS',
		 'AMERICA FIRST INSURA','CONSOLIDATED INSURAN') THEN 'LIBERTY'
		 WHEN PCARR_DESC IN ('FID GUAR INS UNDRS','PHOENIX INSURANCE CO','ST PAUL PROTECTIVE I','STANDARD FIRE INS CO','TRAVCO INSURANCE CO','TRAVELERS CAS CONN','TRAVELERS COMMERCIAL','TRAVELERS HOME MAR',
		 'TRAVELERS INDEM AMER','TRAVELERS INDEM CONN','TRAVELERS INDEMNITY','TRAVELERS P C INS CO','TRAVELERS P C OF AM','TRAVELERS PERSON SEC','TRAVELERS PERSONAL','AUTO INS CO OF HARTF',
		 'CHARTER OAK FIRE INS','FIRST FLORIDIAN A H') THEN 'TRAVELERS'
		 WHEN PCARR_DESC IN ('AMFAM CONNECT INS', 'AMFAM CONNECT PC', 'AMFAM INS CO', 'AMER FAMILY MUTUAL', 'AMERICAN STD INS OH', 'THE GENERAL AUTOMOBI', 'MIDVALE INDEMNITY', 'AFMICSI', 'AMER STANDARD INS',
		 'AMERICAN FAM INS OH',	'AMERIPRISE INSURANCE',	'HOMESITE INSURANCE C',	'IDS PROPERTY CASUALT',	'MSAA',	'MSAA INSURANCE CO','MSAPIC','NGM INSURANCE CO','ODIC') THEN 'AMERICAN FAMILY'
		 WHEN PCARR_DESC IN ('USAA GENERAL IND CO','USAA CASUALTY INS CO','USAA','GARRISON PROP CAS','GAR') THEN 'USAA'																				
		 WHEN PCARR_DESC IN ('COLONIAL COUNTY MUT','ALLIED PROP CAS','ALLIED P C INS CO','COLONIAL COUNTY MUT','CRESTBROOK INSURANCE','DEPOSITORS INS CO',	
		 'NATIONWIDE AG INS CO', 'NATIONWIDE AGRI INS','NATIONWIDE GENERAL','NATIONWIDE INS CO','NATIONWIDE INS OF AM',	'NATIONWIDE MUT FIRE','NATIONWIDE MUT INS','NATIONWIDE MUTUAL IN',
		 'VICTORIA FIRE CASU',	'VICTORIA SPECIALTY I',	'AMCO INSURANCE CO',	'ALLIED P C INS CO',	'HARLEYSVILLEIC',	'HARLEYSVILLEPREFIC',	'NATIONWIDE AFFINITY',
		 'NATIONWIDE GENERAL',	'NATIONWIDE MUTUAL',	'NATIONWIDE PROP CAS',	'VICTORIA SELECT INSU') THEN 'Nationwide'
		 WHEN PCARR_DESC IS NULL  THEN 'NULL' 																								
		 WHEN PCARR_DESC IN ('NOT PRESENTLY INSURED', 'UNKNOWN', 'NO PRIOR INSURANCE') THEN PCARR_DESC
		 WHEN PCARR_DESC IN ( 'OTHER-NON STANDARD' , 'OTHER - NON STANDARD' ) THEN 'OTHER - NON STANDARD'
		 ELSE 'OTHER' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

ins_age AS -- Segmenting indicator counts by CW insured age
(
	SELECT CONCAT('CW',BU_ABBR,'Insured Age Group',(																								
	CASE WHEN DATEDIFF(YEAR,ACCT_DOB,POL_EFF_DT) -1 <= 49 THEN 'a. 25-49'																								
		 WHEN DATEDIFF(YEAR,ACCT_DOB,POL_EFF_DT) -1 <= 54 THEN 'b. 50-54'																								
		 WHEN DATEDIFF(YEAR,ACCT_DOB,POL_EFF_DT) -1 <= 59 THEN 'c. 55-59'																								
		 WHEN DATEDIFF(YEAR,ACCT_DOB,POL_EFF_DT) -1 <= 64 THEN 'd. 60-64'																								
		 WHEN DATEDIFF(YEAR,ACCT_DOB,POL_EFF_DT) -1 <= 69 THEN 'e. 65-69'																								
		 WHEN DATEDIFF(YEAR,ACCT_DOB,POL_EFF_DT) -1 <= 74 THEN 'f. 70-74'																								
		 WHEN DATEDIFF(YEAR,ACCT_DOB,POL_EFF_DT) -1 <= 79 THEN 'g. 75-79'																								
		 WHEN DATEDIFF(YEAR,ACCT_DOB,POL_EFF_DT) -1 <= 120 THEN 'h. 80+'																								
		 ELSE 'i. null' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

ppv_count AS -- Segmenting indicator counts by CW PPV count
(
	SELECT CONCAT('CW',BU_ABBR,'POL PPV CNT',(																								
	CASE WHEN POL_PPV_CNT = 1 THEN 'b 1' 																								
		 WHEN POL_PPV_CNT = 2 THEN 'c 2' 																								
		 WHEN POL_PPV_CNT = 3 THEN 'd 3' 																								
		 WHEN POL_PPV_CNT = 4 THEN 'e 4' 																								
		 WHEN POL_PPV_CNT = 5 THEN 'f 5+' 																								
		 ELSE 'g Unknown' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

telematics AS -- Segmenting indicator counts by CW telematics indicator
(
	SELECT CONCAT('CW',BU_ABBR,'Pol drvr tlmtc enrol ind',Pol_drvr_tlmtc_enrol_ind) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

youthful AS -- Segmenting indicator counts by CW youthful indicator
(
	SELECT CONCAT('CW',BU_ABBR,'YOUTH OPER DRVR IND',YOUTH_OPER_DRVR_IND) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

garage_sub AS -- Segmenting indicator counts by CW garage substate
(
	SELECT CONCAT('CW',BU_ABBR,'GARAGE SUBSTATE',(																								
	CASE WHEN LEFT(RISK_ST_ABBR,2) = LEFT(GARAGE_SUBSTATE,2) THEN GARAGE_SUBSTATE
	ELSE 'Out of State Mail' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	LEFT JOIN (SELECT ZIP_CODE, STATE_ABBR, GARAGE_SUBSTATE FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."STATE_PRODUCT_SUBSTATE") t7
	ON t7.ZIP_CODE = LEFT(MAIL_ADDR_FULL_ZIP_CD,5)	
    WHERE COMPL_QTE_IND = 'Y'
    GROUP BY Key
),

prior_bi AS -- Segmenting indicator counts by CW prior BI per person
(
	SELECT CONCAT('CW',BU_ABBR,'Prior BI Per Person',(																								
	CASE WHEN PCARR_BI_PERS_LMT_CD < 50 THEN 'a. Less than 50'																								
		 WHEN PCARR_BI_PERS_LMT_CD < 100 THEN 'b. 50-99'																								
		 WHEN PCARR_BI_PERS_LMT_CD < 250 THEN 'c. 100-249' 																								
		 WHEN PCARR_BI_PERS_LMT_CD < 3000 THEN 'd. 250+' 																								
		 WHEN PCARR_BI_PERS_LMT_CD IS NULL THEN 'f. Unknown/No Insurance'
		 ELSE 'e. other' END)) AS Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

aarp_member AS -- Segmenting indicator counts by CW AARP member status
(
	SELECT CONCAT('CW',BU_ABBR,'AARP Member Status',AARP_MEMB_STAT_DESC) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

aqd_group AS -- Segmenting indicator counts by CW AQD group
(
	SELECT CONCAT('CW',BU_ABBR,'Advanced Quote Discount',(																								
    CASE WHEN ADV_QTE_DAY_CNT IN (000,0,999) THEN 'A. 0 Days'																								
		 WHEN ADV_QTE_DAY_CNT <= 13 THEN 'B. 1-13'																								
		 WHEN ADV_QTE_DAY_CNT <= 60 THEN 'C. 14-60'																								
		 WHEN ADV_QTE_DAY_CNT <= 75 THEN 'D. 61-75'																								
		 WHEN ADV_QTE_DAY_CNT <= 99999 THEN 'E. 76+'																								
		 ELSE 'F. Unknown' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

renew_uw AS -- Segmenting indicator counts by CW renewal UW tier
(
	SELECT CONCAT('CW',BU_ABBR,'RENEW UW TIER',(																								
	CASE WHEN RENEW_UW_TIER_CD IN ('BB','BC','BD','BE','BF','BG','BH','BI','BJ','BK') THEN RENEW_UW_TIER_CD
		 ELSE 'Other' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

min_rating_factor AS -- Segmenting indicator counts by CW min rating factor
(
	SELECT CONCAT('CW',BU_ABBR,'Min Rating Factor',POL_MIN_RATE_FCTR_IND) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

max_veh_age AS -- Segmenting indicator counts by CW max vehicle age
(
	SELECT CONCAT('CW',BU_ABBR,'Max Veh Age',(																								
	CASE WHEN POL_MAX_VEH_AGE <= 3 THEN '0-3'
		 WHEN POL_MAX_VEH_AGE <= 6 THEN '4-6'
		 WHEN POL_MAX_VEH_AGE <= 9 THEN '7-9'
		 WHEN POL_MAX_VEH_AGE <= 14 THEN '10-14' 																								
		 WHEN POL_MAX_VEH_AGE <= 19 THEN '15-19'
		 WHEN POL_MAX_VEH_AGE <= 24 THEN '20-24' 																								
		 WHEN POL_MAX_VEH_AGE > 24 THEN '25+'  																								
		 ELSE 'Other' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

pol_mult_single AS -- Segmenting indicator counts by CW multi-single vehicle code
(
	SELECT CONCAT('CW',BU_ABBR,'POL MULTI SNGL VEH CD',(																								
	CASE WHEN POL_MULTI_SNGL_VEH_CD IS NULL THEN 'S'
		 ELSE POL_MULTI_SNGL_VEH_CD END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

mature_driving_course AS -- Segmenting indicator counts by CW mature driving indicator
(
	SELECT CONCAT('CW',BU_ABBR,'Mature Driving Course',(																								
	CASE WHEN POL_MATUR_DRVNG_COURS_CR_IND = 'Y' THEN 'Y'
		 ELSE 'N' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

incident_free AS -- Segmenting indicator counts by CW incident free year count
(
	SELECT CONCAT('CW',BU_ABBR,'Incident Free Year Count',(																								
	CASE WHEN POL_INCID_FREE_YR_CNT = 0 THEN '0'																								
		 WHEN POL_INCID_FREE_YR_CNT = 1 THEN '1'																								
		 WHEN POL_INCID_FREE_YR_CNT = 2 THEN '2' 																								
		 WHEN POL_INCID_FREE_YR_CNT = 3 THEN '3' 																								
		 WHEN POL_INCID_FREE_YR_CNT = 4 THEN '4' 																								
		 WHEN POL_INCID_FREE_YR_CNT = 5 THEN '5' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

naf_accidents AS -- Segmenting indicator counts by CW NAF accident count
(
	SELECT CONCAT('CW',BU_ABBR,'NAF Accident Count',(																								
	CASE WHEN PCARR_POL_NAF_ACCID_CNT = 0 THEN '0'																								
		 WHEN PCARR_POL_NAF_ACCID_CNT = 1 THEN '1'																								
		 WHEN PCARR_POL_NAF_ACCID_CNT > 1 THEN '2+' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

incident_mo_age AS -- Segmenting indicator counts by CW incident month age
(
	SELECT CONCAT('CW',BU_ABBR,'Incident Month Age',(																								
	CASE WHEN POL_INCID_MO_AGE <= 12 THEN '1-12'																								
		 WHEN POL_INCID_MO_AGE <= 24 THEN '13-24'																								
		 WHEN POL_INCID_MO_AGE <= 36 THEN '25-36'																								
		 WHEN POL_INCID_MO_AGE <= 48 THEN '37-48'																								
		 WHEN POL_INCID_MO_AGE <= 60 THEN '49-60' 																								
		 WHEN POL_INCID_MO_AGE = 61 THEN '61' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

region_ins_score AS -- Segmenting indicator counts by region insurance score
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'Ins Score Decile',(																								
    CASE WHEN INS_SCR_CD IN (000,0,999) THEN 'NHNS'																								
         WHEN INS_SCR_CD <= 386 THEN 'Decile 10 Worst'																								
         WHEN INS_SCR_CD <= 460 THEN 'Decile 09'																								
         WHEN INS_SCR_CD <= 539 THEN 'Decile 08'																								
         WHEN INS_SCR_CD <= 617 THEN 'Decile 07'																								
         WHEN INS_SCR_CD <= 679 THEN 'Decile 06'																								
         WHEN INS_SCR_CD <= 724 THEN 'Decile 05'																								
         WHEN INS_SCR_CD <= 756 THEN 'Decile 04'																								
         WHEN INS_SCR_CD <= 782 THEN 'Decile 03'																								
         WHEN INS_SCR_CD <= 809 THEN 'Decile 02'																								
         WHEN INS_SCR_CD <= 980 THEN 'Decile 01 Best'
		 ELSE 'NHNS' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

region_hh_comp AS -- Segmenting indicator counts by region household comp
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'HH Comp',(																								
	CASE WHEN HH_COMPOS_PPV_CD IN ('SC1D') THEN 'a. single vehicle, 1 driver'																								
		 WHEN HH_COMPOS_PPV_CD IN ('MC C=D') THEN 'd. multi vehicle, vehicle = driver'																								
		 WHEN HH_COMPOS_PPV_CD IN ('SCMT1D') THEN 'b. single vehicle, more than 1 driver' 																								
		 WHEN HH_COMPOS_PPV_CD IN ('MCMCTD') THEN 'c. multi vehicle, vehicle > drivers' 																								
		 WHEN HH_COMPOS_PPV_CD IN ('MCMDTC') THEN 'e. multi vehicle, vehicle < drivers' 																								
		 WHEN HH_COMPOS_PPV_CD IN ('0 CARS') THEN 'f. 0 vehicle'							
		 ELSE 'g. other' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

region_clean_dirty AS -- Segmenting indicator counts by region clean dirty code
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'CLEAN DIRTY DESC', CLEAN_DIRTY_DESC) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

region_max_age_group AS -- Segmenting indicator counts by region max age
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'Max Age Group',(																								
	CASE WHEN POL_RATE_DRVR_MAX_AGE < 50 THEN '50'																								
		 WHEN POL_RATE_DRVR_MAX_AGE <= 59 THEN '50-59' 																								
		 WHEN POL_RATE_DRVR_MAX_AGE <= 69 THEN '50-69' 																								
		 WHEN POL_RATE_DRVR_MAX_AGE <= 79 THEN '70-79' 																								
		 WHEN POL_RATE_DRVR_MAX_AGE <= 130 THEN '80+'
		 ELSE 'Unknown' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

region_min_age_group AS -- Segmenting indicator counts by region min age
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'Min Age Group',(																								
	CASE WHEN POL_RATE_DRVR_MIN_AGE < 50 THEN '50'																								
		 WHEN POL_RATE_DRVR_MIN_AGE <= 59 THEN '50-59' 																								
		 WHEN POL_RATE_DRVR_MIN_AGE <= 69 THEN '50-69' 																								
		 WHEN POL_RATE_DRVR_MIN_AGE <= 79 THEN '70-79' 																								
		 WHEN POL_RATE_DRVR_MIN_AGE <= 130 THEN '80+'
		 ELSE 'Unknown' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

region_max_minus_min AS -- Segmenting indicator counts by region max-min age
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'Max Minus Min Age Group',(																								
	CASE WHEN POL_RATE_DRVR_MAX_AGE - POL_RATE_DRVR_MIN_AGE = 0 THEN 'a. 0'
		 WHEN POL_RATE_DRVR_MAX_AGE - POL_RATE_DRVR_MIN_AGE BETWEEN 1 AND 2 THEN 'b. 1-2'
		 WHEN POL_RATE_DRVR_MAX_AGE - POL_RATE_DRVR_MIN_AGE BETWEEN 3 AND 6 THEN 'c. 3-6'
		 WHEN POL_RATE_DRVR_MAX_AGE - POL_RATE_DRVR_MIN_AGE BETWEEN 7 AND 20 THEN 'd. 7-20'
		 WHEN POL_RATE_DRVR_MAX_AGE - POL_RATE_DRVR_MIN_AGE >= 21 THEN 'e. 21+'																							
		 ELSE 'f. n/a' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key	 
),

region_pcarr_yr_cnt AS -- Segmenting indicator counts by region pcarr year count
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'PCARR YR CNT',(																								
	CASE WHEN PCARR_YR_CNT = 0.5 THEN 'a 0.5'																								
		 WHEN PCARR_YR_CNT = 1.0 THEN 'b 1' 																								
		 WHEN PCARR_YR_CNT = 2.0 THEN 'c 2' 																								
		 WHEN PCARR_YR_CNT = 3.0 THEN 'd 3' 																								
		 WHEN PCARR_YR_CNT = 4.0 THEN 'e 4' 																								
		 WHEN PCARR_YR_CNT = 5.0 THEN 'f 5+' 																								
		 ELSE 'g Unknown' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

region_account_credit AS -- Segmenting indicator counts by region account credit
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'POL ACCT CR IND', POL_ACCT_CR_IND) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

region_pol_coverage_pkg AS -- Segmenting indicator counts by region policy coverage package
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'POL COV PKG CD',(																								
	CASE WHEN POL_COV_PKG_CD IS NULL OR POL_COV_PKG_CD = 'NO COV' THEN 'Unknown'
		 ELSE POL_COV_PKG_CD END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

region_pcarr AS -- Segmenting indicator counts by region prior carrier
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'Prior Carrier',(																								
    CASE WHEN PCARR_DESC IN ('STATE FARM INSURANCE') THEN 'STATE FARM'
		 WHEN PCARR_DESC IN ('IMPERIAL FIRE AND CA','SAFE AUTO INS CO','ALLSTATE CTY MUTUAL','ALLSTATE FIRE CAS IN','ALLSTATE INDEMNITY C','ALLSTATE INSURANCE C','ALLSTATE OF NEW JERS','ALLSTATE PROPERTY',
		 'ANJP C INS CO','CENTURY NATIONAL INS','CENTURY-NATIONAL INS','DIRECT GENERAL INS','DIRECT GENERAL INSUR','DIRECT INSURANCE CO','DIRECT INSURANCE COM','DIRECT NATIONAL INSU','ENCOM H A INS COMP',
		 'ENCOM INDEPENDENT IN','ENCOM INS CO OF NJ','ENCOM P C COMP','ENCOMPASS INDEMNITY','ENCOMPASS INS OF AM','ENCOMPASS INSURANCE','ENCOMPASS P C OF NJ','ESURANCE INS CO','ESURANCE INS CO NJ','ESURANCE PROP CAS',
		 'IMPERIAL FIRE CASU','INTEGON CASUALTY INS','INTEGON GENERAL INSU','INTEGON INDEMNITY CO','INTEGON NATIONAL','INTEGON NATIONAL INS','INTEGON PREFERRED IN','MIC GENERAL INSURANC','MS-DIRECT GENERAL IN',
		 'NATIONAL FARMERS UNI','NATIONAL GENERAL ASS','NATIONAL GENERAL INS','NATIONAL GENERAL PRE','NEW SOUTH INSURANCE','NORTHBROOK INSURANCE','STANDARD PROPERTY AN') THEN 'ALLSTATE'
		 WHEN PCARR_DESC IN ('GEICO ADVANTAGE INS','GEICO CASUALTY COMP','GEICO CHOICE INS CO','GEICO COUNTY MTL','GEICO GENERAL INS CO','GEICO INDEMNITY COMP','GEICO SECURE INS CO','GEICOTXCOUNTYMUTUAL',
		 'GOVERNMENT EMP INSCO','SOUTHERN COUNTY') THEN 'GEICO'
		 WHEN PCARR_DESC IN ('PROGRESSIVE GROUPS') THEN 'PROGRESSIVE'
		 WHEN PCARR_DESC IN ('EMPLOYERS INSURANCE','FIRST NAT INS CO AME','GENERAL INS CO AMER','LIB MUTUAL PERSONAL','LIBERTY COUNTY MUTUA','LIBERTY INSURANCE CO','LIBERTY MUTUAL FIRE','LIBERTY MUTUAL INSUR',
		 'LIBERTY MUTUAL MID A','LIBERTY PERSONAL INS','LM GENERAL INSURANCE','LM INSURANCE CORPORA','MERIDIAN SECURITY','MERIDIAN SECURITY IN','MILBANK INSURANCE CO','MONTGOMERY MUTUAL IN','PATRONS MUTUAL INS C',
		 'PEERLESS INDEMNITY I','SAFECO INS CO AMER','SAFECO INSUR CO ILL','SAFECO INSUR CO IND','SAFECO INSUR CO ORE','SAFECO LLOYDS INS CO','SAFECO NAT INSUR CO','SAIC OF OHIO','SAIC OF WISCONSIN','STATE AUTO MUTUAL',
		 'STATE AUTO P C INS','STATE AUTO PROP C','STATE AUTOMOBILE MUT','THE FIRST LIBERTY IN','THE NETHERLANDS INSU','WAUSAU UNDERWRITERS','AMER ECONOMY INS CO','AMER STATES INSUR CO','AMER STATES PREF INS',
		 'AMERICA FIRST INSURA','CONSOLIDATED INSURAN') THEN 'LIBERTY'
		 WHEN PCARR_DESC IN ('FID GUAR INS UNDRS','PHOENIX INSURANCE CO','ST PAUL PROTECTIVE I','STANDARD FIRE INS CO','TRAVCO INSURANCE CO','TRAVELERS CAS CONN','TRAVELERS COMMERCIAL','TRAVELERS HOME MAR',
		 'TRAVELERS INDEM AMER','TRAVELERS INDEM CONN','TRAVELERS INDEMNITY','TRAVELERS P C INS CO','TRAVELERS P C OF AM','TRAVELERS PERSON SEC','TRAVELERS PERSONAL','AUTO INS CO OF HARTF',
		 'CHARTER OAK FIRE INS','FIRST FLORIDIAN A H') THEN 'TRAVELERS'
		 WHEN PCARR_DESC IN ('AMFAM CONNECT INS', 'AMFAM CONNECT PC', 'AMFAM INS CO', 'AMER FAMILY MUTUAL', 'AMERICAN STD INS OH', 'THE GENERAL AUTOMOBI', 'MIDVALE INDEMNITY', 'AFMICSI', 'AMER STANDARD INS',
		 'AMERICAN FAM INS OH',	'AMERIPRISE INSURANCE',	'HOMESITE INSURANCE C',	'IDS PROPERTY CASUALT',	'MSAA',	'MSAA INSURANCE CO','MSAPIC','NGM INSURANCE CO','ODIC') THEN 'AMERICAN FAMILY'
		 WHEN PCARR_DESC IN ('USAA GENERAL IND CO','USAA CASUALTY INS CO','USAA','GARRISON PROP CAS','GAR') THEN 'USAA'																				
		 WHEN PCARR_DESC IN ('COLONIAL COUNTY MUT','ALLIED PROP CAS','ALLIED P C INS CO','COLONIAL COUNTY MUT','CRESTBROOK INSURANCE','DEPOSITORS INS CO',	
		 'NATIONWIDE AG INS CO', 'NATIONWIDE AGRI INS','NATIONWIDE GENERAL','NATIONWIDE INS CO','NATIONWIDE INS OF AM',	'NATIONWIDE MUT FIRE','NATIONWIDE MUT INS','NATIONWIDE MUTUAL IN',
		 'VICTORIA FIRE CASU',	'VICTORIA SPECIALTY I',	'AMCO INSURANCE CO',	'ALLIED P C INS CO',	'HARLEYSVILLEIC',	'HARLEYSVILLEPREFIC',	'NATIONWIDE AFFINITY',
		 'NATIONWIDE GENERAL',	'NATIONWIDE MUTUAL',	'NATIONWIDE PROP CAS',	'VICTORIA SELECT INSU') THEN 'Nationwide'
		 WHEN PCARR_DESC IS NULL  THEN 'NULL' 																								
		 WHEN PCARR_DESC IN ('NOT PRESENTLY INSURED', 'UNKNOWN', 'NO PRIOR INSURANCE') THEN PCARR_DESC
		 WHEN PCARR_DESC IN ( 'OTHER-NON STANDARD' , 'OTHER - NON STANDARD' ) THEN 'OTHER - NON STANDARD'
		 ELSE 'OTHER' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

region_ins_age AS -- Segmenting indicator counts by region insured age
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'Insured Age Group',(																								
	CASE WHEN DATEDIFF(YEAR,ACCT_DOB,POL_EFF_DT) -1 <= 49 THEN 'a. 25-49'																								
		 WHEN DATEDIFF(YEAR,ACCT_DOB,POL_EFF_DT) -1 <= 54 THEN 'b. 50-54'																								
		 WHEN DATEDIFF(YEAR,ACCT_DOB,POL_EFF_DT) -1 <= 59 THEN 'c. 55-59'																								
		 WHEN DATEDIFF(YEAR,ACCT_DOB,POL_EFF_DT) -1 <= 64 THEN 'd. 60-64'																								
		 WHEN DATEDIFF(YEAR,ACCT_DOB,POL_EFF_DT) -1 <= 69 THEN 'e. 65-69'																								
		 WHEN DATEDIFF(YEAR,ACCT_DOB,POL_EFF_DT) -1 <= 74 THEN 'f. 70-74'																								
		 WHEN DATEDIFF(YEAR,ACCT_DOB,POL_EFF_DT) -1 <= 79 THEN 'g. 75-79'																								
		 WHEN DATEDIFF(YEAR,ACCT_DOB,POL_EFF_DT) -1 <= 120 THEN 'h. 80+'																								
		 ELSE 'i. null' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

region_ppv_count AS -- Segmenting indicator counts by region PPV count
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'POL PPV CNT',(																								
	CASE WHEN POL_PPV_CNT = 1 THEN 'b 1' 																								
		 WHEN POL_PPV_CNT = 2 THEN 'c 2' 																								
		 WHEN POL_PPV_CNT = 3 THEN 'd 3' 																								
		 WHEN POL_PPV_CNT = 4 THEN 'e 4' 																								
		 WHEN POL_PPV_CNT = 5 THEN 'f 5+' 																								
		 ELSE 'g Unknown' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

region_telematics AS -- Segmenting indicator counts by region telematics indicator
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'Pol drvr tlmtc enrol ind',Pol_drvr_tlmtc_enrol_ind) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

region_youthful AS -- Segmenting indicator counts by region youthful indicator
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'YOUTH OPER DRVR IND',YOUTH_OPER_DRVR_IND) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

region_garage_sub AS -- Segmenting indicator counts by region garage substate
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'GARAGE SUBSTATE',(																								
	CASE WHEN LEFT(RISK_ST_ABBR,2) = LEFT(GARAGE_SUBSTATE,2) THEN GARAGE_SUBSTATE
	ELSE 'Out of State Mail' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	LEFT JOIN (SELECT ZIP_CODE, STATE_ABBR, GARAGE_SUBSTATE FROM "DSC_PLBI_DB"."APP_AUTO_PRD"."STATE_PRODUCT_SUBSTATE") t7
	ON t7.ZIP_CODE = LEFT(MAIL_ADDR_FULL_ZIP_CD,5)	
    WHERE COMPL_QTE_IND = 'Y'
    GROUP BY Key
),

region_prior_bi AS -- Segmenting indicator counts by region prior BI per person
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'Prior BI Per Person',(																								
	CASE WHEN PCARR_BI_PERS_LMT_CD < 50 THEN 'a. Less than 50'																								
		 WHEN PCARR_BI_PERS_LMT_CD < 100 THEN 'b. 50-99'																								
		 WHEN PCARR_BI_PERS_LMT_CD < 250 THEN 'c. 100-249' 																								
		 WHEN PCARR_BI_PERS_LMT_CD < 3000 THEN 'd. 250+' 																								
		 WHEN PCARR_BI_PERS_LMT_CD IS NULL THEN 'f. Unknown/No Insurance'
		 ELSE 'e. other' END)) AS Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

region_aarp_member AS -- Segmenting indicator counts by region AARP member status
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'AARP Member Status',AARP_MEMB_STAT_DESC) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

region_aqd_group AS -- Segmenting indicator counts by region AQD group
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'Advanced Quote Discount',(																								
    CASE WHEN ADV_QTE_DAY_CNT IN (000,0,999) THEN 'A. 0 Days'																								
		 WHEN ADV_QTE_DAY_CNT <= 13 THEN 'B. 1-13'																								
		 WHEN ADV_QTE_DAY_CNT <= 60 THEN 'C. 14-60'																								
		 WHEN ADV_QTE_DAY_CNT <= 75 THEN 'D. 61-75'																								
		 WHEN ADV_QTE_DAY_CNT <= 99999 THEN 'E. 76+'																								
		 ELSE 'F. Unknown' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

region_renew_uw AS -- Segmenting indicator counts by region renewal UW tier
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'RENEW UW TIER',(																								
	CASE WHEN RENEW_UW_TIER_CD IN ('BB','BC','BD','BE','BF','BG','BH','BI','BJ','BK') THEN RENEW_UW_TIER_CD
		 ELSE 'Other' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

region_min_rating_factor AS -- Segmenting indicator counts by region min rating factor
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'Min Rating Factor',POL_MIN_RATE_FCTR_IND) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

region_max_veh_age AS -- Segmenting indicator counts by region max vehicle age
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'Max Veh Age',(																								
	CASE WHEN POL_MAX_VEH_AGE <= 3 THEN '0-3'
		 WHEN POL_MAX_VEH_AGE <= 6 THEN '4-6'
		 WHEN POL_MAX_VEH_AGE <= 9 THEN '7-9'
		 WHEN POL_MAX_VEH_AGE <= 14 THEN '10-14' 																								
		 WHEN POL_MAX_VEH_AGE <= 19 THEN '15-19'
		 WHEN POL_MAX_VEH_AGE <= 24 THEN '20-24' 																								
		 WHEN POL_MAX_VEH_AGE > 24 THEN '25+'  																								
		 ELSE 'Other' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

region_pol_mult_single AS -- Segmenting indicator counts by region multi-single vehicle code
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'POL MULTI SNGL VEH CD',(																								
	CASE WHEN POL_MULTI_SNGL_VEH_CD IS NULL THEN 'S'
		 ELSE POL_MULTI_SNGL_VEH_CD END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

region_mature_driving_course AS -- Segmenting indicator counts by region mature driving indicator
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'Mature Driving Course',(																								
	CASE WHEN POL_MATUR_DRVNG_COURS_CR_IND = 'Y' THEN 'Y'
		 ELSE 'N' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

region_incident_free AS -- Segmenting indicator counts by region incident free year count
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'Incident Free Year Count',(																								
	CASE WHEN POL_INCID_FREE_YR_CNT = 0 THEN '0'																								
		 WHEN POL_INCID_FREE_YR_CNT = 1 THEN '1'																								
		 WHEN POL_INCID_FREE_YR_CNT = 2 THEN '2' 																								
		 WHEN POL_INCID_FREE_YR_CNT = 3 THEN '3' 																								
		 WHEN POL_INCID_FREE_YR_CNT = 4 THEN '4' 																								
		 WHEN POL_INCID_FREE_YR_CNT = 5 THEN '5' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

region_naf_accidents AS -- Segmenting indicator counts by region NAF accident count
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'NAF Accident Count',(																								
	CASE WHEN PCARR_POL_NAF_ACCID_CNT = 0 THEN '0'																								
		 WHEN PCARR_POL_NAF_ACCID_CNT = 1 THEN '1'																								
		 WHEN PCARR_POL_NAF_ACCID_CNT > 1 THEN '2+' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
),

region_incident_mo_age AS -- Segmenting indicator counts by region incident month age
(
	SELECT CONCAT(GET_REGION_SCORECARD(RISK_ST_ABBR),'Incident Month Age',(																								
	CASE WHEN POL_INCID_MO_AGE <= 12 THEN '1-12'																								
		 WHEN POL_INCID_MO_AGE <= 24 THEN '13-24'																								
		 WHEN POL_INCID_MO_AGE <= 36 THEN '25-36'																								
		 WHEN POL_INCID_MO_AGE <= 48 THEN '37-48'																								
		 WHEN POL_INCID_MO_AGE <= 60 THEN '49-60' 																								
		 WHEN POL_INCID_MO_AGE = 61 THEN '61' END)) as Key,
	-- Total Completed Quotes
    zero_cond_scorecard(12, TRANS_DT, COMPL_QTE_IND_CNT) AS "12 Total CQ",
    zero_cond_scorecard(11, TRANS_DT, COMPL_QTE_IND_CNT) AS "11 Total CQ",
    zero_cond_scorecard(10, TRANS_DT, COMPL_QTE_IND_CNT) AS "10 Total CQ",
    zero_cond_scorecard(9, TRANS_DT, COMPL_QTE_IND_CNT) AS "9 Total CQ",
    zero_cond_scorecard(8, TRANS_DT, COMPL_QTE_IND_CNT) AS "8 Total CQ",
    zero_cond_scorecard(7, TRANS_DT, COMPL_QTE_IND_CNT) AS "7 Total CQ",
    zero_cond_scorecard(6, TRANS_DT, COMPL_QTE_IND_CNT) AS "6 Total CQ",
    zero_cond_scorecard(5, TRANS_DT, COMPL_QTE_IND_CNT) AS "5 Total CQ",
    zero_cond_scorecard(4, TRANS_DT, COMPL_QTE_IND_CNT) AS "4 Total CQ",
    zero_cond_scorecard(3, TRANS_DT, COMPL_QTE_IND_CNT) AS "3 Total CQ",
    zero_cond_scorecard(2, TRANS_DT, COMPL_QTE_IND_CNT) AS "2 Total CQ",
    zero_cond_scorecard(1, TRANS_DT, COMPL_QTE_IND_CNT) AS "1 Total CQ",
    zero_cond_scorecard(0, TRANS_DT, COMPL_QTE_IND_CNT) AS "0 Total CQ",
    -- Total Issues
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "12 Total I",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "11 Total I",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "10 Total I",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "9 Total I",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "8 Total I",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "7 Total I",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "6 Total I",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "5 Total I",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "4 Total I",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "3 Total I",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "2 Total I",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "1 Total I",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ISSUE_IND_CNT) AS "0 Total I",
    -- Total AQP
    zero_cond_scorecard(12, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AQP",
    zero_cond_scorecard(11, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AQP",
    zero_cond_scorecard(10, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AQP",
    zero_cond_scorecard(9, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AQP",
    zero_cond_scorecard(8, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AQP",
    zero_cond_scorecard(7, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AQP",
    zero_cond_scorecard(6, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AQP",
    zero_cond_scorecard(5, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AQP",
    zero_cond_scorecard(4, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AQP",
    zero_cond_scorecard(3, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AQP",
    zero_cond_scorecard(2, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AQP",
    zero_cond_scorecard(1, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AQP",
    zero_cond_scorecard(0, TRANS_DT, POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AQP",
    -- Total AIP
    one_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "12 Total AIP",
    one_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "11 Total AIP",
    one_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "10 Total AIP",
    one_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "9 Total AIP",
    one_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "8 Total AIP",
    one_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "7 Total AIP",
    one_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "6 Total AIP",
    one_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "5 Total AIP",
    one_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "4 Total AIP",
    one_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "3 Total AIP",
    one_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "2 Total AIP",
    one_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "1 Total AIP",
    one_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', POL_TTL_BILL_PREM_AMT * 2) AS "0 Total AIP",
    -- Total ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 12 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 11 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 10 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Total ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Total ULM",
    -- Phone HIGSRP
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=12 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT 
    ELSE NULL END)) AS "12 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=11 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "11 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())=10 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "10 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 9 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "9 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 8 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "8 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 7 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "7 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 6 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "6 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 5 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "5 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 4 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "4 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 3 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "3 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 2 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "2 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 1 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "1 Phone HIGSRP",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE())= 0 and COMPL_QTE_IND_CNT = 1 AND PCARR_POL_TERM_MO_CNT = 6 AND PCARR_POL_ANNL_PREM_AMT > 249
    AND PCARR_POL_ANNL_PREM_AMT < 6000 AND POL_ANNL_TTL_BILL_PREM_AMT > 200 AND CNTCT_METH_CD = 'P' THEN POL_ANNL_TTL_BILL_PREM_AMT/PCARR_POL_ANNL_PREM_AMT
    ELSE NULL END)) AS "0 Phone HIGSRP",																								
    -- Phone CQ
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "12 Phone CQ",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "11 Phone CQ",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "10 Phone CQ",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "9 Phone CQ",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "8 Phone CQ",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "7 Phone CQ",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "6 Phone CQ",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "5 Phone CQ",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "4 Phone CQ",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "3 Phone CQ",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "2 Phone CQ",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "1 Phone CQ",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', COMPL_QTE_IND_CNT) AS "0 Phone CQ",
    -- Phone Issues
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "12 Phone I",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "11 Phone I",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "10 Phone I",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "9 Phone I",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "8 Phone I",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "7 Phone I",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "6 Phone I",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "5 Phone I",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "4 Phone I",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "3 Phone I",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "2 Phone I",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "1 Phone I",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', ISSUE_IND_CNT) AS "0 Phone I",
    -- Phone AQP
    one_cond_scorecard(12, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AQP",
    one_cond_scorecard(11, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AQP",
    one_cond_scorecard(10, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AQP",
    one_cond_scorecard(9, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AQP",
    one_cond_scorecard(8, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AQP",
    one_cond_scorecard(7, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AQP",
    one_cond_scorecard(6, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AQP",
    one_cond_scorecard(5, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AQP",
    one_cond_scorecard(4, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AQP",
    one_cond_scorecard(3, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AQP",
    one_cond_scorecard(2, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AQP",
    one_cond_scorecard(1, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AQP",
    one_cond_scorecard(0, TRANS_DT, ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AQP",
    -- Phone AIP
    two_cond_scorecard(12, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "12 Phone AIP",
    two_cond_scorecard(11, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "11 Phone AIP",
    two_cond_scorecard(10, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "10 Phone AIP",
    two_cond_scorecard(9, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "9 Phone AIP",
    two_cond_scorecard(8, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "8 Phone AIP",
    two_cond_scorecard(7, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "7 Phone AIP",
    two_cond_scorecard(6, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "6 Phone AIP",
    two_cond_scorecard(5, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "5 Phone AIP",
    two_cond_scorecard(4, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "4 Phone AIP",
    two_cond_scorecard(3, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "3 Phone AIP",
    two_cond_scorecard(2, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "2 Phone AIP",
    two_cond_scorecard(1, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "1 Phone AIP",
    two_cond_scorecard(0, TRANS_DT, ISSUE_IND, 'Y', ORIG_QTE_CNTCT_METH_CD, 'P', POL_TTL_BILL_PREM_AMT * 2) AS "0 Phone AIP",
    -- Phone ULM
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Phone ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD = 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Phone ULM",
    -- Internet ULM 
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 12 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "12 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 11 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "11 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 10 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "10 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 9 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "9 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 8 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "8 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 7 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "7 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 6 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "6 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 5 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "5 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 4 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "4 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 3 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "3 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 2 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "2 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 1 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "1 Internet ULM",
    NULLIFZERO(AVG(CASE WHEN DATEDIFF(MONTH,TRANS_DT,SYSDATE()) = 0 and ORIG_QTE_CNTCT_METH_CD <> 'P' THEN EXPECTED_LOSS_RATIO/state_avg_lr ELSE NULL END)) AS "0 Internet ULM",
    TO_CHAR(SYSDATE(),'MM-DD-YYYY') AS AS_OF
	FROM "PRD_PL_DB"."APP_DCPA_DM"."AUTO_QUOTE_LATST_VW" t1
    LEFT JOIN (SELECT AUTO_QTE_TRANS_ID,EXPECTED_LOSS_RATIO FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY")
    USING (AUTO_QTE_TRANS_ID)
    LEFT JOIN (SELECT state, TO_CHAR(TO_DATE(TRANS_DT, 'YYYY-MM-DD'),'MM-01-YYYY') AS TRANSDT2, AVG(expected_loss_ratio) AS state_avg_lr
               FROM "DSC_PLDS_DB"."APP_AUTOMATA_PRD"."PREVAIL_AUTO_ULM_QUOTE_POL_AGG_NB_QUALITY" WHERE COMPL_QTE_IND =  'Y' GROUP BY state, TRANSDT2) AS t4
	ON t1.RISK_ST_ABBR = t4.state AND TO_CHAR(TRANS_DT,'MM-01-YYYY') = t4.TRANSDT2
	WHERE COMPL_QTE_IND = 'Y'
	GROUP BY Key
)

SELECT * FROM
(
	SELECT * FROM ins_score
	UNION ALL
	SELECT * FROM household_comp
	UNION ALL
	SELECT * FROM clean_dirty
	UNION ALL
	SELECT * FROM max_age_group
	UNION ALL
	SELECT * FROM min_age_group
	UNION ALL
	SELECT * FROM max_minus_min
	UNION ALL
	SELECT * FROM pcarr_yr_cnt
	UNION ALL
	SELECT * FROM account_credit
	UNION ALL
	SELECT * FROM pol_coverage_pkg
	UNION ALL
	SELECT * FROM pcarr
	UNION ALL
	SELECT * FROM ins_age
	UNION ALL
	SELECT * FROM ppv_count
	UNION ALL
	SELECT * FROM telematics
	UNION ALL
	SELECT * FROM youthful
	UNION ALL
	SELECT * FROM garage_sub
	UNION ALL
	SELECT * FROM prior_bi
	UNION ALL
	SELECT * FROM aarp_member
	UNION ALL
	SELECT * FROM aqd_group
	UNION ALL
	SELECT * FROM renew_uw
	UNION ALL
	SELECT * FROM min_rating_factor
	UNION ALL
	SELECT * FROM max_veh_age
	UNION ALL
	SELECT * FROM pol_mult_single
	UNION ALL
	SELECT * FROM mature_driving_course
	UNION ALL
	SELECT * FROM incident_free
	UNION ALL
	SELECT * FROM naf_accidents
	UNION ALL
	SELECT * FROM incident_mo_age
	UNION ALL
	SELECT * FROM region_ins_score
	UNION ALL
	SELECT * FROM region_hh_comp
	UNION ALL
	SELECT * FROM region_clean_dirty
	UNION ALL
	SELECT * FROM region_max_age_group
	UNION ALL
	SELECT * FROM region_min_age_group
	UNION ALL
	SELECT * FROM region_max_minus_min
	UNION ALL
	SELECT * FROM region_pcarr_yr_cnt
	UNION ALL
	SELECT * FROM region_account_credit
	UNION ALL
	SELECT * FROM region_pol_coverage_pkg
	UNION ALL
	SELECT * FROM region_pcarr
	UNION ALL
	SELECT * FROM region_ins_age
	UNION ALL
	SELECT * FROM region_ppv_count
	UNION ALL
	SELECT * FROM region_telematics
	UNION ALL
	SELECT * FROM region_youthful
	UNION ALL
	SELECT * FROM region_garage_sub
	UNION ALL
	SELECT * FROM region_prior_bi
	UNION ALL
	SELECT * FROM region_aarp_member
	UNION ALL
	SELECT * FROM region_aqd_group
	UNION ALL
	SELECT * FROM region_renew_uw
	UNION ALL
	SELECT * FROM region_min_rating_factor
	UNION ALL
	SELECT * FROM region_max_veh_age
	UNION ALL
	SELECT * FROM region_pol_mult_single
	UNION ALL
	SELECT * FROM region_mature_driving_course
	UNION ALL
	SELECT * FROM region_incident_free
	UNION ALL
	SELECT * FROM region_naf_accidents
	UNION ALL
	SELECT * FROM region_incident_mo_age
)
ORDER BY KEY