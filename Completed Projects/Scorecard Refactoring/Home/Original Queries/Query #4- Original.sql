------State Total--------------------
(SELECT  concat(RISK_STATE,'E+30 R',BUS_UNIT_ABBR,case when NEWCO_INDICATOR='Y' then 'Newco' else 'nowco' end,'Total') as Key, 
      1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN ATR_E_30 ELSE 0 END)))) AS "18",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN ATR_E_30 ELSE 0 END)))) AS "17",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN ATR_E_30 ELSE 0 END)))) AS "16",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN ATR_E_30 ELSE 0 END)))) AS "15",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN ATR_E_30 ELSE 0 END)))) AS "14",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN ATR_E_30 ELSE 0 END)))) AS "13",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN ATR_E_30 ELSE 0 END)))) AS "12",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN ATR_E_30 ELSE 0 END)))) AS "11",
      1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN ATR_E_30 ELSE 0 END)))) AS "10",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN ATR_E_30 ELSE 0 END)))) AS "9",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN ATR_E_30 ELSE 0 END)))) AS "8",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN ATR_E_30 ELSE 0 END)))) AS "7",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN ATR_E_30 ELSE 0 END)))) AS "6",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN ATR_E_30 ELSE 0 END)))) AS "5",   1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN ATR_E_30 ELSE 0 END)))) AS "4",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN ATR_E_30 ELSE 0 END)))) AS "3",
      1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN ATR_E_30 ELSE 0 END)))) AS "2",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN ATR_E_30 ELSE 0 END)))) AS "1",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN ATR_E_30 ELSE 0 END)))) AS "0",   
          TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
  from  "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"  where POL_NEW_RENEW_CD = 'R' and POL_EFF_DT >='2023-01-01' and BUS_UNIT_ABBR <> 'CDRT' and LOB = 'HOME' and ATR_E_30 = 1  
  and concat(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP','MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)

-------------------------------------------
Union all(SELECT  concat(RISK_STATE,'E+0 R',BUS_UNIT_ABBR,case when NEWCO_INDICATOR='Y' then 'Newco' else 'nowco' end,'Total') as Key,  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN ATR_E_FLAT  ELSE 0 END)))) AS "18",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN ATR_E_FLAT  ELSE 0 END)))) AS "17", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN ATR_E_FLAT  ELSE 0 END)))) AS "16",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN ATR_E_FLAT  ELSE 0 END)))) AS "15",  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN ATR_E_FLAT  ELSE 0 END)))) AS "14",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN ATR_E_FLAT  ELSE 0 END)))) AS "13",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN ATR_E_FLAT  ELSE 0 END)))) AS "12",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN ATR_E_FLAT  ELSE 0 END)))) AS "11",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN ATR_E_FLAT  ELSE 0 END)))) AS "10",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN ATR_E_FLAT  ELSE 0 END)))) AS "9",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN ATR_E_FLAT  ELSE 0 END)))) AS "8",  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN ATR_E_FLAT  ELSE 0 END)))) AS "7",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN ATR_E_FLAT  ELSE 0 END)))) AS "6",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN ATR_E_FLAT  ELSE 0 END)))) AS "5",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN ATR_E_FLAT  ELSE 0 END)))) AS "4", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN ATR_E_FLAT  ELSE 0 END)))) AS "3", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN ATR_E_FLAT  ELSE 0 END)))) AS "2",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN ATR_E_FLAT  ELSE 0 END)))) AS "1",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN ATR_E_FLAT  ELSE 0 END)))) AS "0",   
          TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
  from  "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"  where POL_NEW_RENEW_CD = 'R' and POL_EFF_DT >='2023-01-01' and BUS_UNIT_ABBR <> 'CDRT' and LOB = 'HOME' and ATR_E_FLAT = 1  
  and concat(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP','MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)
  
-------------------------------------------
Union all(SELECT  concat(RISK_STATE,'E+Ult R',BUS_UNIT_ABBR,case when NEWCO_INDICATOR='Y' then 'Newco' else 'nowco' end,'Total') as Key,  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "18", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "17",  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "16", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "15",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "14",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "13",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "12",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "11",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "10",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "9",  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "8",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "7",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "6",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "5",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "4",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "3",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "2",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "1", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "0",   
          TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
  from  "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"  where POL_NEW_RENEW_CD = 'R' and POL_EFF_DT >='2023-01-01' and BUS_UNIT_ABBR <> 'CDRT' and LOB = 'HOME' and ULT_ATR_CNT = 1  
  and concat(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP','MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)
-------------------------------------------

Union all(SELECT  concat(RISK_STATE,'PremiumChange',BUS_UNIT_ABBR,case when NEWCO_INDICATOR='Y' then 'Newco' else 'nowco' end,'Total') as Key,  
  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "18",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "17",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "16",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "15",
  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "14",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "13",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "12",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "11",
  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "10",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "9",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "8",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "7",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "6",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "5",   (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "4",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "3",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "2",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "1",
  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "0",   
  TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
from  "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"  where POL_NEW_RENEW_CD = 'R' and POL_EFF_DT >='2023-01-01' and BUS_UNIT_ABBR <> 'CDRT' and LOB = 'HOME' and ULT_ATR_CNT = 1  
 and concat(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP','MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)
  
------State Form--------------------
union all (SELECT  concat(RISK_STATE,'E+30 R',BUS_UNIT_ABBR,case when NEWCO_INDICATOR='Y' then 'Newco' else 'nowco' end,(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key, 
      1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN ATR_E_30 ELSE 0 END)))) AS "18",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN ATR_E_30 ELSE 0 END)))) AS "17",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN ATR_E_30 ELSE 0 END)))) AS "16",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN ATR_E_30 ELSE 0 END)))) AS "15",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN ATR_E_30 ELSE 0 END)))) AS "14",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN ATR_E_30 ELSE 0 END)))) AS "13",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN ATR_E_30 ELSE 0 END)))) AS "12",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN ATR_E_30 ELSE 0 END)))) AS "11",
      1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN ATR_E_30 ELSE 0 END)))) AS "10",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN ATR_E_30 ELSE 0 END)))) AS "9",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN ATR_E_30 ELSE 0 END)))) AS "8",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN ATR_E_30 ELSE 0 END)))) AS "7",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN ATR_E_30 ELSE 0 END)))) AS "6",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN ATR_E_30 ELSE 0 END)))) AS "5",   1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN ATR_E_30 ELSE 0 END)))) AS "4",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN ATR_E_30 ELSE 0 END)))) AS "3",
      1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN ATR_E_30 ELSE 0 END)))) AS "2",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN ATR_E_30 ELSE 0 END)))) AS "1",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN ATR_E_30 ELSE 0 END)))) AS "0",   
          TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
  from  "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"  where POL_NEW_RENEW_CD = 'R' and POL_EFF_DT >='2023-01-01' and BUS_UNIT_ABBR <> 'CDRT' and LOB = 'HOME' and ATR_E_30 = 1
  and concat(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP','MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)

-------------------------------------------
Union all(SELECT  concat(RISK_STATE,'E+0 R',BUS_UNIT_ABBR,case when NEWCO_INDICATOR='Y' then 'Newco' else 'nowco' end,(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN ATR_E_FLAT  ELSE 0 END)))) AS "18",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN ATR_E_FLAT  ELSE 0 END)))) AS "17", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN ATR_E_FLAT  ELSE 0 END)))) AS "16",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN ATR_E_FLAT  ELSE 0 END)))) AS "15",  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN ATR_E_FLAT  ELSE 0 END)))) AS "14",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN ATR_E_FLAT  ELSE 0 END)))) AS "13",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN ATR_E_FLAT  ELSE 0 END)))) AS "12",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN ATR_E_FLAT  ELSE 0 END)))) AS "11",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN ATR_E_FLAT  ELSE 0 END)))) AS "10",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN ATR_E_FLAT  ELSE 0 END)))) AS "9",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN ATR_E_FLAT  ELSE 0 END)))) AS "8",  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN ATR_E_FLAT  ELSE 0 END)))) AS "7",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN ATR_E_FLAT  ELSE 0 END)))) AS "6",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN ATR_E_FLAT  ELSE 0 END)))) AS "5",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN ATR_E_FLAT  ELSE 0 END)))) AS "4", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN ATR_E_FLAT  ELSE 0 END)))) AS "3", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN ATR_E_FLAT  ELSE 0 END)))) AS "2",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN ATR_E_FLAT  ELSE 0 END)))) AS "1",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN ATR_E_FLAT  ELSE 0 END)))) AS "0",   
          TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
  from  "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"  where POL_NEW_RENEW_CD = 'R' and POL_EFF_DT >='2023-01-01' and BUS_UNIT_ABBR <> 'CDRT' and LOB = 'HOME' and ATR_E_FLAT = 1  
  and concat(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP','MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)
  
-------------------------------------------
Union all(SELECT  concat(RISK_STATE,'E+Ult R',BUS_UNIT_ABBR,case when NEWCO_INDICATOR='Y' then 'Newco' else 'nowco' end,(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "18", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "17",  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "16", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "15",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "14",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "13",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "12",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "11",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "10",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "9",  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "8",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "7",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "6",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "5",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "4",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "3",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "2",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "1", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "0",   
          TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
  from  "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"  where POL_NEW_RENEW_CD = 'R' and POL_EFF_DT >='2023-01-01' and BUS_UNIT_ABBR <> 'CDRT' and LOB = 'HOME' and ULT_ATR_CNT = 1  
  and concat(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP','MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)
-------------------------------------------

Union all(SELECT  concat(RISK_STATE,'PremiumChange',BUS_UNIT_ABBR,case when NEWCO_INDICATOR='Y' then 'Newco' else 'nowco' end,(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,  
  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "18",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "17",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "16",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "15",
  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "14",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "13",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "12",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "11",
  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "10",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "9",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "8",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "7",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "6",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "5",   (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "4",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "3",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "2",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "1",
  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "0",   
  TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
from  "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"  where POL_NEW_RENEW_CD = 'R' and POL_EFF_DT >='2023-01-01' and BUS_UNIT_ABBR <> 'CDRT' and LOB = 'HOME' and ULT_ATR_CNT = 1  
 and concat(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP','MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)
-----------------------------------------------
-----------------------------------------------
------CW Total--------------------
union all (SELECT  concat('CW','E+30 R',BUS_UNIT_ABBR,case when NEWCO_INDICATOR='Y' then 'Newco' else 'nowco' end,'Total') as Key, 
      1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN ATR_E_30 ELSE 0 END)))) AS "18",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN ATR_E_30 ELSE 0 END)))) AS "17",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN ATR_E_30 ELSE 0 END)))) AS "16",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN ATR_E_30 ELSE 0 END)))) AS "15",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN ATR_E_30 ELSE 0 END)))) AS "14",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN ATR_E_30 ELSE 0 END)))) AS "13",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN ATR_E_30 ELSE 0 END)))) AS "12",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN ATR_E_30 ELSE 0 END)))) AS "11",
      1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN ATR_E_30 ELSE 0 END)))) AS "10",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN ATR_E_30 ELSE 0 END)))) AS "9",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN ATR_E_30 ELSE 0 END)))) AS "8",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN ATR_E_30 ELSE 0 END)))) AS "7",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN ATR_E_30 ELSE 0 END)))) AS "6",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN ATR_E_30 ELSE 0 END)))) AS "5",   1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN ATR_E_30 ELSE 0 END)))) AS "4",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN ATR_E_30 ELSE 0 END)))) AS "3",
      1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN ATR_E_30 ELSE 0 END)))) AS "2",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN ATR_E_30 ELSE 0 END)))) AS "1",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN ATR_E_30 ELSE 0 END)))) AS "0",   
          TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
  from  "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"  where POL_NEW_RENEW_CD = 'R' and POL_EFF_DT >='2023-01-01' and BUS_UNIT_ABBR <> 'CDRT' and LOB = 'HOME' and ATR_E_30 = 1  
  and concat(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP','MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)

-------------------------------------------
Union all(SELECT  concat('CW','E+0 R',BUS_UNIT_ABBR,case when NEWCO_INDICATOR='Y' then 'Newco' else 'nowco' end,'Total') as Key,  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN ATR_E_FLAT  ELSE 0 END)))) AS "18",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN ATR_E_FLAT  ELSE 0 END)))) AS "17", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN ATR_E_FLAT  ELSE 0 END)))) AS "16",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN ATR_E_FLAT  ELSE 0 END)))) AS "15",  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN ATR_E_FLAT  ELSE 0 END)))) AS "14",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN ATR_E_FLAT  ELSE 0 END)))) AS "13",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN ATR_E_FLAT  ELSE 0 END)))) AS "12",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN ATR_E_FLAT  ELSE 0 END)))) AS "11",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN ATR_E_FLAT  ELSE 0 END)))) AS "10",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN ATR_E_FLAT  ELSE 0 END)))) AS "9",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN ATR_E_FLAT  ELSE 0 END)))) AS "8",  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN ATR_E_FLAT  ELSE 0 END)))) AS "7",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN ATR_E_FLAT  ELSE 0 END)))) AS "6",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN ATR_E_FLAT  ELSE 0 END)))) AS "5",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN ATR_E_FLAT  ELSE 0 END)))) AS "4", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN ATR_E_FLAT  ELSE 0 END)))) AS "3", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN ATR_E_FLAT  ELSE 0 END)))) AS "2",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN ATR_E_FLAT  ELSE 0 END)))) AS "1",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN ATR_E_FLAT  ELSE 0 END)))) AS "0",   
          TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
  from  "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"  where POL_NEW_RENEW_CD = 'R' and POL_EFF_DT >='2023-01-01' and BUS_UNIT_ABBR <> 'CDRT' and LOB = 'HOME' and ATR_E_FLAT = 1  
  and concat(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP','MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)
  
-------------------------------------------
Union all(SELECT  concat('CW','E+Ult R',BUS_UNIT_ABBR,case when NEWCO_INDICATOR='Y' then 'Newco' else 'nowco' end,'Total') as Key,  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "18", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "17",  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "16", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "15",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "14",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "13",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "12",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "11",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "10",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "9",  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "8",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "7",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "6",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "5",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "4",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "3",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "2",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "1", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "0",   
          TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
  from  "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"  where POL_NEW_RENEW_CD = 'R' and POL_EFF_DT >='2023-01-01' and BUS_UNIT_ABBR <> 'CDRT' and LOB = 'HOME' and ULT_ATR_CNT = 1  
  and concat(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP','MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)
-------------------------------------------

Union all(SELECT  concat('CW','PremiumChange',BUS_UNIT_ABBR,case when NEWCO_INDICATOR='Y' then 'Newco' else 'nowco' end,'Total') as Key,  
  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "18",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "17",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "16",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "15",
  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "14",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "13",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "12",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "11",
  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "10",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "9",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "8",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "7",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "6",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "5",   (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "4",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "3",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "2",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "1",
  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "0",   
  TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
from  "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"  where POL_NEW_RENEW_CD = 'R' and POL_EFF_DT >='2023-01-01' and BUS_UNIT_ABBR <> 'CDRT' and LOB = 'HOME' and ULT_ATR_CNT = 1  
 and concat(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP','MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)
  
------CW Form--------------------
union all (SELECT  concat('CW','E+30 R',BUS_UNIT_ABBR,case when NEWCO_INDICATOR='Y' then 'Newco' else 'nowco' end,(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key, 
      1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN ATR_E_30 ELSE 0 END)))) AS "18",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN ATR_E_30 ELSE 0 END)))) AS "17",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN ATR_E_30 ELSE 0 END)))) AS "16",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN ATR_E_30 ELSE 0 END)))) AS "15",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN ATR_E_30 ELSE 0 END)))) AS "14",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN ATR_E_30 ELSE 0 END)))) AS "13",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN ATR_E_30 ELSE 0 END)))) AS "12",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN ATR_E_30 ELSE 0 END)))) AS "11",
      1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN ATR_E_30 ELSE 0 END)))) AS "10",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN ATR_E_30 ELSE 0 END)))) AS "9",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN ATR_E_30 ELSE 0 END)))) AS "8",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN ATR_E_30 ELSE 0 END)))) AS "7",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN ATR_E_30 ELSE 0 END)))) AS "6",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN ATR_E_30 ELSE 0 END)))) AS "5",   1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN ATR_E_30 ELSE 0 END)))) AS "4",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN ATR_E_30 ELSE 0 END)))) AS "3",
      1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN ATR_E_30 ELSE 0 END)))) AS "2",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN ATR_E_30 ELSE 0 END)))) AS "1",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN ATR_E_30 ELSE 0 END)))) AS "0",   
          TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
  from  "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"  where POL_NEW_RENEW_CD = 'R' and POL_EFF_DT >='2023-01-01' and BUS_UNIT_ABBR <> 'CDRT' and LOB = 'HOME' and ATR_E_30 = 1  
  and concat(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP','MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)

-------------------------------------------
Union all(SELECT  concat('CW','E+0 R',BUS_UNIT_ABBR,case when NEWCO_INDICATOR='Y' then 'Newco' else 'nowco' end,(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN ATR_E_FLAT  ELSE 0 END)))) AS "18",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN ATR_E_FLAT  ELSE 0 END)))) AS "17", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN ATR_E_FLAT  ELSE 0 END)))) AS "16",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN ATR_E_FLAT  ELSE 0 END)))) AS "15",  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN ATR_E_FLAT  ELSE 0 END)))) AS "14",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN ATR_E_FLAT  ELSE 0 END)))) AS "13",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN ATR_E_FLAT  ELSE 0 END)))) AS "12",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN ATR_E_FLAT  ELSE 0 END)))) AS "11",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN ATR_E_FLAT  ELSE 0 END)))) AS "10",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN ATR_E_FLAT  ELSE 0 END)))) AS "9",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN ATR_E_FLAT  ELSE 0 END)))) AS "8",  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN ATR_E_FLAT  ELSE 0 END)))) AS "7",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN ATR_E_FLAT  ELSE 0 END)))) AS "6",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN ATR_E_FLAT  ELSE 0 END)))) AS "5",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN ATR_E_FLAT  ELSE 0 END)))) AS "4", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN ATR_E_FLAT  ELSE 0 END)))) AS "3", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN ATR_E_FLAT  ELSE 0 END)))) AS "2",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN ATR_E_FLAT  ELSE 0 END)))) AS "1",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN ATR_E_FLAT  ELSE 0 END)))) AS "0",   
          TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
  from  "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"  where POL_NEW_RENEW_CD = 'R' and POL_EFF_DT >='2023-01-01' and BUS_UNIT_ABBR <> 'CDRT' and LOB = 'HOME' and ATR_E_FLAT = 1  
  and concat(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP','MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)
  
-------------------------------------------
Union all(SELECT  concat('CW','E+Ult R',BUS_UNIT_ABBR,case when NEWCO_INDICATOR='Y' then 'Newco' else 'nowco' end,(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "18", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "17",  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "16", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "15",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "14",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "13",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "12",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "11",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "10",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "9",  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "8",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "7",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "6",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "5",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "4",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "3",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "2",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "1", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "0",   
          TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
  from  "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"  where POL_NEW_RENEW_CD = 'R' and POL_EFF_DT >='2023-01-01' and BUS_UNIT_ABBR <> 'CDRT' and LOB = 'HOME' and ULT_ATR_CNT = 1  
  and concat(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP','MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)
-------------------------------------------

Union all(SELECT  concat('CW','PremiumChange',BUS_UNIT_ABBR,case when NEWCO_INDICATOR='Y' then 'Newco' else 'nowco' end,(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,  
  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "18",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "17",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "16",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "15",
  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "14",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "13",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "12",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "11",
  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "10",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "9",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "8",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "7",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "6",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "5",   (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "4",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "3",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "2",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "1",
  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "0",   
  TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
from  "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"  where POL_NEW_RENEW_CD = 'R' and POL_EFF_DT >='2023-01-01' and BUS_UNIT_ABBR <> 'CDRT' and LOB = 'HOME' and ULT_ATR_CNT = 1  
 and concat(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP','MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)

---------------------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------
-----------------------------------------------
-----------------------------------------------
------Region Total--------------------
union all (SELECT  concat((case when RISK_STATE in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_STATE in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_STATE in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_STATE in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'E+30 R',BUS_UNIT_ABBR,case when NEWCO_INDICATOR='Y' then 'Newco' else 'nowco' end,'Total') as Key, 
      1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN ATR_E_30 ELSE 0 END)))) AS "18",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN ATR_E_30 ELSE 0 END)))) AS "17",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN ATR_E_30 ELSE 0 END)))) AS "16",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN ATR_E_30 ELSE 0 END)))) AS "15",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN ATR_E_30 ELSE 0 END)))) AS "14",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN ATR_E_30 ELSE 0 END)))) AS "13",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN ATR_E_30 ELSE 0 END)))) AS "12",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN ATR_E_30 ELSE 0 END)))) AS "11",
      1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN ATR_E_30 ELSE 0 END)))) AS "10",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN ATR_E_30 ELSE 0 END)))) AS "9",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN ATR_E_30 ELSE 0 END)))) AS "8",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN ATR_E_30 ELSE 0 END)))) AS "7",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN ATR_E_30 ELSE 0 END)))) AS "6",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN ATR_E_30 ELSE 0 END)))) AS "5",   1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN ATR_E_30 ELSE 0 END)))) AS "4",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN ATR_E_30 ELSE 0 END)))) AS "3",
      1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN ATR_E_30 ELSE 0 END)))) AS "2",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN ATR_E_30 ELSE 0 END)))) AS "1",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN ATR_E_30 ELSE 0 END)))) AS "0",   
          TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
  from  "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"  where POL_NEW_RENEW_CD = 'R' and POL_EFF_DT >='2023-01-01' and BUS_UNIT_ABBR <> 'CDRT' and LOB = 'HOME' and ATR_E_30 = 1  
  and concat(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP','MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)

-------------------------------------------
Union all(SELECT  concat((case when RISK_STATE in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_STATE in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_STATE in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_STATE in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'E+0 R',BUS_UNIT_ABBR,case when NEWCO_INDICATOR='Y' then 'Newco' else 'nowco' end,'Total') as Key,  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN ATR_E_FLAT  ELSE 0 END)))) AS "18",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN ATR_E_FLAT  ELSE 0 END)))) AS "17", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN ATR_E_FLAT  ELSE 0 END)))) AS "16",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN ATR_E_FLAT  ELSE 0 END)))) AS "15",  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN ATR_E_FLAT  ELSE 0 END)))) AS "14",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN ATR_E_FLAT  ELSE 0 END)))) AS "13",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN ATR_E_FLAT  ELSE 0 END)))) AS "12",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN ATR_E_FLAT  ELSE 0 END)))) AS "11",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN ATR_E_FLAT  ELSE 0 END)))) AS "10",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN ATR_E_FLAT  ELSE 0 END)))) AS "9",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN ATR_E_FLAT  ELSE 0 END)))) AS "8",  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN ATR_E_FLAT  ELSE 0 END)))) AS "7",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN ATR_E_FLAT  ELSE 0 END)))) AS "6",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN ATR_E_FLAT  ELSE 0 END)))) AS "5",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN ATR_E_FLAT  ELSE 0 END)))) AS "4", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN ATR_E_FLAT  ELSE 0 END)))) AS "3", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN ATR_E_FLAT  ELSE 0 END)))) AS "2",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN ATR_E_FLAT  ELSE 0 END)))) AS "1",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN ATR_E_FLAT  ELSE 0 END)))) AS "0",   
          TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
  from  "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"  where POL_NEW_RENEW_CD = 'R' and POL_EFF_DT >='2023-01-01' and BUS_UNIT_ABBR <> 'CDRT' and LOB = 'HOME' and ATR_E_FLAT = 1  
  and concat(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP','MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)
  
-------------------------------------------
Union all(SELECT  concat((case when RISK_STATE in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_STATE in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_STATE in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_STATE in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'E+Ult R',BUS_UNIT_ABBR,case when NEWCO_INDICATOR='Y' then 'Newco' else 'nowco' end,'Total') as Key,  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "18", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "17",  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "16", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "15",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "14",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "13",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "12",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "11",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "10",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "9",  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "8",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "7",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "6",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "5",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "4",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "3",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "2",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "1", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "0",   
          TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
  from  "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"  where POL_NEW_RENEW_CD = 'R' and POL_EFF_DT >='2023-01-01' and BUS_UNIT_ABBR <> 'CDRT' and LOB = 'HOME' and ULT_ATR_CNT = 1  
  and concat(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP','MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)
-------------------------------------------

Union all(SELECT  concat((case when RISK_STATE in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_STATE in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_STATE in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_STATE in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'PremiumChange',BUS_UNIT_ABBR,case when NEWCO_INDICATOR='Y' then 'Newco' else 'nowco' end,'Total') as Key,  
  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "18",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "17",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "16",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "15",
  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "14",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "13",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "12",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "11",
  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "10",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "9",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "8",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "7",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "6",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "5",   (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "4",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "3",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "2",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "1",
  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "0",   
  TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
from  "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"  where POL_NEW_RENEW_CD = 'R' and POL_EFF_DT >='2023-01-01' and BUS_UNIT_ABBR <> 'CDRT' and LOB = 'HOME' and ULT_ATR_CNT = 1  
 and concat(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP','MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)
  
------Region Form--------------------
union all (SELECT  concat((case when RISK_STATE in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_STATE in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_STATE in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_STATE in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'E+30 R',BUS_UNIT_ABBR,case when NEWCO_INDICATOR='Y' then 'Newco' else 'nowco' end,(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key, 
      1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN ATR_E_30 ELSE 0 END)))) AS "18",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN ATR_E_30 ELSE 0 END)))) AS "17",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN ATR_E_30 ELSE 0 END)))) AS "16",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN ATR_E_30 ELSE 0 END)))) AS "15",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN ATR_E_30 ELSE 0 END)))) AS "14",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN ATR_E_30 ELSE 0 END)))) AS "13",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN ATR_E_30 ELSE 0 END)))) AS "12",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN ATR_E_30 ELSE 0 END)))) AS "11",
      1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN ATR_E_30 ELSE 0 END)))) AS "10",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN ATR_E_30 ELSE 0 END)))) AS "9",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN ATR_E_30 ELSE 0 END)))) AS "8",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN ATR_E_30 ELSE 0 END)))) AS "7",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN ATR_E_30 ELSE 0 END)))) AS "6",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN ATR_E_30 ELSE 0 END)))) AS "5",   1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN ATR_E_30 ELSE 0 END)))) AS "4",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN ATR_E_30 ELSE 0 END)))) AS "3",
      1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN ATR_E_30 ELSE 0 END)))) AS "2",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN ATR_E_30 ELSE 0 END)))) AS "1",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN CANCEL_E_30 ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN ATR_E_30 ELSE 0 END)))) AS "0",   
          TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
  from  "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"  where POL_NEW_RENEW_CD = 'R' and POL_EFF_DT >='2023-01-01' and BUS_UNIT_ABBR <> 'CDRT' and LOB = 'HOME' and ATR_E_30 = 1  
  and concat(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP','MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)

-------------------------------------------
Union all(SELECT  concat((case when RISK_STATE in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_STATE in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_STATE in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_STATE in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'E+0 R',BUS_UNIT_ABBR,case when NEWCO_INDICATOR='Y' then 'Newco' else 'nowco' end,(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN ATR_E_FLAT  ELSE 0 END)))) AS "18",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN ATR_E_FLAT  ELSE 0 END)))) AS "17", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN ATR_E_FLAT  ELSE 0 END)))) AS "16",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN ATR_E_FLAT  ELSE 0 END)))) AS "15",  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN ATR_E_FLAT  ELSE 0 END)))) AS "14",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN ATR_E_FLAT  ELSE 0 END)))) AS "13",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN ATR_E_FLAT  ELSE 0 END)))) AS "12",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN ATR_E_FLAT  ELSE 0 END)))) AS "11",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN ATR_E_FLAT  ELSE 0 END)))) AS "10",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN ATR_E_FLAT  ELSE 0 END)))) AS "9",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN ATR_E_FLAT  ELSE 0 END)))) AS "8",  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN ATR_E_FLAT  ELSE 0 END)))) AS "7",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN ATR_E_FLAT  ELSE 0 END)))) AS "6",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN ATR_E_FLAT  ELSE 0 END)))) AS "5",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN ATR_E_FLAT  ELSE 0 END)))) AS "4", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN ATR_E_FLAT  ELSE 0 END)))) AS "3", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN ATR_E_FLAT  ELSE 0 END)))) AS "2",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN ATR_E_FLAT  ELSE 0 END)))) AS "1",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN CANCEL_E_FLAT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN ATR_E_FLAT  ELSE 0 END)))) AS "0",   
          TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
  from  "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"  where POL_NEW_RENEW_CD = 'R' and POL_EFF_DT >='2023-01-01' and BUS_UNIT_ABBR <> 'CDRT' and LOB = 'HOME' and ATR_E_FLAT = 1  
  and concat(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP','MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)
  
-------------------------------------------
Union all(SELECT  concat((case when RISK_STATE in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_STATE in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_STATE in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_STATE in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'E+Ult R',BUS_UNIT_ABBR,case when NEWCO_INDICATOR='Y' then 'Newco' else 'nowco' end,(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "18", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "17",  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "16", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "15",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "14",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "13",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "12",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "11",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "10",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "9",  
  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "8",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "7",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "6",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "5",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "4",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "3",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "2",  1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "1", 1-(Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN ULT_CANC_CNT ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN ULT_ATR_CNT  ELSE 0 END)))) AS "0",   
          TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
  from  "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"  where POL_NEW_RENEW_CD = 'R' and POL_EFF_DT >='2023-01-01' and BUS_UNIT_ABBR <> 'CDRT' and LOB = 'HOME' and ULT_ATR_CNT = 1  
  and concat(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP','MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)
-------------------------------------------

Union all(SELECT  concat((case when RISK_STATE in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when RISK_STATE in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when RISK_STATE in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when RISK_STATE in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'PremiumChange',BUS_UNIT_ABBR,case when NEWCO_INDICATOR='Y' then 'Newco' else 'nowco' end,(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key,  
  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=18 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "18",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=17 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "17",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=16 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "16",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=15 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "15",
  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=14 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "14",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=13 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "13",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=12 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "12",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=11 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "11",
  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())=10 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "10",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 9 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "9",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 8 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "8",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 7 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "7",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 6 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "6",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 5 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "5",   (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 4 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "4",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 3 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "3",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 2 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "2",  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 1 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "1",
  (Div0null((sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN FIRST_TRANS_PREM ELSE 0 END)), (sum(case when Datediff(month,POL_EFF_DT,sysdate())= 0 THEN PRIOR_TERM_LATEST_PREM ELSE 0 END))))-1 AS "0",   
  TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
from  "DSC_PLBI_DB"."APP_AUTO_PRD"."PERSISTENCY_COMBINED"  where POL_NEW_RENEW_CD = 'R' and POL_EFF_DT >='2023-01-01' and BUS_UNIT_ABBR <> 'CDRT' and LOB = 'HOME' and ULT_ATR_CNT = 1  
 and concat(RISK_STATE,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY','MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY','TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP','DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP','MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP','SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY','ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP','MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP','SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP','MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)





Union all 
(SELECT  concat(STATE_ABBR,'Inforce',BUS_UNIT_ABBR,case when NEWCO_IND='Y' then 'Newco' else 'nowco' end,'Total') as Key, 
  sum(case when Datediff(month,ME_DT,sysdate())=18 THEN POL_INFORCE_CNT ELSE 0 END) AS "18",
  sum(case when Datediff(month,ME_DT,sysdate())=17 THEN POL_INFORCE_CNT ELSE 0 END) AS "17",
  sum(case when Datediff(month,ME_DT,sysdate())=16 THEN POL_INFORCE_CNT ELSE 0 END) AS "16",
  sum(case when Datediff(month,ME_DT,sysdate())=15 THEN POL_INFORCE_CNT ELSE 0 END) AS "15",
  sum(case when Datediff(month,ME_DT,sysdate())=14 THEN POL_INFORCE_CNT ELSE 0 END) AS "14",
  sum(case when Datediff(month,ME_DT,sysdate())=13 THEN POL_INFORCE_CNT ELSE 0 END) AS "13",
  sum(case when Datediff(month,ME_DT,sysdate())=12 THEN POL_INFORCE_CNT ELSE 0 END) AS "12",
  sum(case when Datediff(month,ME_DT,sysdate())=11 THEN POL_INFORCE_CNT ELSE 0 END) AS "11",
  sum(case when Datediff(month,ME_DT,sysdate())=10 THEN POL_INFORCE_CNT ELSE 0 END) AS "10",
  sum(case when Datediff(month,ME_DT,sysdate())=9 THEN POL_INFORCE_CNT ELSE 0 END) AS "9",
  sum(case when Datediff(month,ME_DT,sysdate())=8 THEN POL_INFORCE_CNT ELSE 0 END) AS "8",
  sum(case when Datediff(month,ME_DT,sysdate())=7 THEN POL_INFORCE_CNT ELSE 0 END) AS "7",
  sum(case when Datediff(month,ME_DT,sysdate())=6 THEN POL_INFORCE_CNT ELSE 0 END) AS "6",
  sum(case when Datediff(month,ME_DT,sysdate())=5 THEN POL_INFORCE_CNT ELSE 0 END) AS "5",
  sum(case when Datediff(month,ME_DT,sysdate())=4 THEN POL_INFORCE_CNT ELSE 0 END) AS "4",
  sum(case when Datediff(month,ME_DT,sysdate())=3 THEN POL_INFORCE_CNT ELSE 0 END) AS "3",
  sum(case when Datediff(month,ME_DT,sysdate())=2 THEN POL_INFORCE_CNT ELSE 0 END) AS "2",
  sum(case when Datediff(month,ME_DT,sysdate())=1 THEN POL_INFORCE_CNT ELSE 0 END) AS "1",
  sum(case when Datediff(month,ME_DT,sysdate())=0 THEN POL_INFORCE_CNT ELSE 0 END) AS "0",
  TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
from "DSC_PLBI_DB"."APP_HOME_PRD"."HOME_INFORCE_MONTHEND"
Where BUS_UNIT_ABBR in ('AARP','AGCY') 
and concat(STATE_ABBR,RATE_PLAN_CD,BUS_UNIT_ABBR) in
('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY',  'MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY', 'TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP', 'DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP', 'MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP', 'SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY', 'ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP', 'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP', 'SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP', 'MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)
----



Union all 
(SELECT  concat((case when STATE_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when STATE_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when STATE_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when STATE_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'Inforce',BUS_UNIT_ABBR,case when NEWCO_IND='Y' then 'Newco' else 'nowco' end,'Total') as Key, 
  sum(case when Datediff(month,ME_DT,sysdate())=18 THEN POL_INFORCE_CNT ELSE 0 END) AS "18",
  sum(case when Datediff(month,ME_DT,sysdate())=17 THEN POL_INFORCE_CNT ELSE 0 END) AS "17",
  sum(case when Datediff(month,ME_DT,sysdate())=16 THEN POL_INFORCE_CNT ELSE 0 END) AS "16",
  sum(case when Datediff(month,ME_DT,sysdate())=15 THEN POL_INFORCE_CNT ELSE 0 END) AS "15",
  sum(case when Datediff(month,ME_DT,sysdate())=14 THEN POL_INFORCE_CNT ELSE 0 END) AS "14",
  sum(case when Datediff(month,ME_DT,sysdate())=13 THEN POL_INFORCE_CNT ELSE 0 END) AS "13",
  sum(case when Datediff(month,ME_DT,sysdate())=12 THEN POL_INFORCE_CNT ELSE 0 END) AS "12",
  sum(case when Datediff(month,ME_DT,sysdate())=11 THEN POL_INFORCE_CNT ELSE 0 END) AS "11",
  sum(case when Datediff(month,ME_DT,sysdate())=10 THEN POL_INFORCE_CNT ELSE 0 END) AS "10",
  sum(case when Datediff(month,ME_DT,sysdate())=9 THEN POL_INFORCE_CNT ELSE 0 END) AS "9",
  sum(case when Datediff(month,ME_DT,sysdate())=8 THEN POL_INFORCE_CNT ELSE 0 END) AS "8",
  sum(case when Datediff(month,ME_DT,sysdate())=7 THEN POL_INFORCE_CNT ELSE 0 END) AS "7",
  sum(case when Datediff(month,ME_DT,sysdate())=6 THEN POL_INFORCE_CNT ELSE 0 END) AS "6",
  sum(case when Datediff(month,ME_DT,sysdate())=5 THEN POL_INFORCE_CNT ELSE 0 END) AS "5",
  sum(case when Datediff(month,ME_DT,sysdate())=4 THEN POL_INFORCE_CNT ELSE 0 END) AS "4",
  sum(case when Datediff(month,ME_DT,sysdate())=3 THEN POL_INFORCE_CNT ELSE 0 END) AS "3",
  sum(case when Datediff(month,ME_DT,sysdate())=2 THEN POL_INFORCE_CNT ELSE 0 END) AS "2",
  sum(case when Datediff(month,ME_DT,sysdate())=1 THEN POL_INFORCE_CNT ELSE 0 END) AS "1",
  sum(case when Datediff(month,ME_DT,sysdate())=0 THEN POL_INFORCE_CNT ELSE 0 END) AS "0",
  TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
from "DSC_PLBI_DB"."APP_HOME_PRD"."HOME_INFORCE_MONTHEND"
Where BUS_UNIT_ABBR in ('AARP','AGCY') 
and concat(STATE_ABBR,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY', 'MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY', 'TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP', 'DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP', 'MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP', 'SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY', 'ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP', 'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP', 'SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP', 'MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)

 
 

Union all (SELECT  concat('CW','Inforce',BUS_UNIT_ABBR,case when NEWCO_IND='Y' then 'Newco' else 'nowco' end,'Total') as Key, 
  sum(case when Datediff(month,ME_DT,sysdate())=18 THEN POL_INFORCE_CNT ELSE 0 END) AS "18",
  sum(case when Datediff(month,ME_DT,sysdate())=17 THEN POL_INFORCE_CNT ELSE 0 END) AS "17",
  sum(case when Datediff(month,ME_DT,sysdate())=16 THEN POL_INFORCE_CNT ELSE 0 END) AS "16",
  sum(case when Datediff(month,ME_DT,sysdate())=15 THEN POL_INFORCE_CNT ELSE 0 END) AS "15",
  sum(case when Datediff(month,ME_DT,sysdate())=14 THEN POL_INFORCE_CNT ELSE 0 END) AS "14",
  sum(case when Datediff(month,ME_DT,sysdate())=13 THEN POL_INFORCE_CNT ELSE 0 END) AS "13",
  sum(case when Datediff(month,ME_DT,sysdate())=12 THEN POL_INFORCE_CNT ELSE 0 END) AS "12",
  sum(case when Datediff(month,ME_DT,sysdate())=11 THEN POL_INFORCE_CNT ELSE 0 END) AS "11",
  sum(case when Datediff(month,ME_DT,sysdate())=10 THEN POL_INFORCE_CNT ELSE 0 END) AS "10",
  sum(case when Datediff(month,ME_DT,sysdate())=9 THEN POL_INFORCE_CNT ELSE 0 END) AS "9",
  sum(case when Datediff(month,ME_DT,sysdate())=8 THEN POL_INFORCE_CNT ELSE 0 END) AS "8",
  sum(case when Datediff(month,ME_DT,sysdate())=7 THEN POL_INFORCE_CNT ELSE 0 END) AS "7",
  sum(case when Datediff(month,ME_DT,sysdate())=6 THEN POL_INFORCE_CNT ELSE 0 END) AS "6",
  sum(case when Datediff(month,ME_DT,sysdate())=5 THEN POL_INFORCE_CNT ELSE 0 END) AS "5",
  sum(case when Datediff(month,ME_DT,sysdate())=4 THEN POL_INFORCE_CNT ELSE 0 END) AS "4",
  sum(case when Datediff(month,ME_DT,sysdate())=3 THEN POL_INFORCE_CNT ELSE 0 END) AS "3",
  sum(case when Datediff(month,ME_DT,sysdate())=2 THEN POL_INFORCE_CNT ELSE 0 END) AS "2",
  sum(case when Datediff(month,ME_DT,sysdate())=1 THEN POL_INFORCE_CNT ELSE 0 END) AS "1",
  sum(case when Datediff(month,ME_DT,sysdate())=0 THEN POL_INFORCE_CNT ELSE 0 END) AS "0",
  TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
from "DSC_PLBI_DB"."APP_HOME_PRD"."HOME_INFORCE_MONTHEND"
Where BUS_UNIT_ABBR in ('AARP','AGCY') 
and concat(STATE_ABBR,RATE_PLAN_CD,BUS_UNIT_ABBR) in
('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY', 'MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY', 'TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP', 'DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP', 'MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP', 'SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY', 'ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP', 'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP', 'SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP', 'MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)

Union all 
(SELECT  concat(STATE_ABBR,'Written Premium',BUS_UNIT_ABBR,case when NEWCO_IND='Y' then 'Newco' else 'nowco' end,'Total') as Key, 
  sum(case when Datediff(month,ME_DT,sysdate())=18 THEN TERM_WRIT_PREM ELSE 0 END) AS "18",
  sum(case when Datediff(month,ME_DT,sysdate())=17 THEN TERM_WRIT_PREM ELSE 0 END) AS "17",
  sum(case when Datediff(month,ME_DT,sysdate())=16 THEN TERM_WRIT_PREM ELSE 0 END) AS "16",
  sum(case when Datediff(month,ME_DT,sysdate())=15 THEN TERM_WRIT_PREM ELSE 0 END) AS "15",
  sum(case when Datediff(month,ME_DT,sysdate())=14 THEN TERM_WRIT_PREM ELSE 0 END) AS "14",
  sum(case when Datediff(month,ME_DT,sysdate())=13 THEN TERM_WRIT_PREM ELSE 0 END) AS "13",
  sum(case when Datediff(month,ME_DT,sysdate())=12 THEN TERM_WRIT_PREM ELSE 0 END) AS "12",
  sum(case when Datediff(month,ME_DT,sysdate())=11 THEN TERM_WRIT_PREM ELSE 0 END) AS "11",
  sum(case when Datediff(month,ME_DT,sysdate())=10 THEN TERM_WRIT_PREM ELSE 0 END) AS "10",
  sum(case when Datediff(month,ME_DT,sysdate())=9 THEN TERM_WRIT_PREM ELSE 0 END) AS "9",
  sum(case when Datediff(month,ME_DT,sysdate())=8 THEN TERM_WRIT_PREM ELSE 0 END) AS "8",
  sum(case when Datediff(month,ME_DT,sysdate())=7 THEN TERM_WRIT_PREM ELSE 0 END) AS "7",
  sum(case when Datediff(month,ME_DT,sysdate())=6 THEN TERM_WRIT_PREM ELSE 0 END) AS "6",
  sum(case when Datediff(month,ME_DT,sysdate())=5 THEN TERM_WRIT_PREM ELSE 0 END) AS "5",
  sum(case when Datediff(month,ME_DT,sysdate())=4 THEN TERM_WRIT_PREM ELSE 0 END) AS "4",
  sum(case when Datediff(month,ME_DT,sysdate())=3 THEN TERM_WRIT_PREM ELSE 0 END) AS "3",
  sum(case when Datediff(month,ME_DT,sysdate())=2 THEN TERM_WRIT_PREM ELSE 0 END) AS "2",
  sum(case when Datediff(month,ME_DT,sysdate())=1 THEN TERM_WRIT_PREM ELSE 0 END) AS "1",
  sum(case when Datediff(month,ME_DT,sysdate())=0 THEN TERM_WRIT_PREM ELSE 0 END) AS "0",
  TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
from "DSC_PLBI_DB"."APP_HOME_PRD"."HOME_INFORCE_MONTHEND"
Where BUS_UNIT_ABBR in ('AARP','AGCY') 
and concat(STATE_ABBR,RATE_PLAN_CD,BUS_UNIT_ABBR) in
('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY', 'MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY', 'TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP', 'DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP', 'MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP', 'SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY', 'ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP', 'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP', 'SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP', 'MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)
----------------------------------------------------
Union all 
(SELECT  concat('CW','Written Premium',BUS_UNIT_ABBR,case when NEWCO_IND='Y' then 'Newco' else 'nowco' end,'Total') as Key, 
  sum(case when Datediff(month,ME_DT,sysdate())=18 THEN TERM_WRIT_PREM ELSE 0 END) AS "18",
  sum(case when Datediff(month,ME_DT,sysdate())=17 THEN TERM_WRIT_PREM ELSE 0 END) AS "17",
  sum(case when Datediff(month,ME_DT,sysdate())=16 THEN TERM_WRIT_PREM ELSE 0 END) AS "16",
  sum(case when Datediff(month,ME_DT,sysdate())=15 THEN TERM_WRIT_PREM ELSE 0 END) AS "15",
  sum(case when Datediff(month,ME_DT,sysdate())=14 THEN TERM_WRIT_PREM ELSE 0 END) AS "14",
  sum(case when Datediff(month,ME_DT,sysdate())=13 THEN TERM_WRIT_PREM ELSE 0 END) AS "13",
  sum(case when Datediff(month,ME_DT,sysdate())=12 THEN TERM_WRIT_PREM ELSE 0 END) AS "12",
  sum(case when Datediff(month,ME_DT,sysdate())=11 THEN TERM_WRIT_PREM ELSE 0 END) AS "11",
  sum(case when Datediff(month,ME_DT,sysdate())=10 THEN TERM_WRIT_PREM ELSE 0 END) AS "10",
  sum(case when Datediff(month,ME_DT,sysdate())=9 THEN TERM_WRIT_PREM ELSE 0 END) AS "9",
  sum(case when Datediff(month,ME_DT,sysdate())=8 THEN TERM_WRIT_PREM ELSE 0 END) AS "8",
  sum(case when Datediff(month,ME_DT,sysdate())=7 THEN TERM_WRIT_PREM ELSE 0 END) AS "7",
  sum(case when Datediff(month,ME_DT,sysdate())=6 THEN TERM_WRIT_PREM ELSE 0 END) AS "6",
  sum(case when Datediff(month,ME_DT,sysdate())=5 THEN TERM_WRIT_PREM ELSE 0 END) AS "5",
  sum(case when Datediff(month,ME_DT,sysdate())=4 THEN TERM_WRIT_PREM ELSE 0 END) AS "4",
  sum(case when Datediff(month,ME_DT,sysdate())=3 THEN TERM_WRIT_PREM ELSE 0 END) AS "3",
  sum(case when Datediff(month,ME_DT,sysdate())=2 THEN TERM_WRIT_PREM ELSE 0 END) AS "2",
  sum(case when Datediff(month,ME_DT,sysdate())=1 THEN TERM_WRIT_PREM ELSE 0 END) AS "1",
  sum(case when Datediff(month,ME_DT,sysdate())=0 THEN TERM_WRIT_PREM ELSE 0 END) AS "0",
  TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
from "DSC_PLBI_DB"."APP_HOME_PRD"."HOME_INFORCE_MONTHEND"
Where BUS_UNIT_ABBR in ('AARP','AGCY') 
and concat(STATE_ABBR,RATE_PLAN_CD,BUS_UNIT_ABBR) in
('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY', 'MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY', 'TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP', 'DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP', 'MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP', 'SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY', 'ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP', 'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP', 'SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP', 'MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)
Union all 
(SELECT  concat((case when STATE_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when STATE_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when STATE_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when STATE_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),'Written Premium',BUS_UNIT_ABBR,case when NEWCO_IND='Y' then 'Newco' else 'nowco' end,'Total') as Key, 
  sum(case when Datediff(month,ME_DT,sysdate())=18 THEN TERM_WRIT_PREM ELSE 0 END) AS "18",
  sum(case when Datediff(month,ME_DT,sysdate())=17 THEN TERM_WRIT_PREM ELSE 0 END) AS "17",
  sum(case when Datediff(month,ME_DT,sysdate())=16 THEN TERM_WRIT_PREM ELSE 0 END) AS "16",
  sum(case when Datediff(month,ME_DT,sysdate())=15 THEN TERM_WRIT_PREM ELSE 0 END) AS "15",
  sum(case when Datediff(month,ME_DT,sysdate())=14 THEN TERM_WRIT_PREM ELSE 0 END) AS "14",
  sum(case when Datediff(month,ME_DT,sysdate())=13 THEN TERM_WRIT_PREM ELSE 0 END) AS "13",
  sum(case when Datediff(month,ME_DT,sysdate())=12 THEN TERM_WRIT_PREM ELSE 0 END) AS "12",
  sum(case when Datediff(month,ME_DT,sysdate())=11 THEN TERM_WRIT_PREM ELSE 0 END) AS "11",
  sum(case when Datediff(month,ME_DT,sysdate())=10 THEN TERM_WRIT_PREM ELSE 0 END) AS "10",
  sum(case when Datediff(month,ME_DT,sysdate())=9 THEN TERM_WRIT_PREM ELSE 0 END) AS "9",
  sum(case when Datediff(month,ME_DT,sysdate())=8 THEN TERM_WRIT_PREM ELSE 0 END) AS "8",
  sum(case when Datediff(month,ME_DT,sysdate())=7 THEN TERM_WRIT_PREM ELSE 0 END) AS "7",
  sum(case when Datediff(month,ME_DT,sysdate())=6 THEN TERM_WRIT_PREM ELSE 0 END) AS "6",
  sum(case when Datediff(month,ME_DT,sysdate())=5 THEN TERM_WRIT_PREM ELSE 0 END) AS "5",
  sum(case when Datediff(month,ME_DT,sysdate())=4 THEN TERM_WRIT_PREM ELSE 0 END) AS "4",
  sum(case when Datediff(month,ME_DT,sysdate())=3 THEN TERM_WRIT_PREM ELSE 0 END) AS "3",
  sum(case when Datediff(month,ME_DT,sysdate())=2 THEN TERM_WRIT_PREM ELSE 0 END) AS "2",
  sum(case when Datediff(month,ME_DT,sysdate())=1 THEN TERM_WRIT_PREM ELSE 0 END) AS "1",
  sum(case when Datediff(month,ME_DT,sysdate())=0 THEN TERM_WRIT_PREM ELSE 0 END) AS "0",
  TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
from "DSC_PLBI_DB"."APP_HOME_PRD"."HOME_INFORCE_MONTHEND"
Where BUS_UNIT_ABBR in ('AARP','AGCY') 
and concat(STATE_ABBR,RATE_PLAN_CD,BUS_UNIT_ABBR) in
('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY', 'MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY', 'TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP', 'DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP', 'MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP', 'SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY', 'ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP', 'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP', 'SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP', 'MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)
----------------------------------------------------------


Union all 
(SELECT  concat(STATE_ABBR,'Inforce',BUS_UNIT_ABBR,case when NEWCO_IND='Y' then 'Newco' else 'nowco' end,(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key, 
  sum(case when Datediff(month,ME_DT,sysdate())=18 THEN POL_INFORCE_CNT ELSE 0 END) AS "18",
  sum(case when Datediff(month,ME_DT,sysdate())=17 THEN POL_INFORCE_CNT ELSE 0 END) AS "17",
  sum(case when Datediff(month,ME_DT,sysdate())=16 THEN POL_INFORCE_CNT ELSE 0 END) AS "16",
  sum(case when Datediff(month,ME_DT,sysdate())=15 THEN POL_INFORCE_CNT ELSE 0 END) AS "15",
  sum(case when Datediff(month,ME_DT,sysdate())=14 THEN POL_INFORCE_CNT ELSE 0 END) AS "14",
  sum(case when Datediff(month,ME_DT,sysdate())=13 THEN POL_INFORCE_CNT ELSE 0 END) AS "13",
  sum(case when Datediff(month,ME_DT,sysdate())=12 THEN POL_INFORCE_CNT ELSE 0 END) AS "12",
  sum(case when Datediff(month,ME_DT,sysdate())=11 THEN POL_INFORCE_CNT ELSE 0 END) AS "11",
  sum(case when Datediff(month,ME_DT,sysdate())=10 THEN POL_INFORCE_CNT ELSE 0 END) AS "10",
  sum(case when Datediff(month,ME_DT,sysdate())=9 THEN POL_INFORCE_CNT ELSE 0 END) AS "9",
  sum(case when Datediff(month,ME_DT,sysdate())=8 THEN POL_INFORCE_CNT ELSE 0 END) AS "8",
  sum(case when Datediff(month,ME_DT,sysdate())=7 THEN POL_INFORCE_CNT ELSE 0 END) AS "7",
  sum(case when Datediff(month,ME_DT,sysdate())=6 THEN POL_INFORCE_CNT ELSE 0 END) AS "6",
  sum(case when Datediff(month,ME_DT,sysdate())=5 THEN POL_INFORCE_CNT ELSE 0 END) AS "5",
  sum(case when Datediff(month,ME_DT,sysdate())=4 THEN POL_INFORCE_CNT ELSE 0 END) AS "4",
  sum(case when Datediff(month,ME_DT,sysdate())=3 THEN POL_INFORCE_CNT ELSE 0 END) AS "3",
  sum(case when Datediff(month,ME_DT,sysdate())=2 THEN POL_INFORCE_CNT ELSE 0 END) AS "2",
  sum(case when Datediff(month,ME_DT,sysdate())=1 THEN POL_INFORCE_CNT ELSE 0 END) AS "1",
  sum(case when Datediff(month,ME_DT,sysdate())=0 THEN POL_INFORCE_CNT ELSE 0 END) AS "0",
  TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
from "DSC_PLBI_DB"."APP_HOME_PRD"."HOME_INFORCE_MONTHEND"
Where BUS_UNIT_ABBR in ('AARP','AGCY') 
and concat(STATE_ABBR,RATE_PLAN_CD,BUS_UNIT_ABBR) in
('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY',  'MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY', 'TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP', 'DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP', 'MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP', 'SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY', 'ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP', 'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP', 'SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP', 'MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)
----



Union all 
(SELECT  concat((case when STATE_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when STATE_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when STATE_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when STATE_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),
                'Inforce',BUS_UNIT_ABBR,case when NEWCO_IND='Y' then 'Newco' else 'nowco' end,(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key, 
  sum(case when Datediff(month,ME_DT,sysdate())=18 THEN POL_INFORCE_CNT ELSE 0 END) AS "18",
  sum(case when Datediff(month,ME_DT,sysdate())=17 THEN POL_INFORCE_CNT ELSE 0 END) AS "17",
  sum(case when Datediff(month,ME_DT,sysdate())=16 THEN POL_INFORCE_CNT ELSE 0 END) AS "16",
  sum(case when Datediff(month,ME_DT,sysdate())=15 THEN POL_INFORCE_CNT ELSE 0 END) AS "15",
  sum(case when Datediff(month,ME_DT,sysdate())=14 THEN POL_INFORCE_CNT ELSE 0 END) AS "14",
  sum(case when Datediff(month,ME_DT,sysdate())=13 THEN POL_INFORCE_CNT ELSE 0 END) AS "13",
  sum(case when Datediff(month,ME_DT,sysdate())=12 THEN POL_INFORCE_CNT ELSE 0 END) AS "12",
  sum(case when Datediff(month,ME_DT,sysdate())=11 THEN POL_INFORCE_CNT ELSE 0 END) AS "11",
  sum(case when Datediff(month,ME_DT,sysdate())=10 THEN POL_INFORCE_CNT ELSE 0 END) AS "10",
  sum(case when Datediff(month,ME_DT,sysdate())=9 THEN POL_INFORCE_CNT ELSE 0 END) AS "9",
  sum(case when Datediff(month,ME_DT,sysdate())=8 THEN POL_INFORCE_CNT ELSE 0 END) AS "8",
  sum(case when Datediff(month,ME_DT,sysdate())=7 THEN POL_INFORCE_CNT ELSE 0 END) AS "7",
  sum(case when Datediff(month,ME_DT,sysdate())=6 THEN POL_INFORCE_CNT ELSE 0 END) AS "6",
  sum(case when Datediff(month,ME_DT,sysdate())=5 THEN POL_INFORCE_CNT ELSE 0 END) AS "5",
  sum(case when Datediff(month,ME_DT,sysdate())=4 THEN POL_INFORCE_CNT ELSE 0 END) AS "4",
  sum(case when Datediff(month,ME_DT,sysdate())=3 THEN POL_INFORCE_CNT ELSE 0 END) AS "3",
  sum(case when Datediff(month,ME_DT,sysdate())=2 THEN POL_INFORCE_CNT ELSE 0 END) AS "2",
  sum(case when Datediff(month,ME_DT,sysdate())=1 THEN POL_INFORCE_CNT ELSE 0 END) AS "1",
  sum(case when Datediff(month,ME_DT,sysdate())=0 THEN POL_INFORCE_CNT ELSE 0 END) AS "0",
  TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
from "DSC_PLBI_DB"."APP_HOME_PRD"."HOME_INFORCE_MONTHEND"
Where BUS_UNIT_ABBR in ('AARP','AGCY') 
and concat(STATE_ABBR,RATE_PLAN_CD,BUS_UNIT_ABBR) in('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY', 'MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY', 'TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP', 'DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP', 'MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP', 'SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY', 'ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP', 'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP', 'SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP', 'MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)

 
 

Union all (SELECT  concat('CW','Inforce',BUS_UNIT_ABBR,case when NEWCO_IND='Y' then 'Newco' else 'nowco' end,(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key, 
  sum(case when Datediff(month,ME_DT,sysdate())=18 THEN POL_INFORCE_CNT ELSE 0 END) AS "18",
  sum(case when Datediff(month,ME_DT,sysdate())=17 THEN POL_INFORCE_CNT ELSE 0 END) AS "17",
  sum(case when Datediff(month,ME_DT,sysdate())=16 THEN POL_INFORCE_CNT ELSE 0 END) AS "16",
  sum(case when Datediff(month,ME_DT,sysdate())=15 THEN POL_INFORCE_CNT ELSE 0 END) AS "15",
  sum(case when Datediff(month,ME_DT,sysdate())=14 THEN POL_INFORCE_CNT ELSE 0 END) AS "14",
  sum(case when Datediff(month,ME_DT,sysdate())=13 THEN POL_INFORCE_CNT ELSE 0 END) AS "13",
  sum(case when Datediff(month,ME_DT,sysdate())=12 THEN POL_INFORCE_CNT ELSE 0 END) AS "12",
  sum(case when Datediff(month,ME_DT,sysdate())=11 THEN POL_INFORCE_CNT ELSE 0 END) AS "11",
  sum(case when Datediff(month,ME_DT,sysdate())=10 THEN POL_INFORCE_CNT ELSE 0 END) AS "10",
  sum(case when Datediff(month,ME_DT,sysdate())=9 THEN POL_INFORCE_CNT ELSE 0 END) AS "9",
  sum(case when Datediff(month,ME_DT,sysdate())=8 THEN POL_INFORCE_CNT ELSE 0 END) AS "8",
  sum(case when Datediff(month,ME_DT,sysdate())=7 THEN POL_INFORCE_CNT ELSE 0 END) AS "7",
  sum(case when Datediff(month,ME_DT,sysdate())=6 THEN POL_INFORCE_CNT ELSE 0 END) AS "6",
  sum(case when Datediff(month,ME_DT,sysdate())=5 THEN POL_INFORCE_CNT ELSE 0 END) AS "5",
  sum(case when Datediff(month,ME_DT,sysdate())=4 THEN POL_INFORCE_CNT ELSE 0 END) AS "4",
  sum(case when Datediff(month,ME_DT,sysdate())=3 THEN POL_INFORCE_CNT ELSE 0 END) AS "3",
  sum(case when Datediff(month,ME_DT,sysdate())=2 THEN POL_INFORCE_CNT ELSE 0 END) AS "2",
  sum(case when Datediff(month,ME_DT,sysdate())=1 THEN POL_INFORCE_CNT ELSE 0 END) AS "1",
  sum(case when Datediff(month,ME_DT,sysdate())=0 THEN POL_INFORCE_CNT ELSE 0 END) AS "0",
  TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
from "DSC_PLBI_DB"."APP_HOME_PRD"."HOME_INFORCE_MONTHEND"
Where BUS_UNIT_ABBR in ('AARP','AGCY') 
and concat(STATE_ABBR,RATE_PLAN_CD,BUS_UNIT_ABBR) in
('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY', 'MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY', 'TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP', 'DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP', 'MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP', 'SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY', 'ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP', 'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP', 'SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP', 'MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)

Union all 
(SELECT  concat(STATE_ABBR,'Written Premium',BUS_UNIT_ABBR,case when NEWCO_IND='Y' then 'Newco' else 'nowco' end,(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key, 
  sum(case when Datediff(month,ME_DT,sysdate())=18 THEN TERM_WRIT_PREM ELSE 0 END) AS "18",
  sum(case when Datediff(month,ME_DT,sysdate())=17 THEN TERM_WRIT_PREM ELSE 0 END) AS "17",
  sum(case when Datediff(month,ME_DT,sysdate())=16 THEN TERM_WRIT_PREM ELSE 0 END) AS "16",
  sum(case when Datediff(month,ME_DT,sysdate())=15 THEN TERM_WRIT_PREM ELSE 0 END) AS "15",
  sum(case when Datediff(month,ME_DT,sysdate())=14 THEN TERM_WRIT_PREM ELSE 0 END) AS "14",
  sum(case when Datediff(month,ME_DT,sysdate())=13 THEN TERM_WRIT_PREM ELSE 0 END) AS "13",
  sum(case when Datediff(month,ME_DT,sysdate())=12 THEN TERM_WRIT_PREM ELSE 0 END) AS "12",
  sum(case when Datediff(month,ME_DT,sysdate())=11 THEN TERM_WRIT_PREM ELSE 0 END) AS "11",
  sum(case when Datediff(month,ME_DT,sysdate())=10 THEN TERM_WRIT_PREM ELSE 0 END) AS "10",
  sum(case when Datediff(month,ME_DT,sysdate())=9 THEN TERM_WRIT_PREM ELSE 0 END) AS "9",
  sum(case when Datediff(month,ME_DT,sysdate())=8 THEN TERM_WRIT_PREM ELSE 0 END) AS "8",
  sum(case when Datediff(month,ME_DT,sysdate())=7 THEN TERM_WRIT_PREM ELSE 0 END) AS "7",
  sum(case when Datediff(month,ME_DT,sysdate())=6 THEN TERM_WRIT_PREM ELSE 0 END) AS "6",
  sum(case when Datediff(month,ME_DT,sysdate())=5 THEN TERM_WRIT_PREM ELSE 0 END) AS "5",
  sum(case when Datediff(month,ME_DT,sysdate())=4 THEN TERM_WRIT_PREM ELSE 0 END) AS "4",
  sum(case when Datediff(month,ME_DT,sysdate())=3 THEN TERM_WRIT_PREM ELSE 0 END) AS "3",
  sum(case when Datediff(month,ME_DT,sysdate())=2 THEN TERM_WRIT_PREM ELSE 0 END) AS "2",
  sum(case when Datediff(month,ME_DT,sysdate())=1 THEN TERM_WRIT_PREM ELSE 0 END) AS "1",
  sum(case when Datediff(month,ME_DT,sysdate())=0 THEN TERM_WRIT_PREM ELSE 0 END) AS "0",
  TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
from "DSC_PLBI_DB"."APP_HOME_PRD"."HOME_INFORCE_MONTHEND"
Where BUS_UNIT_ABBR in ('AARP','AGCY') 
and concat(STATE_ABBR,RATE_PLAN_CD,BUS_UNIT_ABBR) in
('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY', 'MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY', 'TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP', 'DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP', 'MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP', 'SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY', 'ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP', 'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP', 'SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP', 'MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)
----------------------------------------------------
Union all 
(SELECT  concat('CW','Written Premium',BUS_UNIT_ABBR,case when NEWCO_IND='Y' then 'Newco' else 'nowco' end,(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key, 
  sum(case when Datediff(month,ME_DT,sysdate())=18 THEN TERM_WRIT_PREM ELSE 0 END) AS "18",
  sum(case when Datediff(month,ME_DT,sysdate())=17 THEN TERM_WRIT_PREM ELSE 0 END) AS "17",
  sum(case when Datediff(month,ME_DT,sysdate())=16 THEN TERM_WRIT_PREM ELSE 0 END) AS "16",
  sum(case when Datediff(month,ME_DT,sysdate())=15 THEN TERM_WRIT_PREM ELSE 0 END) AS "15",
  sum(case when Datediff(month,ME_DT,sysdate())=14 THEN TERM_WRIT_PREM ELSE 0 END) AS "14",
  sum(case when Datediff(month,ME_DT,sysdate())=13 THEN TERM_WRIT_PREM ELSE 0 END) AS "13",
  sum(case when Datediff(month,ME_DT,sysdate())=12 THEN TERM_WRIT_PREM ELSE 0 END) AS "12",
  sum(case when Datediff(month,ME_DT,sysdate())=11 THEN TERM_WRIT_PREM ELSE 0 END) AS "11",
  sum(case when Datediff(month,ME_DT,sysdate())=10 THEN TERM_WRIT_PREM ELSE 0 END) AS "10",
  sum(case when Datediff(month,ME_DT,sysdate())=9 THEN TERM_WRIT_PREM ELSE 0 END) AS "9",
  sum(case when Datediff(month,ME_DT,sysdate())=8 THEN TERM_WRIT_PREM ELSE 0 END) AS "8",
  sum(case when Datediff(month,ME_DT,sysdate())=7 THEN TERM_WRIT_PREM ELSE 0 END) AS "7",
  sum(case when Datediff(month,ME_DT,sysdate())=6 THEN TERM_WRIT_PREM ELSE 0 END) AS "6",
  sum(case when Datediff(month,ME_DT,sysdate())=5 THEN TERM_WRIT_PREM ELSE 0 END) AS "5",
  sum(case when Datediff(month,ME_DT,sysdate())=4 THEN TERM_WRIT_PREM ELSE 0 END) AS "4",
  sum(case when Datediff(month,ME_DT,sysdate())=3 THEN TERM_WRIT_PREM ELSE 0 END) AS "3",
  sum(case when Datediff(month,ME_DT,sysdate())=2 THEN TERM_WRIT_PREM ELSE 0 END) AS "2",
  sum(case when Datediff(month,ME_DT,sysdate())=1 THEN TERM_WRIT_PREM ELSE 0 END) AS "1",
  sum(case when Datediff(month,ME_DT,sysdate())=0 THEN TERM_WRIT_PREM ELSE 0 END) AS "0",
  TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
from "DSC_PLBI_DB"."APP_HOME_PRD"."HOME_INFORCE_MONTHEND"
Where BUS_UNIT_ABBR in ('AARP','AGCY') 
and concat(STATE_ABBR,RATE_PLAN_CD,BUS_UNIT_ABBR) in
('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY', 'MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY', 'TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP', 'DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP', 'MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP', 'SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY', 'ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP', 'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP', 'SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP', 'MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)
Union all 
(SELECT  concat((case when STATE_ABBR in ('MS','TN','AL','AR','FL','IN','KY','NC','WV','GA','SC','DC','LA') then 'Southeast' when STATE_ABBR in ('IA','KS','NE','OK','TX','MO','IL','MI','MN','WI','NM','CO') then 'Central'
               when STATE_ABBR in ('DE','ME','NH','RI','VT','NY','NJ','CT','MA','PA','OH','VA','MD') then 'Northeast' when STATE_ABBR in ( 'AK','HI','MT','ND','SD','WY','CA','AZ','NV','WA','OR','ID','UT') then 'West' else 'Unknown' end),
                'Written Premium',BUS_UNIT_ABBR,case when NEWCO_IND='Y' then 'Newco' else 'nowco' end,(case when POL_FORM_CD in ('HO3','HO5','3','5','HO7') then 'Bldg' when POL_FORM_CD in ('HO4','HO6','4','6') then 'T/C' else 'Other' end)) as Key, 
  sum(case when Datediff(month,ME_DT,sysdate())=18 THEN TERM_WRIT_PREM ELSE 0 END) AS "18",
  sum(case when Datediff(month,ME_DT,sysdate())=17 THEN TERM_WRIT_PREM ELSE 0 END) AS "17",
  sum(case when Datediff(month,ME_DT,sysdate())=16 THEN TERM_WRIT_PREM ELSE 0 END) AS "16",
  sum(case when Datediff(month,ME_DT,sysdate())=15 THEN TERM_WRIT_PREM ELSE 0 END) AS "15",
  sum(case when Datediff(month,ME_DT,sysdate())=14 THEN TERM_WRIT_PREM ELSE 0 END) AS "14",
  sum(case when Datediff(month,ME_DT,sysdate())=13 THEN TERM_WRIT_PREM ELSE 0 END) AS "13",
  sum(case when Datediff(month,ME_DT,sysdate())=12 THEN TERM_WRIT_PREM ELSE 0 END) AS "12",
  sum(case when Datediff(month,ME_DT,sysdate())=11 THEN TERM_WRIT_PREM ELSE 0 END) AS "11",
  sum(case when Datediff(month,ME_DT,sysdate())=10 THEN TERM_WRIT_PREM ELSE 0 END) AS "10",
  sum(case when Datediff(month,ME_DT,sysdate())=9 THEN TERM_WRIT_PREM ELSE 0 END) AS "9",
  sum(case when Datediff(month,ME_DT,sysdate())=8 THEN TERM_WRIT_PREM ELSE 0 END) AS "8",
  sum(case when Datediff(month,ME_DT,sysdate())=7 THEN TERM_WRIT_PREM ELSE 0 END) AS "7",
  sum(case when Datediff(month,ME_DT,sysdate())=6 THEN TERM_WRIT_PREM ELSE 0 END) AS "6",
  sum(case when Datediff(month,ME_DT,sysdate())=5 THEN TERM_WRIT_PREM ELSE 0 END) AS "5",
  sum(case when Datediff(month,ME_DT,sysdate())=4 THEN TERM_WRIT_PREM ELSE 0 END) AS "4",
  sum(case when Datediff(month,ME_DT,sysdate())=3 THEN TERM_WRIT_PREM ELSE 0 END) AS "3",
  sum(case when Datediff(month,ME_DT,sysdate())=2 THEN TERM_WRIT_PREM ELSE 0 END) AS "2",
  sum(case when Datediff(month,ME_DT,sysdate())=1 THEN TERM_WRIT_PREM ELSE 0 END) AS "1",
  sum(case when Datediff(month,ME_DT,sysdate())=0 THEN TERM_WRIT_PREM ELSE 0 END) AS "0",
  TO_CHAR(sysdate(),'MM-DD-YYYY') as AS_OF
from "DSC_PLBI_DB"."APP_HOME_PRD"."HOME_INFORCE_MONTHEND"
Where BUS_UNIT_ABBR in ('AARP','AGCY') 
and concat(STATE_ABBR,RATE_PLAN_CD,BUS_UNIT_ABBR) in
('ALHNGAGCY','ARHNGAGCY','AZHNGAGCY','CAHNGAGCY','COHNGAGCY','CTHNGAGCY','DCHNGAGCY','GAHNGAGCY','IAHNGAGCY','IDHNGAGCY','ILHNGAGCY','INHNGAGCY','KSHNGAGCY','KYHNGAGCY','MDHNGAGCY', 'MEHNGAGCY','MNHNGAGCY','MOHNGAGCY','MTHNGAGCY','NEHNGAGCY','NHHNGAGCY','NMHNGAGCY','NVHNGAGCY','NYHNGAGCY','OHHNGAGCY','OKHNGAGCY','ORHNGAGCY','PAHNGAGCY','SCHNGAGCY','SDHNGAGCY', 'TNHNGAGCY','TXHNGAGCY','UTHNGAGCY','VAHNGAGCY','VTHNGAGCY','WAHNGAGCY','WIHNGAGCY','WVHNGAGCY','WYHNGAGCY','ALHNGAARP','ARHNGAARP','AZHNGAARP','CAHNGAARP','COHNGAARP','CTHNGAARP', 'DCHNGAARP','DEHNGAARP','GAHNGAARP','IAHNGAARP','IDHNGAARP','ILHNGAARP','INHNGAARP','KSHNGAARP','KYHNGAARP','LAHNGAARP','MAHNGAARP','MDHNGAARP','MEHNGAARP','MIHNGAARP','MNHNGAARP', 'MOHNGAARP','MSHNGAARP','MTHNGAARP','NDHNGAARP','NEHNGAARP','NHHNGAARP','NJHNGAARP','NMHNGAARP','NVHNGAARP','NYHNGAARP','OHHNGAARP','OKHNGAARP','ORHNGAARP','PAHNGAARP','RIHNGAARP', 'SCHNGAARP','SDHNGAARP','TNHNGAARP','TXHNGAARP','UTHNGAARP','VAHNGAARP','VTHNGAARP','WAHNGAARP','WIHNGAARP','WVHNGAARP','WYHNGAARP','FLHO84AARP','HIHO84AARP','NCHO84AARP','NCHOAGAGCY', 'ALHPRVAARP','ARHPRVAARP','AZHPRVAARP','CAHPRVAARP','COHPRVAARP','CTHPRVAARP','DCHPRVAARP','GAHPRVAARP','IAHPRVAARP','IDHPRVAARP','ILHPRVAARP','INHPRVAARP','KSHPRVAARP','KYHPRVAARP', 'MDHPRVAARP','MEHPRVAARP','MNHPRVAARP','MOHPRVAARP','MTHPRVAARP','NEHPRVAARP','NHHPRVAARP','NMHPRVAARP','NVHPRVAARP','NYHPRVAARP','OHHPRVAARP','OKHPRVAARP','ORHPRVAARP','PAHPRVAARP', 'SCHPRVAARP','SDHPRVAARP','TNHPRVAARP','TXHPRVAARP','UTHPRVAARP','VAHPRVAARP','VTHPRVAARP','WAHPRVAARP','WIHPRVAARP','WVHPRVAARP','WYHPRVAARP','DEHPRVAARP','LAHPRVAARP','MAHPRVAARP', 'MIHPRVAARP','MSHPRVAARP','NDHPRVAARP','NJHPRVAARP','RIHPRVAARP','FLHPRVAARP','HIHPRVAARP','NCHPRVAARP','AKHPRVAARP') GROUP BY Key)
----------------------------------------------------------
order by Key 
